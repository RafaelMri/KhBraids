(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    134785,       3026]
NotebookOptionsPosition[    133810,       2991]
NotebookOutlinePosition[    134166,       3007]
CellTagsIndexPosition[    134123,       3004]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Defining the Reidemeister 2 chain maps", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
  3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
  3.625124067226338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{"braid_", ",", 
      RowBox[{"{", "}"}]}], "]"}], "]"}], "[", "v_", "]"}], ":=", 
  "v"}]], "Input",
 CellChangeTimes->{{3.6250198939451857`*^9, 3.625019904751936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{"braid_", ",", 
      RowBox[{"{", 
       RowBox[{"X_", ",", "Y__"}], "}"}]}], "]"}], "]"}], "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{
      RowBox[{"Still", "[", 
       RowBox[{
        RowBox[{"BraidMovie", "[", 
         RowBox[{"braid", ",", 
          RowBox[{"{", "X", "}"}]}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", "Y", "}"}]}], "]"}], "]"}], "[", 
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid", ",", 
       RowBox[{"{", "X", "}"}]}], "]"}], "]"}], "[", "v", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.625018692990404*^9, 3.6250187787828703`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"constructBasisVectorOrNot", "[", 
   RowBox[{"r_Resolution", ",", "Null", ",", "signs_"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constructBasisVectorOrNot", "[", 
   RowBox[{"r_Resolution", ",", "notNull_", ",", "signs_"}], "]"}], ":=", 
  RowBox[{"constructBasisVector", "[", 
   RowBox[{"r", ",", 
    RowBox[{"Join", "[", 
     RowBox[{"notNull", ",", "signs"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.621043595350319*^9, 3.6210436176631393`*^9}, {
  3.6210436849431877`*^9, 3.621043685430293*^9}, {3.621045693918334*^9, 
  3.62104569441782*^9}, {3.621045970475613*^9, 3.621045996103354*^9}, {
  3.623458637702227*^9, 3.623458639333589*^9}, {3.623460641444234*^9, 
  3.6234606577942867`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", "m_BraidMovie", "]"}], ":=", 
    RowBox[{"Sum", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"KhC", "[", 
         RowBox[{"m", ",", 
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"AllBigradings", "[", 
        RowBox[{"Still", "[", 
         RowBox[{"m", ",", "0"}], "]"}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"m_BraidMovie", ",", "s_Integer", ",", " ", "r_Integer"}], "]"}],
     ":=", 
    RowBox[{"Sum", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KhC", "[", "m", "]"}], "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"AllBasisVectorsInGrading", "[", 
        RowBox[{
         RowBox[{"Still", "[", 
          RowBox[{"m", ",", "0"}], "]"}], ",", "s", ",", "r"}], "]"}]}], 
      ")"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.624331712054319*^9, 3.6243317193540916`*^9}, {
  3.624331753066552*^9, 3.624331876988049*^9}, {3.624331954635127*^9, 
  3.6243319618169518`*^9}, {3.624341245657346*^9, 3.624341249981544*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", "m_BraidMovie", "]"}], "[", "X_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{"KhC", "[", "m", "]"}], "/@", "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", "m_BraidMovie", "]"}], "[", 
   RowBox[{"\[Alpha]_Integer", " ", "X_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{
    RowBox[{"KhC", "[", "m", "]"}], "[", "X", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6234598291801147`*^9, 3.623459859224266*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", "m_BraidMovie", "]"}], "[", "0", "]"}], ":=", 
  "0"}]], "Input",
 CellChangeTimes->{{3.623445865658203*^9, 3.623445873041237*^9}, {
  3.624257126013492*^9, 3.624257129346794*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", " ", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", " ", 
       RowBox[{"{", 
        RowBox[{"R2", "[", 
         RowBox[{"offset_", ",", " ", "1", ",", " ", "generator_"}], "]"}], 
        "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"v", " ", ":", " ", 
     RowBox[{"BasisVector", "[", 
      RowBox[{
       RowBox[{"Resolution", "[", 
        RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
        "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prev", ",", " ", "prev2", ",", "\[IndentingNewLine]", 
       RowBox[{"circle1", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"circle2", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "circle3", ",", "\[IndentingNewLine]", 
       RowBox[{"newBraid", "=", "braid"}], ",", "\[IndentingNewLine]", 
       "images", ",", "\[IndentingNewLine]", "newBasisVector1", ",", " ", 
       "newBasisVector2", ",", "\[IndentingNewLine]", 
       RowBox[{"newResolutions", "=", 
        RowBox[{"{", 
         RowBox[{"resolution", ",", "resolution"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "otherSigns", ",", "alteredSigns", ",", 
       "\[IndentingNewLine]", "affectedCircles", ",", " ", "newCircle", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"sign1", "=", "1"}], ",", 
       RowBox[{"sign2", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", " ", 
         RowBox[{"-", "generator"}], ",", " ", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", " ", "generator", ",", " ", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sign", "[", "generator", "]"}], "-", "1"}], ")"}]}], 
          "/", "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sign", "[", "generator", "]"}], "-", "1"}], ")"}]}], 
          "/", "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sign", "[", "generator", "]"}], "+", "1"}], ")"}], "/", 
          "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sign", "[", "generator", "]"}], "+", "1"}], ")"}], "/", 
          "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"prev", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "offset"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Abs", "[", "generator", "]"}], "|", 
           RowBox[{
            RowBox[{"Abs", "[", "generator", "]"}], "-", "1"}], "|", 
           RowBox[{
            RowBox[{"Abs", "[", "generator", "]"}], "+", "1"}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<prev = \>\"", ",", "prev"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "   ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Work", " ", "out", " ", "which", " ", "circles", " ", "are", " ", 
        "involved"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"prev", " ", "==", " ", 
         RowBox[{"-", "\[Infinity]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "No", " ", "prior", " ", "generator", " ", "affecting", " ", 
          "either", " ", "strand"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"circles", ",", " ", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
              RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
           "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"circle1", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"circles", ",", " ", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
                 RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"circle2", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"circles", ",", " ", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
                 RowBox[{"Abs", "[", "generator", "]"}], " ", "+", " ", 
                 "1"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"circle1", "=", 
            RowBox[{"Abs", "[", "generator", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"circle2", "=", 
            RowBox[{
             RowBox[{"Abs", "[", "generator", "]"}], "+", "1"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Prior", " ", "generator"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
              "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
               "\[LeftDoubleBracket]", "prev", "\[RightDoubleBracket]"}], 
             "]"}], " ", "==", " ", 
            RowBox[{"Abs", "[", "generator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<circles = \>\"", ",", "circles"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "resolution", "\[LeftDoubleBracket]", "prev", 
               "\[RightDoubleBracket]"}], " ", "==", " ", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"circle1", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"circles", ",", " ", 
                   RowBox[{"4", "*", "prev"}]}], "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"circle2", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"circles", ",", " ", 
                   RowBox[{
                    RowBox[{"4", "*", "prev"}], " ", "-", " ", "2"}]}], "]"}],
                  "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"circle1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"circles", ",", " ", 
                  RowBox[{
                   RowBox[{"4", "*", "prev"}], " ", "-", " ", "1"}]}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"braid", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "prev", "]"}], "]"}], "]"}], " ", "==", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "generator", "]"}], " ", "-", " ", 
                "1"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"prev2", " ", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"braid", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"offset", " ", "-", " ", "1"}]}], "]"}], "]"}], 
                   ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", "generator", "]"}], " ", "+", " ", 
                    "1"}], "|", 
                    RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"circle1", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"prev2", "\[Equal]", 
                  RowBox[{"-", "\[Infinity]"}]}], ",", 
                 RowBox[{"circle2", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{"Abs", "[", "generator", "]"}], "+", "1"}]}], 
                    "]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    "prev2", "\[RightDoubleBracket]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Abs", "[", "generator", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "2"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ","}], 
                "\[IndentingNewLine]", "]"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"circle1", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "-", "2"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"prev2", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"braid", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"offset", " ", "-", " ", "1"}]}], "]"}], "]"}], 
                   ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", "generator", "]"}], " ", "-", " ", 
                    "1"}], "|", 
                    RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"prev2", "\[Equal]", 
                  RowBox[{"-", "\[Infinity]"}]}], ",", "\[IndentingNewLine]", 
                 
                 RowBox[{"circle2", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    "prev2", "\[RightDoubleBracket]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Abs", "[", "generator", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "2"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}], "|", 
                    RowBox[{"4", "*", "prev2"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ";"}]}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "circle1", " ", "and", " ", "circle2", " ", "now", " ", "give", " ", 
        "the", " ", "positions", " ", "of", " ", "affected", " ", "circles", 
        " ", "in", " ", "circles"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Identify", " ", "affected", " ", "circles", " ", "in", " ", "new", 
        " ", "resolutions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Resolution", "[", 
          RowBox[{"newBraid", ",", "#"}], "]"}], "&"}], "/@", 
        "newResolutions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"affectedCircles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "1"}], "|", 
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "2"}], "|", 
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "4"}], "|", 
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "7"}]}]}], "]"}], "&"}]}], 
          "]"}], "&"}], "/@", "images"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"The", " ", "budded", " ", "circle"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"newCircle", "=", 
       RowBox[{
        RowBox[{"offset", "*", "4"}], "+", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<signs\>\"", ",", "affectedCircles", ",", "newCircle", ",", 
          "circles", ",", "\"\< \>\"", ",", "circle1", ",", "\"\< \>\"", ",", 
          "circle2", ",", "signs"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"circle1", "\[Equal]", "circle2"}], "||", 
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "circle2", "]"}]}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"circle1", "\[Equal]", "circle2"}], "||", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "circle2", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alteredSigns", " ", "=", " ", 
          RowBox[{"R2Signs1", "[", 
           RowBox[{"affectedCircles", ",", "newCircle", ",", 
            RowBox[{
             RowBox[{"circles", "\[LeftDoubleBracket]", 
              RowBox[{"{", "circle1", "}"}], "\[RightDoubleBracket]"}], " ", "/.",
              " ", "signs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"circle2", "=", "circle1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{
                "affectedCircles", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "2"}], "&&", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"8", "*", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{
                    "circles", "\[LeftDoubleBracket]", "circle1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"4", "*", "offset"}], "-", "1"}], "]"}]}], "+", 
                  RowBox[{
                  "circles", "\[LeftDoubleBracket]", "circle1", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "\[Equal]", 
               RowBox[{"{", "}"}]}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{
                "affectedCircles", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "2"}], "&&", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"8", "*", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{
                    "circles", "\[LeftDoubleBracket]", "circle1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"4", "*", "offset"}], "-", "1"}], "]"}]}], "+", 
                  RowBox[{
                  "circles", "\[LeftDoubleBracket]", "circle1", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "\[Equal]", 
               RowBox[{"{", "}"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"circle3", "=", "circle1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"circle1", "=", "circle2"}], ";", "\[IndentingNewLine]", 
            RowBox[{"circle2", "=", "circle3"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"alteredSigns", "=", 
          RowBox[{"R2Signs2", "[", 
           RowBox[{"affectedCircles", ",", "newCircle", ",", 
            RowBox[{
             RowBox[{"circles", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"circle1", ",", " ", "circle2"}], "}"}], 
              "\[RightDoubleBracket]"}], " ", "/.", " ", "signs"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"otherSigns", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"signs", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], " ", "/;", 
          " ", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"circles", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"circle1", ",", " ", "circle2"}], "}"}], 
             "\[RightDoubleBracket]"}], ",", " ", "circle"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"otherSigns", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"otherSigns", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"8", "*", 
               RowBox[{"UnitStep", "[", 
                RowBox[{
                 RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                  RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], "]"}]}],
               "+", 
              RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
               RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}], 
           "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<alteredSigns = \>\"", ",", "alteredSigns"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<otherSigns = \>\"", ",", "otherSigns"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<error check\>\"", ",", " ", "alteredSigns"}], "]"}], 
        ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Intersection[images\[LeftDoubleBracket]1\[RightDoubleBracket]\
\[LeftDoubleBracket]3\[RightDoubleBracket],4*offset+{3,5}] = \>\"", ",", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
              "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"4", "*", "offset"}], "+", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}]}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
         "\[Equal]", "1"}], ",", 
        RowBox[{"sign1", "=", 
         RowBox[{"Sign", "[", "generator", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "images", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
         "\[Equal]", "1"}], ",", 
        RowBox[{"sign2", "=", 
         RowBox[{"Sign", "[", "generator", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sign1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}], "+", 
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}]}], ")"}]}],
        "+", 
       RowBox[{"sign2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}], "+", 
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}]}], 
         ")"}]}]}]}]}], "\n", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Should", " ", "return", " ", "a", " ", "3"}], "-", 
           RowBox[{
           "tuple", " ", "with", " ", "the", " ", "new", " ", "signs", " ", 
            "starting", " ", "with", " ", "the", " ", "resolution"}]}], " ", 
          "..."}], "01"}], "..."}], " ", "and", " ", "ending", " ", "with"}], 
      " ", "..."}], "10"}], "..."}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R2Signs1", "[", 
     RowBox[{"affectedCircles_", ",", "newCircle_", ",", "oldSigns_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newSigns", "=", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null", ",", "Null", ",", "Null"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "affectedCircles", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "affectedCircles", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "4", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "affectedCircles", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "newSigns"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R2Signs2", "[", 
     RowBox[{"affectedCircles_", ",", "newCircle_", ",", "oldSigns_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newSigns", "=", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null", ",", "Null", ",", "Null"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<R2Signs2[\>\"", ",", "affectedCircles", ",", "\"\<,\>\"", ",", 
          "newCircle", ",", "\"\<,\>\"", ",", "oldSigns", ",", "\"\<]\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "affectedCircles", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "&&", 
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newSigns", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "affectedCircles", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
               RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}], "||", 
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                "newSigns", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "affectedCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "&&", 
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "affectedCircles", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
               RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}], "||", 
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                "newSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "affectedCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "newSigns"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.618613269386087*^9, 3.6186133216952543`*^9}, {
   3.618625360276558*^9, 3.618625360845521*^9}, {3.618630401911015*^9, 
   3.618630527738447*^9}, {3.618630589488455*^9, 3.6186306247910852`*^9}, {
   3.618630658942924*^9, 3.618630677236027*^9}, {3.618630724156982*^9, 
   3.618630751481485*^9}, {3.618630867129529*^9, 3.618630939955831*^9}, {
   3.618630981627187*^9, 3.618631066405154*^9}, {3.618775133052783*^9, 
   3.618775184010097*^9}, {3.618775358526524*^9, 3.618775387533744*^9}, {
   3.618775423800769*^9, 3.618775506752783*^9}, {3.6187755518434753`*^9, 
   3.6187755572354813`*^9}, {3.618775593123229*^9, 3.618775724428648*^9}, {
   3.618775762092065*^9, 3.618775765013459*^9}, {3.618775824489884*^9, 
   3.618775848436596*^9}, {3.618775883049265*^9, 3.618775923169553*^9}, {
   3.6187759795562143`*^9, 3.618776023781505*^9}, {3.61877607434789*^9, 
   3.618776109911497*^9}, {3.6187761570655823`*^9, 3.6187762466597433`*^9}, {
   3.618776285521598*^9, 3.618776420153441*^9}, {3.618776479017851*^9, 
   3.618776728297097*^9}, {3.618776813927204*^9, 3.618776816737569*^9}, {
   3.618776849481269*^9, 3.618776916945096*^9}, {3.618776972072431*^9, 
   3.618776972827629*^9}, {3.618777048011116*^9, 3.618777083391178*^9}, {
   3.618777258454444*^9, 3.618777299083202*^9}, {3.618777343466207*^9, 
   3.618777431955916*^9}, {3.6187774854689703`*^9, 3.618777631962434*^9}, {
   3.6187777589016*^9, 3.618777773915814*^9}, {3.618778034457589*^9, 
   3.6187780361970243`*^9}, {3.618778246610037*^9, 3.618778312622789*^9}, {
   3.618782201340641*^9, 3.618782283279613*^9}, {3.618782374331119*^9, 
   3.6187824031870193`*^9}, 3.61889002019411*^9, {3.618890061369323*^9, 
   3.618890070012014*^9}, {3.61889010627096*^9, 3.618890107952408*^9}, {
   3.618890138772139*^9, 3.618890143329302*^9}, {3.6189799796675797`*^9, 
   3.6189801536358557`*^9}, {3.618980792409807*^9, 3.6189808306499357`*^9}, {
   3.619129207228156*^9, 3.619129260861465*^9}, {3.619129351996848*^9, 
   3.619129366737754*^9}, {3.619129810544421*^9, 3.6191299063764772`*^9}, {
   3.619130235341402*^9, 3.6191302679094954`*^9}, {3.61913040054907*^9, 
   3.619130405003941*^9}, {3.6191304555040827`*^9, 3.61913046357729*^9}, {
   3.619130495010079*^9, 3.6191304967377853`*^9}, {3.619130528134907*^9, 
   3.619130561684697*^9}, {3.6191307159603977`*^9, 3.619130754105343*^9}, {
   3.619130980350268*^9, 3.619130991249832*^9}, {3.6191312075960617`*^9, 
   3.619131309353236*^9}, {3.61913197807244*^9, 3.619131983967136*^9}, {
   3.6191320170722*^9, 3.6191320333333273`*^9}, {3.619132094996003*^9, 
   3.619132153464191*^9}, {3.6191327354998703`*^9, 3.6191327546804247`*^9}, {
   3.619213323242429*^9, 3.619213333929739*^9}, {3.6192364332965117`*^9, 
   3.6192364855251207`*^9}, {3.619236618804902*^9, 3.6192366244815474`*^9}, {
   3.619236665599369*^9, 3.619236717299555*^9}, {3.61923677043725*^9, 
   3.61923679521231*^9}, {3.619236858865959*^9, 3.619236859197515*^9}, {
   3.619291754710565*^9, 3.6192917742815733`*^9}, {3.6192918249953823`*^9, 
   3.619291875502956*^9}, {3.619291907973082*^9, 3.619291938215208*^9}, {
   3.6192920332927103`*^9, 3.619292086795281*^9}, {3.6193423383989973`*^9, 
   3.619342370934016*^9}, {3.619342411475833*^9, 3.619342419183957*^9}, {
   3.619342449898184*^9, 3.619342466759426*^9}, {3.619342535934268*^9, 
   3.619342605460952*^9}, 3.6193426431122837`*^9, {3.6193433876952667`*^9, 
   3.619343388148675*^9}, {3.619343425973405*^9, 3.619343447706068*^9}, {
   3.61934349212222*^9, 3.619343522598276*^9}, 3.61941574154244*^9, {
   3.619663826020279*^9, 3.619663877087172*^9}, {3.61966391900875*^9, 
   3.6196639192634373`*^9}, {3.6196639506135073`*^9, 3.619663984180794*^9}, {
   3.6196640490297623`*^9, 3.61966404924783*^9}, {3.619664141198514*^9, 
   3.619664149351777*^9}, {3.6196641931082172`*^9, 3.619664210626903*^9}, {
   3.619664705630397*^9, 3.6196648905803537`*^9}, {3.61966497108704*^9, 
   3.619664972922779*^9}, {3.619665073928665*^9, 3.619665086172433*^9}, {
   3.619665129067255*^9, 3.6196651388138313`*^9}, {3.619665193299307*^9, 
   3.6196652039419127`*^9}, {3.619665385975606*^9, 3.619665392308313*^9}, {
   3.6196654363032207`*^9, 3.619665465677706*^9}, {3.6196661278862133`*^9, 
   3.619666177860342*^9}, {3.6196666132127733`*^9, 3.619666831099594*^9}, {
   3.619667901830315*^9, 3.61966794378621*^9}, 3.61966801907541*^9, {
   3.619668228942646*^9, 3.619668244745298*^9}, {3.619668284887373*^9, 
   3.619668566188925*^9}, {3.619668597621997*^9, 3.619668656953309*^9}, 
   3.61973899055087*^9, {3.619756414051346*^9, 3.619756498788033*^9}, {
   3.619996526006805*^9, 3.6199965547338943`*^9}, {3.619996641025618*^9, 
   3.6199966979620132`*^9}, {3.6199967470937023`*^9, 3.619996831279668*^9}, {
   3.620002430268601*^9, 3.620002466922862*^9}, {3.6200024986740007`*^9, 
   3.6200025258385563`*^9}, {3.6200025851800013`*^9, 3.620002631453784*^9}, {
   3.62000271425242*^9, 3.6200028385979767`*^9}, {3.6201915123351717`*^9, 
   3.620191540041799*^9}, {3.6201916062971897`*^9, 3.6201916190417547`*^9}, {
   3.620193537991802*^9, 3.62019367810011*^9}, {3.6201937141912527`*^9, 
   3.620193842823036*^9}, {3.620424726849062*^9, 3.620424784438293*^9}, {
   3.62042606143714*^9, 3.620426074223156*^9}, {3.6204261323811626`*^9, 
   3.620426145161413*^9}, {3.6204262693567753`*^9, 3.620426328555399*^9}, {
   3.6204263735347843`*^9, 3.620426409340137*^9}, {3.6204264892003317`*^9, 
   3.620426507997229*^9}, {3.6204265656169863`*^9, 3.620426609384019*^9}, {
   3.62042679523976*^9, 3.6204269896618977`*^9}, {3.620429741410687*^9, 
   3.620429742201077*^9}, {3.6204300447401114`*^9, 3.620430336199546*^9}, 
   3.6204303751639557`*^9, {3.620430441567068*^9, 3.620430498314231*^9}, {
   3.6204305777784433`*^9, 3.620430623521902*^9}, {3.620430678369802*^9, 
   3.620430731096291*^9}, {3.620435771282312*^9, 3.620435788512542*^9}, {
   3.620435827328829*^9, 3.620435834958165*^9}, {3.620437640281847*^9, 
   3.620437777021989*^9}, {3.6204415329297457`*^9, 3.620441565750641*^9}, {
   3.620441804334867*^9, 3.620441813479247*^9}, {3.6205224554655848`*^9, 
   3.620522620583098*^9}, {3.620522652885333*^9, 3.62052270826502*^9}, {
   3.620545603274837*^9, 3.620545612162418*^9}, {3.620545753952363*^9, 
   3.620545788896819*^9}, {3.6205458207678843`*^9, 3.6205458274792137`*^9}, {
   3.620545861909985*^9, 3.62054589234161*^9}, {3.6205461201619368`*^9, 
   3.620546157407813*^9}, {3.620546251231719*^9, 3.620546321910421*^9}, {
   3.620546375559781*^9, 3.620546376354802*^9}, {3.620546411607122*^9, 
   3.620546415866043*^9}, {3.620546480700131*^9, 3.620546597536777*^9}, {
   3.620546638221669*^9, 3.620546666400889*^9}, 3.620546709548717*^9, {
   3.620598452644003*^9, 3.620598478178664*^9}, {3.620598531572398*^9, 
   3.6205985475727577`*^9}, {3.620598601345832*^9, 3.6205987022549267`*^9}, {
   3.6205988898953247`*^9, 3.6205989248702927`*^9}, {3.6205989618259068`*^9, 
   3.620598965524912*^9}, {3.620608008751645*^9, 3.6206080376613407`*^9}, {
   3.620608072658915*^9, 3.620608096201489*^9}, {3.620608178638009*^9, 
   3.62060818631957*^9}, {3.620608216458549*^9, 3.620608225224791*^9}, {
   3.620608256752969*^9, 3.6206082779150352`*^9}, {3.62060844509356*^9, 
   3.620608464276729*^9}, 3.620608502550894*^9, {3.6206093664250193`*^9, 
   3.620609366769483*^9}, {3.620616255835601*^9, 3.6206162601802807`*^9}, 
   3.621040904739484*^9, 3.621041214140966*^9, {3.621042046775444*^9, 
   3.62104204773925*^9}, {3.621042226825865*^9, 3.6210422927068233`*^9}, {
   3.621042345115281*^9, 3.621042348120577*^9}, {3.621042402330081*^9, 
   3.621042404806386*^9}, {3.6210424453442297`*^9, 3.621042519328421*^9}, {
   3.621042648473116*^9, 3.621042666867223*^9}, {3.621042763024856*^9, 
   3.621042793820731*^9}, {3.621042895195159*^9, 3.621042895500002*^9}, {
   3.621043537108481*^9, 3.621043537261815*^9}, {3.6210454323147717`*^9, 
   3.621045532805826*^9}, {3.621045702292498*^9, 3.621045750779278*^9}, {
   3.621045791903161*^9, 3.62104579573748*^9}, {3.621045833702125*^9, 
   3.621045934111206*^9}, {3.621046003726132*^9, 3.6210460328649178`*^9}, 
   3.621046106590102*^9, 3.621046342919359*^9, {3.621455038882093*^9, 
   3.621455040741181*^9}, 3.621455108737235*^9, {3.621455152287554*^9, 
   3.621455162434875*^9}, {3.621455234122388*^9, 3.62145526038245*^9}, 
   3.6214553698269777`*^9, {3.621455404665358*^9, 3.6214555017847633`*^9}, {
   3.621455542787671*^9, 3.621455557109638*^9}, {3.6214556212807407`*^9, 
   3.6214556227081213`*^9}, {3.621455661946211*^9, 3.6214556621094093`*^9}, {
   3.621455703268835*^9, 3.621455715116235*^9}, {3.6214558069729013`*^9, 
   3.6214558110741987`*^9}, {3.6234441967447844`*^9, 3.623444203825552*^9}, {
   3.6234457397397957`*^9, 3.623445761694257*^9}, 3.623446567716732*^9, {
   3.623446604210829*^9, 3.623446628516088*^9}, {3.6234466637538967`*^9, 
   3.623446681433465*^9}, {3.623446713955269*^9, 3.6234467520551558`*^9}, {
   3.623447889940892*^9, 3.6234479469816227`*^9}, {3.623448004449768*^9, 
   3.623448023989245*^9}, {3.623452655184437*^9, 3.623452656092662*^9}, {
   3.623454674742041*^9, 3.623454711545314*^9}, {3.6234547985145407`*^9, 
   3.623454820989519*^9}, {3.623454861581347*^9, 3.6234548798025208`*^9}, {
   3.6234549487395687`*^9, 3.6234549500353947`*^9}, {3.623455428250412*^9, 
   3.6234554393923807`*^9}, {3.623455469462274*^9, 3.623455495682942*^9}, {
   3.6234555566030617`*^9, 3.623455593053814*^9}, {3.62345577160909*^9, 
   3.623455807638001*^9}, 3.623455856355179*^9, {3.623456063907948*^9, 
   3.623456065351646*^9}, 3.623456147461492*^9, {3.6234561789794064`*^9, 
   3.623456184282552*^9}, {3.623456223292811*^9, 3.62345622511278*^9}, 
   3.623456270059449*^9, 3.623456304686879*^9, {3.623456348387089*^9, 
   3.623456418676002*^9}, {3.623456459376972*^9, 3.623456477292328*^9}, 
   3.6234565367630987`*^9, {3.624404075253099*^9, 3.624404164179603*^9}, {
   3.624404219112679*^9, 3.624404280255995*^9}, {3.624404340401784*^9, 
   3.624404343173916*^9}, {3.6244043797825613`*^9, 3.624404423456895*^9}, {
   3.624404474844062*^9, 3.624404489256428*^9}, {3.6244086317234707`*^9, 
   3.62440871477737*^9}, {3.6244087453554573`*^9, 3.624408750248608*^9}, {
   3.624408785001333*^9, 3.624408795948601*^9}, {3.62441111421392*^9, 
   3.624411137814186*^9}, {3.6244111795005074`*^9, 3.624411197637904*^9}, {
   3.624411286794807*^9, 3.624411311505014*^9}, {3.6244115285913363`*^9, 
   3.624411565145001*^9}, {3.624662519040344*^9, 3.62466253103239*^9}, {
   3.624662632724684*^9, 3.624662636988411*^9}, {3.624662757031611*^9, 
   3.6246627738849688`*^9}, {3.6246628081421137`*^9, 3.624662808480345*^9}, {
   3.6246628946370087`*^9, 3.624662907892334*^9}, {3.6246629408129663`*^9, 
   3.6246630284727697`*^9}, {3.624663060129676*^9, 3.6246631920113792`*^9}, {
   3.62486416956546*^9, 3.624864188121941*^9}, {3.6248644120023527`*^9, 
   3.6248644139664793`*^9}, {3.624864562899366*^9, 3.624864734489319*^9}, {
   3.6248647720732603`*^9, 3.6248648478611593`*^9}, {3.6248649958978233`*^9, 
   3.624865027411621*^9}, {3.624865117134424*^9, 3.624865173162856*^9}, {
   3.62486576704906*^9, 3.624865831184403*^9}, {3.62486795729457*^9, 
   3.6248679656720324`*^9}, 3.625015301711379*^9, {3.625015680465001*^9, 
   3.625015699306378*^9}, {3.625015739786172*^9, 3.625015842326153*^9}, {
   3.625015880177952*^9, 3.625015881580641*^9}, {3.625015917668*^9, 
   3.625015920693965*^9}, {3.625015971010071*^9, 3.625015992873905*^9}, {
   3.625016581948366*^9, 3.625016604119132*^9}, {3.625016638955708*^9, 
   3.6250166595026217`*^9}, {3.625016835351297*^9, 3.625016835507545*^9}, {
   3.625016869240006*^9, 3.625016869821097*^9}, {3.625017758380497*^9, 
   3.625017834237248*^9}, {3.625017866851321*^9, 3.6250178752128067`*^9}, {
   3.6250179155087843`*^9, 3.625017916501296*^9}, {3.625017948246237*^9, 
   3.625017952763897*^9}, {3.625018184986289*^9, 3.625018217650858*^9}, {
   3.625018279758397*^9, 3.625018282409051*^9}, {3.625018334826487*^9, 
   3.625018336523553*^9}, {3.625019433101728*^9, 3.625019440865203*^9}, {
   3.6250194726900043`*^9, 3.625019479402504*^9}, {3.625019556748291*^9, 
   3.6250195645250187`*^9}, {3.625019608051491*^9, 3.62501963758389*^9}, {
   3.6250196772432537`*^9, 3.6250196893211813`*^9}, {3.625125111303609*^9, 
   3.6251251846962347`*^9}, {3.6251252364845057`*^9, 3.625125261801689*^9}, {
   3.625125452792542*^9, 3.6251254782798653`*^9}, {3.625125591733835*^9, 
   3.625125592057494*^9}, {3.625269909303523*^9, 3.625269914677697*^9}, {
   3.625270066973968*^9, 3.625270070560359*^9}, {3.625270129339987*^9, 
   3.6252701312899513`*^9}, {3.625270161591014*^9, 3.6252701782789583`*^9}, {
   3.6252704483419743`*^9, 3.6252704729364443`*^9}, {3.625270538855547*^9, 
   3.625270561499385*^9}, {3.625270888870798*^9, 3.625270898805822*^9}, {
   3.625270950338904*^9, 3.625271022791389*^9}, {3.625271054685039*^9, 
   3.625271065230259*^9}, {3.625271204718561*^9, 3.625271237809741*^9}, {
   3.6252712794328403`*^9, 3.6252715226928377`*^9}, {3.625271594758276*^9, 
   3.625271604794142*^9}, {3.62527167792943*^9, 3.625271820418035*^9}, {
   3.6252718619338427`*^9, 3.625271862337514*^9}, 3.625272735781177*^9, {
   3.625272782582662*^9, 3.625272782993442*^9}, {3.625272852173975*^9, 
   3.6252730275566483`*^9}, {3.625273064522367*^9, 3.625273126379261*^9}, {
   3.625273165634781*^9, 3.625273171959704*^9}, {3.625273229181272*^9, 
   3.625273296635314*^9}, {3.6252734194266157`*^9, 3.625273527128632*^9}, {
   3.625273595769228*^9, 3.6252736274852962`*^9}, {3.6252744007842283`*^9, 
   3.6252744184347057`*^9}, 3.625274578703972*^9, {3.625274670436412*^9, 
   3.625274677038892*^9}, {3.625274765273642*^9, 3.625274840484355*^9}, {
   3.625274890749083*^9, 3.6252749353366547`*^9}, {3.625274991076643*^9, 
   3.625275011279212*^9}, {3.625275093227521*^9, 3.625275093900675*^9}, {
   3.625275127318462*^9, 3.625275232924762*^9}, {3.62527528872469*^9, 
   3.625275298653767*^9}, {3.625275376074692*^9, 3.625275435910338*^9}, {
   3.625275476736072*^9, 3.625275525624452*^9}, {3.625276011671525*^9, 
   3.625276043105186*^9}, {3.625276078245461*^9, 3.625276098329705*^9}, {
   3.625276140970982*^9, 3.625276151508007*^9}, {3.6252762018248367`*^9, 
   3.625276215929327*^9}, {3.625276354713355*^9, 3.625276420275938*^9}}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.621041171147573*^9, 3.621041194417569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", " ", 
       RowBox[{"{", 
        RowBox[{"R2", "[", 
         RowBox[{"offset_", ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "generator_"}], "]"}], "}"}]}], "]"}],
      "]"}], "[", 
    RowBox[{"v", " ", ":", " ", 
     RowBox[{"BasisVector", "[", 
      RowBox[{
       RowBox[{"Resolution", "[", 
        RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
        "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"involvedCircles", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "invCircles", ",", 
       "\[IndentingNewLine]", "oldSigns", ",", "\[IndentingNewLine]", 
       "circle", ",", "\[IndentingNewLine]", "newCircles", ",", 
       "\[IndentingNewLine]", "otherSigns", ",", "\[IndentingNewLine]", 
       RowBox[{"newSigns1", "=", "Null"}], ",", 
       RowBox[{"newSigns2", "=", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{"braid", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "2"}]}], "}"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"Delete", "[", 
           RowBox[{"resolution", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"offset", "+", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"offset", "+", "2"}], "}"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sign", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"resolution", "\[LeftDoubleBracket]", 
         RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
        
        RowBox[{"resolution", "\[LeftDoubleBracket]", 
         RowBox[{"offset", "+", "2"}], "\[RightDoubleBracket]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"circles", ",", " ", 
                 RowBox[{
                  RowBox[{"4", "*", "offset"}], " ", "+", " ", "#"}]}], "]"}],
                "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "7"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"UnsameQ", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}], "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"The", " ", "..."}], "11"}], "..."}], " ", 
            "resolution"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Work", " ", "out", " ", "which", " ", "circles", " ", "are", " ", 
            "involved"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"involvedCircles", ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"circles", ",", " ", 
                  RowBox[{
                   RowBox[{"4", "*", "offset"}], " ", "+", " ", "#"}]}], 
                 "]"}], "&"}], "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", "7"}], "}"}]}], ",", 
              RowBox[{
               RowBox[{"UnsameQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"involvedCircles", "=", 
            RowBox[{"DeleteDuplicates", "[", "involvedCircles", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invCircles", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"circles", ",", "#"}], "]"}], "&"}], "/@", 
             "involvedCircles"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"oldSigns", "=", 
            RowBox[{"invCircles", "/.", "signs"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Basis vector: \>\"", ",", "v"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"invCircles", ",", "oldSigns"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"resolution", "\[LeftDoubleBracket]", 
                 RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], 
                "\[Equal]", 
                RowBox[{"resolution", "\[LeftDoubleBracket]", 
                 RowBox[{"offset", "+", "2"}], "\[RightDoubleBracket]"}]}], 
               ",", 
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "!=", "1"}]}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Equal]", 
              RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "involvedCircles", "]"}], "\[Equal]", 
                 "3"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "||", 
                   RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"invCircles", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    "invCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "invCircles", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"invCircles", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"invCircles", ",", 
                    RowBox[{
                    RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"4", "*", "offset"}]}], "&"}]}], "]"}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{"invCircles", ",", 
                    RowBox[{
                    RowBox[{"#", ">", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "8"}]}], "&"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"invCircles", "=", 
                    RowBox[{"invCircles", "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"invCircles", "-", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{"offset", "+", "2"}], ")"}]}]}], "]"}]}]}]}], ";",
                    "\[IndentingNewLine]", 
                   RowBox[{"newSigns1", "=", 
                    RowBox[{"{", 
                    RowBox[{"invCircles", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"One", " ", "circle", " ", "splits"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"circle", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    "invCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"value_", "/;", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}]}], ",", "value"}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"circle", "=", 
                  RowBox[{"circle", "-", 
                   RowBox[{"8", "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"circle", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", "circle", "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"newCircles", "=", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", " ", "#"}], "]"}], "&"}], 
                    "/@", "circle"}], ",", 
                    RowBox[{
                    RowBox[{"UnsameQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newCircles", "=", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
                    "newCircles"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"3", ",", "newCircles", ",", 
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"newSigns1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"newSigns1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"newSigns2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Rule]", "1"}]}], 
                    "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", " ", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], " ", "/;",
                " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "circles", "\[LeftDoubleBracket]", "involvedCircles", 
                  "\[RightDoubleBracket]"}], ",", " ", "circle"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"otherSigns", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "8"}], "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                    "]"}]}], "+", 
                   RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], 
             "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"constructBasisVectorOrNot", "[", 
              RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}], 
             "+", 
             RowBox[{"constructBasisVectorOrNot", "[", 
              RowBox[{"image", ",", "newSigns2", ",", "otherSigns"}], 
              "]"}]}]}], "*)"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Circles", " ", "remain", " ", "the", " ", "same"}], ",", 
            " ", 
            RowBox[{"crossings", " ", "removed"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"The", " ", "..."}], "00"}], "..."}], " ", 
            "resolution"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"involvedCircles", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"circles", ",", " ", 
                   RowBox[{
                    RowBox[{"4", "*", "offset"}], " ", "+", " ", "#"}]}], 
                  "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"involvedCircles", "=", 
            RowBox[{"DeleteDuplicates", "[", "involvedCircles", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"newCircles", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{"circles", ","}]}]}], "*)"}], 
           RowBox[{"invCircles", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"circles", ",", "#"}], "]"}], "&"}], "/@", 
             "involvedCircles"}]}], 
           RowBox[{"(*", "]", "*)"}], ";", "\[IndentingNewLine]", 
           RowBox[{"oldSigns", "=", 
            RowBox[{"invCircles", "/.", "signs"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invCircles", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"4", "*", "offset"}]}], "&"}]}], "]"}], ",", 
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"#", ">", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "8"}]}], "&"}]}], 
                 "]"}]}], "]"}], "&"}], "/@", "invCircles"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"newCircles", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"newCircles", ",", "invCircles"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"newCircles", "=", 
              RowBox[{"newCircles", "-", 
               RowBox[{"8", "*", 
                RowBox[{"UnitStep", "[", 
                 RowBox[{"newCircles", "-", 
                  RowBox[{"8", "*", "offset"}]}], "]"}]}]}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"invCircles", "=", 
            RowBox[{"invCircles", "-", 
             RowBox[{"8", "*", 
              RowBox[{"UnitStep", "[", 
               RowBox[{"invCircles", "-", 
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "2"}], ")"}]}]}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"newSigns1", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"invCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", " ", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], " ", "/;",
                " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "circles", "\[LeftDoubleBracket]", "involvedCircles", 
                  "\[RightDoubleBracket]"}], ",", " ", "circle"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"otherSigns", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "8"}], "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                    "]"}]}], "+", 
                   RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"resolution", "\[LeftDoubleBracket]", 
              RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "1"}], ",", 
            RowBox[{"sign", "=", 
             RowBox[{
              RowBox[{"-", "1"}], "*", "sign"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"v", ",", "\"\< is sent to \>\"", ",", 
            RowBox[{"sign", "*", 
             RowBox[{"constructBasisVectorOrNot", "[", 
              RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], 
              "]"}]}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"resolution", "\[LeftDoubleBracket]", 
            RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], 
           "\[Equal]", "1"}], ",", 
          RowBox[{"sign", "=", 
           RowBox[{"-", 
            RowBox[{"Sign", "[", "generator", "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sign", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}], 
           "+", " ", 
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns2", ",", "otherSigns"}], "]"}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]",
       "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.618613341424855*^9, 3.618613349198995*^9}, {
   3.6186134182559547`*^9, 3.618613420677825*^9}, {3.618613461390503*^9, 
   3.618613592528639*^9}, {3.618613657979141*^9, 3.618613658870349*^9}, {
   3.618613752065693*^9, 3.618613804151257*^9}, {3.618613859456768*^9, 
   3.6186139517180643`*^9}, {3.618614241799459*^9, 3.618614261611309*^9}, {
   3.618616251380883*^9, 3.618616311216395*^9}, {3.618616341275741*^9, 
   3.618616377882416*^9}, {3.618616414765052*^9, 3.618616501688735*^9}, {
   3.618616545664077*^9, 3.618616631825614*^9}, {3.6186166647733517`*^9, 
   3.6186168328056726`*^9}, {3.618616882306608*^9, 3.618616919316712*^9}, {
   3.61861820659482*^9, 3.6186183036721287`*^9}, {3.618618367503747*^9, 
   3.618618407202963*^9}, {3.618618495828561*^9, 3.618618522633103*^9}, {
   3.6186185567673693`*^9, 3.6186187302221317`*^9}, {3.618618766768297*^9, 
   3.6186188092448378`*^9}, {3.6186253564891376`*^9, 3.618625357414706*^9}, {
   3.618782574981461*^9, 3.6187825764528437`*^9}, {3.618980211433425*^9, 
   3.618980235077745*^9}, {3.619148814518977*^9, 3.6191488245700827`*^9}, {
   3.61914887017402*^9, 3.61914899319121*^9}, {3.619149236024198*^9, 
   3.619149349142765*^9}, {3.6191495282068863`*^9, 3.619149528370914*^9}, {
   3.619166983334838*^9, 3.619167184775565*^9}, {3.619167436496315*^9, 
   3.619167448618741*^9}, {3.619167497489479*^9, 3.619167539680531*^9}, {
   3.619167575974737*^9, 3.619167577730814*^9}, {3.619167615087943*^9, 
   3.619167627431431*^9}, {3.6191677616824007`*^9, 3.619167824403235*^9}, {
   3.6191678850481052`*^9, 3.619167967685361*^9}, {3.6191680326515636`*^9, 
   3.619168057384907*^9}, {3.619168119210404*^9, 3.6191681201287527`*^9}, {
   3.619168190560864*^9, 3.619168268581787*^9}, {3.619168338452586*^9, 
   3.619168384153097*^9}, {3.619168425567297*^9, 3.619168435745082*^9}, {
   3.619168478934826*^9, 3.619168599577063*^9}, {3.619168659567816*^9, 
   3.619168725057994*^9}, {3.619169026148322*^9, 3.619169085348091*^9}, {
   3.619169279816074*^9, 3.619169322449552*^9}, {3.619169364292123*^9, 
   3.6191695040983973`*^9}, {3.619169541480383*^9, 3.619169630261318*^9}, {
   3.619169707935396*^9, 3.6191697754653788`*^9}, {3.619169909236965*^9, 
   3.619169936556849*^9}, {3.619169999963838*^9, 3.619170084101035*^9}, {
   3.623456754734995*^9, 3.623456756958961*^9}, {3.6234568227938347`*^9, 
   3.623456847241559*^9}, {3.623457076912862*^9, 3.623457092744954*^9}, {
   3.6234571272001553`*^9, 3.6234571327251596`*^9}, {3.623457210255533*^9, 
   3.623457316720546*^9}, 3.623457351877684*^9, {3.623457435132166*^9, 
   3.62345745669189*^9}, {3.6234574869380703`*^9, 3.6234575353328047`*^9}, {
   3.623457586853407*^9, 3.623457595407*^9}, {3.623457642453382*^9, 
   3.623457644347348*^9}, {3.623457900558168*^9, 3.623457954034664*^9}, {
   3.6234581658931103`*^9, 3.6234581852487392`*^9}, {3.6234583499047956`*^9, 
   3.623458351799409*^9}, {3.623458384719101*^9, 3.623458389211522*^9}, {
   3.623458440014035*^9, 3.623458440325137*^9}, {3.623458488814878*^9, 
   3.623458496458214*^9}, {3.62345856198715*^9, 3.623458563047371*^9}, {
   3.623458724756666*^9, 3.623458725778736*^9}, {3.623471441645203*^9, 
   3.6234714896090717`*^9}, {3.623471752875012*^9, 3.623471801448185*^9}, {
   3.623471846596273*^9, 3.623471902110608*^9}, {3.623472007409747*^9, 
   3.623472016586835*^9}, {3.623472683151264*^9, 3.623472723995049*^9}, {
   3.6235336409416113`*^9, 3.623533642804912*^9}, {3.623550723628173*^9, 
   3.623550740365287*^9}, {3.623550840797308*^9, 3.62355088127658*^9}, {
   3.623550980159774*^9, 3.623550986484735*^9}, {3.623551058588923*^9, 
   3.623551079404435*^9}, {3.6235511506825037`*^9, 3.623551182867784*^9}, {
   3.6235512580019217`*^9, 3.623551385804585*^9}, {3.6235514522096024`*^9, 
   3.623551558950242*^9}, {3.62355166968968*^9, 3.6235516732860126`*^9}, {
   3.6235517255572567`*^9, 3.623551792650837*^9}, {3.623551829567793*^9, 
   3.62355186539977*^9}, {3.6235518996390038`*^9, 3.623551916036993*^9}, 
   3.623553721531468*^9, {3.6235644089363947`*^9, 3.623564414399954*^9}, {
   3.623607085619008*^9, 3.6236071090369663`*^9}, {3.6236072404293413`*^9, 
   3.623607257601344*^9}, {3.623607356504767*^9, 3.623607371121469*^9}, {
   3.623607477115768*^9, 3.623607530462883*^9}, {3.6236075666355352`*^9, 
   3.623607567322551*^9}, {3.623607603333602*^9, 3.623607625950906*^9}, {
   3.6236076822661552`*^9, 3.6236077224949408`*^9}, {3.623607777771896*^9, 
   3.623607825761973*^9}, {3.6236078693108187`*^9, 3.6236079011471977`*^9}, {
   3.6236079375780888`*^9, 3.623607955617169*^9}, {3.623608007694544*^9, 
   3.6236080993436537`*^9}, {3.6236081423154488`*^9, 3.623608215381971*^9}, {
   3.623608435288311*^9, 3.6236084447969522`*^9}, {3.623608478964595*^9, 
   3.623608534539065*^9}, {3.623608569027996*^9, 3.623608720261422*^9}, 
   3.623608756586554*^9, {3.623608799787148*^9, 3.623608800007258*^9}, {
   3.623608844641094*^9, 3.623608847450388*^9}, {3.623608892025008*^9, 
   3.623608893628806*^9}, {3.6236089401975307`*^9, 3.623608940661519*^9}, {
   3.623621701925336*^9, 3.623621704267973*^9}, {3.623622080994454*^9, 
   3.623622101903679*^9}, {3.623622134261014*^9, 3.623622136423967*^9}, {
   3.623622167461484*^9, 3.623622183381612*^9}, {3.623622217792981*^9, 
   3.623622300408608*^9}, {3.623622335063023*^9, 3.623622335986998*^9}, {
   3.623622393525057*^9, 3.623622399089076*^9}, {3.6236224801280518`*^9, 
   3.623622585425907*^9}, {3.6236226694110527`*^9, 3.623622698143858*^9}, {
   3.623622876208733*^9, 3.623622887113344*^9}, {3.623622921677573*^9, 
   3.6236230033649197`*^9}, {3.62362307553794*^9, 3.623623102260499*^9}, {
   3.623624405706609*^9, 3.623624416417983*^9}, {3.623624450214628*^9, 
   3.6236244870079327`*^9}, {3.6236245451326227`*^9, 3.623624729897439*^9}, {
   3.623624798465508*^9, 3.623624835439159*^9}, {3.623624871942111*^9, 
   3.623624904446806*^9}, {3.6236249997870073`*^9, 3.623625001797846*^9}, {
   3.623625032834642*^9, 3.6236250344571877`*^9}, {3.623804650191689*^9, 
   3.623804665583414*^9}, {3.623804743701007*^9, 3.623804764211759*^9}, {
   3.623954075135729*^9, 3.6239541114633293`*^9}, {3.624220894003269*^9, 
   3.6242209256213512`*^9}, {3.624221019988164*^9, 3.624221023504184*^9}, {
   3.6242211274237337`*^9, 3.624221133957568*^9}, 3.624255026933858*^9, {
   3.624255249593219*^9, 3.624255251671049*^9}, {3.624255565436812*^9, 
   3.6242555666646633`*^9}, {3.624255779708455*^9, 3.62425579931443*^9}, {
   3.624256012419668*^9, 3.624256041702674*^9}, {3.624256654414853*^9, 
   3.624256655823966*^9}, {3.624256805418457*^9, 3.624256828513062*^9}, {
   3.624256907009871*^9, 3.6242569229610662`*^9}, {3.624257557216075*^9, 
   3.6242576156711073`*^9}, 3.624257699727467*^9, {3.6242592405495567`*^9, 
   3.6242592568877296`*^9}, {3.6242593027252274`*^9, 3.624259336290431*^9}, {
   3.624259510400186*^9, 3.624259528635029*^9}, {3.6242595701079884`*^9, 
   3.6242595753901243`*^9}, {3.6242596477451143`*^9, 3.624259719239183*^9}, {
   3.624259761386973*^9, 3.6242597638170023`*^9}, {3.6242598011943893`*^9, 
   3.62425988144482*^9}, {3.6242599405852337`*^9, 3.624259968899873*^9}, 
   3.624864205370945*^9, {3.624864315069975*^9, 3.624864338325186*^9}, {
   3.624864894521162*^9, 3.624864918008472*^9}, {3.6248679982476482`*^9, 
   3.624867998519527*^9}, {3.625015461990429*^9, 3.625015463998341*^9}, {
   3.625017983772854*^9, 3.625018004985976*^9}, {3.625018073080764*^9, 
   3.625018109430297*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Defining the Cycling chain maps\
\>", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
  3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
  3.625124067226338*^9}, {3.625958028346739*^9, 3.625958029517743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Positive", " ", "direction", " ", "pulls", " ", "crossings", " ", "from", 
    " ", "the", " ", "top", " ", 
    RowBox[{"(", "end", ")"}], " ", "around", " ", "to", " ", "the", " ", 
    "bottom", " ", 
    RowBox[{"(", "start", ")"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Cycle", "[", "offset_", "]"}], "}"}]}], "]"}], "]"}], "[", 
     RowBox[{"v", " ", ":", " ", 
      RowBox[{"BasisVector", "[", 
       RowBox[{
        RowBox[{"Resolution", "[", 
         RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
         "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"image", ",", "\[IndentingNewLine]", 
        RowBox[{"newBraid", "=", "braid"}], ",", " ", "newResolution", ",", 
        "newCircles", ",", "\[IndentingNewLine]", "oldSigns", ",", "newSigns",
         ",", 
        RowBox[{"sign", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Renumber", " ", "resolution"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{
          "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "offset"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newResolution", "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{"resolution", ",", "offset"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Assign", " ", "signs"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"#", ",", 
            RowBox[{"part_", "/;", 
             RowBox[{
              RowBox[{"part", ">", 
               RowBox[{"4", "*", 
                RowBox[{"Length", "[", "resolution", "]"}]}]}], "||", 
              RowBox[{"part", "\[Equal]", "4"}]}]}]}], "]"}], "&"}], "/@", 
         "circles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], "*", "offset", "*", 
             RowBox[{"UnitStep", "[", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"Length", "[", "resolution", "]"}]}], "+", "1", "-", 
               "newCircles"}], "]"}]}], "+", "newCircles"}], ",", 
           RowBox[{"4", "*", 
            RowBox[{"Length", "[", "resolution", "]"}]}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", 
           RowBox[{"4", "*", 
            RowBox[{"Length", "[", "resolution", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
              "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
          "newCircles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}], "/@",
          "newCircles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"oldSigns", "=", 
        RowBox[{"circles", "/.", "signs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newSigns", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"newCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EvenQ", "[", 
           RowBox[{"Total", "[", "resolution", "]"}], "]"}], "&&", " ", 
          RowBox[{"OddQ", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"resolution", ",", "offset"}], "]"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"sign", "=", 
          RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sign", "*", 
        RowBox[{"constructBasisVectorOrNot", "[", 
         RowBox[{"image", ",", "newSigns", ",", 
          RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.624320083635276*^9, 3.624320197072939*^9}, {
   3.6243202664201603`*^9, 3.624320391501302*^9}, {3.624320867012599*^9, 
   3.624320961066697*^9}, {3.6243271090782213`*^9, 3.624327134634194*^9}, {
   3.624327172189621*^9, 3.6243271752820053`*^9}, {3.624327205348606*^9, 
   3.6243273704219437`*^9}, {3.6243274142233887`*^9, 3.624327464826963*^9}, {
   3.624327544717513*^9, 3.62432760193426*^9}, {3.624327733765423*^9, 
   3.624327764455778*^9}, {3.624327829422874*^9, 3.62432787618649*^9}, {
   3.624327910562776*^9, 3.6243279640562162`*^9}, {3.6243279977953243`*^9, 
   3.6243281179741783`*^9}, {3.624328276483886*^9, 3.6243282770882807`*^9}, {
   3.6243283230853233`*^9, 3.62432834171486*^9}, {3.6243283734167547`*^9, 
   3.624328470089898*^9}, {3.6243285415030413`*^9, 3.6243285524243803`*^9}, {
   3.624328595698901*^9, 3.624328628721127*^9}, {3.6243286871227417`*^9, 
   3.624328716722827*^9}, {3.624328877073432*^9, 3.6243288862224197`*^9}, {
   3.624382839178691*^9, 3.624382846018063*^9}, 3.6243829245555696`*^9, {
   3.624383000536127*^9, 3.624383004904776*^9}, {3.624398128641192*^9, 
   3.62439813001228*^9}, {3.6243983930387383`*^9, 3.6243984145991793`*^9}, {
   3.624398462671596*^9, 3.624398474319121*^9}, {3.624830477680475*^9, 
   3.624830484127919*^9}, {3.624830606805632*^9, 3.6248306459960012`*^9}, {
   3.624830719521307*^9, 3.624830757233979*^9}, {3.624833687246334*^9, 
   3.6248336918388453`*^9}, {3.624833762923613*^9, 3.624833763904071*^9}, {
   3.624834102324976*^9, 3.6248341410218153`*^9}, {3.625958043514949*^9, 
   3.6259580454029303`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Defining the Reidemeister 1 chain maps\
\>", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
  3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
  3.625124067226338*^9}, {3.625958050238245*^9, 3.625958050373128*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Stabilise", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", 
        RowBox[{"{", 
         RowBox[{"R1", "[", 
          RowBox[{"1", ",", "sign_", ",", "offset_"}], "]"}], "}"}]}], "]"}], 
      "]"}], "[", 
     RowBox[{"v", " ", ":", " ", 
      RowBox[{"BasisVector", "[", 
       RowBox[{
        RowBox[{"Resolution", "[", 
         RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
         "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newBraid", ",", "\[IndentingNewLine]", "newResolution", ",", 
        "\[IndentingNewLine]", "newGenerator", ",", "\[IndentingNewLine]", 
        "image", ",", "\[IndentingNewLine]", "prev", ",", 
        "\[IndentingNewLine]", "involvedCircle", ",", "newCircle", ",", 
        "\[IndentingNewLine]", "newSigns1", ",", "newSigns2", ",", 
        "otherSigns"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newGenerator", "=", 
        RowBox[{
        "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newBraid", "=", 
        RowBox[{"BR", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "+", "1"}], ",", 
          RowBox[{"Insert", "[", 
           RowBox[{
            RowBox[{
            "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"sign", "*", "newGenerator"}], ",", 
            RowBox[{"offset", "+", "1"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newResolution", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"resolution", ",", "0", ",", 
          RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prev", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{
              "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
               ",", "offset"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
            "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"prev", "\[Equal]", 
          RowBox[{"-", "\[Infinity]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"involvedCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"circles", ",", " ", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
                
                RowBox[{
                "braid", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "\[LeftDoubleBracket]",
              "1", "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"Length", "[", "resolution", "]"}]}], "+", "4", " ", 
                "+", " ", 
                RowBox[{
                "braid", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "\[LeftDoubleBracket]",
              "1", "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"involvedCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"circles", ",", " ", 
               RowBox[{
                RowBox[{"4", "*", "prev"}], "|", 
                RowBox[{
                 RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{
                RowBox[{"4", "*", "prev"}], "|", 
                RowBox[{
                 RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"otherSigns", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"signs", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], "/;", 
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"circle", ",", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
               RowBox[{
               "braid", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "]"}], "\[NotEqual]", 
            "0"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"otherSigns", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"otherSigns", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"UnitStep", "[", 
                 RowBox[{
                  RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                   RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                 "]"}]}], "+", 
               RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}],
             "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sign", "\[Equal]", "1"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "circles", "\[LeftDoubleBracket]", "involvedCircle", 
              "\[RightDoubleBracket]"}], "/.", "signs"}], ")"}], "\[Equal]", 
           "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newSigns1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"image", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "newCircle"}], "\[RightDoubleBracket]"}], 
              "\[Rule]", "1"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "1"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], "+", "5", "+", 
                 RowBox[{
                 "braid", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", 
              RowBox[{"-", "1"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newSigns2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"image", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "newCircle"}], "\[RightDoubleBracket]"}], 
              "\[Rule]", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "1"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], "+", "5", "+", 
                 RowBox[{
                 "braid", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", "1"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}], 
           "-", 
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns2", ",", "otherSigns"}], "]"}]}]}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newSigns1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"image", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "newCircle"}], "\[RightDoubleBracket]"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "circles", "\[LeftDoubleBracket]", "involvedCircle", 
                 "\[RightDoubleBracket]"}], "/.", "signs"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "1"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], "+", "5", "+", 
                 RowBox[{
                 "braid", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", 
              RowBox[{"-", "sign"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.625296384795722*^9, 3.625296414438493*^9}, {
   3.6252964513925*^9, 3.6252965076766977`*^9}, {3.625296642206311*^9, 
   3.625296700788237*^9}, {3.625296850806275*^9, 3.625296934257928*^9}, {
   3.625297003229725*^9, 3.625297117779125*^9}, {3.625333692737029*^9, 
   3.625333818554447*^9}, {3.6253338489989*^9, 3.625333911883304*^9}, {
   3.625333943524468*^9, 3.625333961647828*^9}, {3.6253340509482937`*^9, 
   3.625334052645235*^9}, {3.62533410183566*^9, 3.625334164929306*^9}, {
   3.6253342252319117`*^9, 3.625334226697975*^9}, {3.625334293167889*^9, 
   3.625334607668301*^9}, {3.625334676197785*^9, 3.6253348636213303`*^9}, {
   3.625334929627324*^9, 3.625334968025367*^9}, {3.625765697087347*^9, 
   3.625765732009801*^9}, 3.6259512246414537`*^9, {3.625951316480184*^9, 
   3.625951317733767*^9}, {3.625951429208975*^9, 3.625951533466097*^9}, {
   3.62595157333256*^9, 3.6259516084727592`*^9}, {3.6259519477970133`*^9, 
   3.625951954906933*^9}, {3.625951987489849*^9, 3.6259519920364513`*^9}, {
   3.62595206604067*^9, 3.625952072856246*^9}, {3.625952104410121*^9, 
   3.6259521325894403`*^9}, {3.62595216362477*^9, 3.625952193194983*^9}, {
   3.625952233351774*^9, 3.625952258455459*^9}, {3.625952290312024*^9, 
   3.625952324475013*^9}, {3.625952357754019*^9, 3.625952363436268*^9}, {
   3.625952472334297*^9, 3.6259525152208757`*^9}, {3.625952586741355*^9, 
   3.625952692154002*^9}, {3.625952748284173*^9, 3.6259527664565287`*^9}, {
   3.6259528176364393`*^9, 3.6259528411172113`*^9}, {3.625952899651116*^9, 
   3.625952911706814*^9}, {3.6259530154476833`*^9, 3.625953015640126*^9}, {
   3.625958057211233*^9, 3.625958063954792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Destabilise", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", 
        RowBox[{"{", 
         RowBox[{"R1", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}]}], "]"}], "]"}], "[", 
     RowBox[{"v", " ", ":", " ", 
      RowBox[{"BasisVector", "[", 
       RowBox[{
        RowBox[{"Resolution", "[", 
         RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
         "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newBraid", ",", "\[IndentingNewLine]", "newResolution", ",", 
        "\[IndentingNewLine]", "oldGenerator", ",", "generatorPos", ",", 
        "\[IndentingNewLine]", "image", ",", "\[IndentingNewLine]", "prev", 
        ",", "\[IndentingNewLine]", "involvedCircle", ",", "newCircle", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"extraSigns", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], ",", 
        RowBox[{"sign", "=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"newSigns", "=", "Null"}], ",", "otherSigns"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1"}]}], "]"}], "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Could not remove generator\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"oldGenerator", "=", 
        RowBox[{
         RowBox[{
         "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-",
          "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"generatorPos", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ",", "oldGenerator"}], "]"}], "\[LeftDoubleBracket]", "1",
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newBraid", "=", 
        RowBox[{"BR", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "-", "1"}], ",", 
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{
            "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", "generatorPos"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newResolution", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"resolution", ",", "generatorPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "resolution", "\[LeftDoubleBracket]", "generatorPos", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<signs = \>\"", ",", "signs", ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"Length", "[", "resolution", "]"}]}], "+", 
              RowBox[{
              "braid", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", "generatorPos"}], "-", "2"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "extraSigns", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "=", " ", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], "/;", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"circle", ",", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"Length", "[", "resolution", "]"}]}], "+", 
                   RowBox[{
                   "braid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "\[NotEqual]", 
                "0"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "extraSigns", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "=", " ", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], "/;", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"circle", ",", 
                  RowBox[{
                   RowBox[{"4", "*", "generatorPos"}], "-", "2"}]}], "]"}], 
                "\[NotEqual]", "0"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"otherSigns", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"signs", ",", 
             RowBox[{"sign_", "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"extraSigns", ",", "sign"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"otherSigns", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"otherSigns", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                   RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"4", "*", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "generatorPos"}], "+", "1"}], ")"}]}], 
                    "]"}]}]}], ")"}]}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"braid", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "generatorPos"}], "\[RightDoubleBracket]"}], 
              "]"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "extraSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[Equal]", 
               RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newSigns", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                   "1", "\[RightDoubleBracket]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{
                   "extraSigns", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "extraSigns", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "extraSigns", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newSigns", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "\[Rule]", "1"}], "}"}]}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"newSigns", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"sign", "=", 
                 RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "extraSigns", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{"newSigns", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sign", "*", 
        RowBox[{"constructBasisVectorOrNot", "[", 
         RowBox[{"image", ",", "newSigns", ",", "otherSigns"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6259580810995703`*^9, 3.625958085209897*^9}, {
  3.6259680139260063`*^9, 3.6259680588397293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Only", " ", "show", " ", "the", " ", "non"}], "-", 
    RowBox[{
    "zero", " ", "matrices", " ", "in", " ", "a", " ", "GradedLinearMap"}]}], 
   " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"removeZeroes", "[", "listm_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
        "listm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
          "0"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.625362494774827*^9, 3.625362589529448*^9}, {
  3.6253626275206537`*^9, 3.625362635815765*^9}, {3.625362706268257*^9, 
  3.625362722298448*^9}, {3.6253628473824787`*^9, 3.625362852901072*^9}, {
  3.625958164441554*^9, 3.6259581921416073`*^9}}]
}, Open  ]]
},
WindowSize->{698, 787},
WindowMargins->{{Automatic, 143}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 227, 3, 80, "Section"],
Cell[809, 27, 273, 8, 28, "Input"],
Cell[1085, 37, 817, 25, 63, "Input"],
Cell[1905, 64, 773, 16, 63, "Input"],
Cell[2681, 82, 1332, 37, 63, "Input"],
Cell[4016, 121, 502, 13, 46, "Input"],
Cell[4521, 136, 238, 6, 28, "Input"],
Cell[4762, 144, 61757, 1338, 2946, "Input"],
Cell[66522, 1484, 92, 1, 28, "Input"],
Cell[66617, 1487, 31770, 669, 1610, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98424, 2161, 274, 5, 80, "Section"],
Cell[98701, 2168, 7479, 173, 539, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106217, 2346, 281, 5, 80, "Section"],
Cell[106501, 2353, 12632, 289, 745, "Input"],
Cell[119136, 2644, 13556, 314, 998, "Input"],
Cell[132695, 2960, 1099, 28, 97, "Input"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
