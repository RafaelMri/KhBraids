(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    273319,       6113]
NotebookOptionsPosition[    270863,       6034]
NotebookOutlinePosition[    271220,       6050]
CellTagsIndexPosition[    271177,       6047]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Defining the Cycling chain maps", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
  3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
  3.625124067226338*^9}, {3.625958028346739*^9, 3.625958029517743*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Positive", " ", "direction", " ", "pulls", " ", "crossings", " ", "from", 
    " ", "the", " ", "top", " ", 
    RowBox[{"(", "end", ")"}], " ", "around", " ", "to", " ", "the", " ", 
    "bottom", " ", 
    RowBox[{"(", "start", ")"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", " ", 
        RowBox[{"{", 
         RowBox[{"Cycle", "[", "offset_", "]"}], "}"}]}], "]"}], "]"}], "[", 
     RowBox[{"v", " ", ":", " ", 
      RowBox[{"BasisVector", "[", 
       RowBox[{
        RowBox[{"Resolution", "[", 
         RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
         "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"image", ",", "\[IndentingNewLine]", 
        RowBox[{"newBraid", "=", "braid"}], ",", " ", "newResolution", ",", 
        "newCircles", ",", "\[IndentingNewLine]", "oldSigns", ",", "newSigns",
         ",", 
        RowBox[{"sign", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Renumber", " ", "resolution"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
        "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
        "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{
          RowBox[{
          "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          ",", "offset"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newResolution", "=", 
        RowBox[{"RotateLeft", "[", 
         RowBox[{"resolution", ",", "offset"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"Assign", " ", "signs"}], " ", "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"#", ",", 
            RowBox[{"part_", "/;", 
             RowBox[{
              RowBox[{"part", ">", 
               RowBox[{"4", "*", 
                RowBox[{"Length", "[", "resolution", "]"}]}]}], "||", 
              RowBox[{"part", "\[Equal]", "4"}]}]}]}], "]"}], "&"}], "/@", 
         "circles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "4"}], "*", "offset", "*", 
             RowBox[{"UnitStep", "[", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"Length", "[", "resolution", "]"}]}], "+", "1", "-", 
               "newCircles"}], "]"}]}], "+", "newCircles"}], ",", 
           RowBox[{"4", "*", 
            RowBox[{"Length", "[", "resolution", "]"}]}]}], "]"}], "/.", 
         RowBox[{"{", 
          RowBox[{"0", "\[Rule]", 
           RowBox[{"4", "*", 
            RowBox[{"Length", "[", "resolution", "]"}]}]}], "}"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
              "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
          "newCircles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}], "/@",
          "newCircles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"oldSigns", "=", 
        RowBox[{"circles", "/.", "signs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newSigns", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"newCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"EvenQ", "[", 
           RowBox[{"Total", "[", "resolution", "]"}], "]"}], "&&", " ", 
          RowBox[{"OddQ", "[", 
           RowBox[{"Total", "[", 
            RowBox[{"Take", "[", 
             RowBox[{"resolution", ",", "offset"}], "]"}], "]"}], "]"}]}], 
         ",", 
         RowBox[{"sign", "=", 
          RowBox[{"-", "1"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sign", "*", 
        RowBox[{"constructBasisVectorOrNot", "[", 
         RowBox[{"image", ",", "newSigns", ",", 
          RowBox[{"{", "}"}]}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.624320083635276*^9, 3.624320197072939*^9}, {
   3.6243202664201603`*^9, 3.624320391501302*^9}, {3.624320867012599*^9, 
   3.624320961066697*^9}, {3.6243271090782213`*^9, 3.624327134634194*^9}, {
   3.624327172189621*^9, 3.6243271752820053`*^9}, {3.624327205348606*^9, 
   3.6243273704219437`*^9}, {3.6243274142233887`*^9, 3.624327464826963*^9}, {
   3.624327544717513*^9, 3.62432760193426*^9}, {3.624327733765423*^9, 
   3.624327764455778*^9}, {3.624327829422874*^9, 3.62432787618649*^9}, {
   3.624327910562776*^9, 3.6243279640562162`*^9}, {3.6243279977953243`*^9, 
   3.6243281179741783`*^9}, {3.624328276483886*^9, 3.6243282770882807`*^9}, {
   3.6243283230853233`*^9, 3.62432834171486*^9}, {3.6243283734167547`*^9, 
   3.624328470089898*^9}, {3.6243285415030413`*^9, 3.6243285524243803`*^9}, {
   3.624328595698901*^9, 3.624328628721127*^9}, {3.6243286871227417`*^9, 
   3.624328716722827*^9}, {3.624328877073432*^9, 3.6243288862224197`*^9}, {
   3.624382839178691*^9, 3.624382846018063*^9}, 3.6243829245555696`*^9, {
   3.624383000536127*^9, 3.624383004904776*^9}, {3.624398128641192*^9, 
   3.62439813001228*^9}, {3.6243983930387383`*^9, 3.6243984145991793`*^9}, {
   3.624398462671596*^9, 3.624398474319121*^9}, {3.624830477680475*^9, 
   3.624830484127919*^9}, {3.624830606805632*^9, 3.6248306459960012`*^9}, {
   3.624830719521307*^9, 3.624830757233979*^9}, {3.624833687246334*^9, 
   3.6248336918388453`*^9}, {3.624833762923613*^9, 3.624833763904071*^9}, {
   3.624834102324976*^9, 3.6248341410218153`*^9}, {3.625958043514949*^9, 
   3.6259580454029303`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Defining the Reidemeister 1 chain maps", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
  3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
  3.625124067226338*^9}, {3.625958050238245*^9, 3.625958050373128*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Stabilise", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", 
        RowBox[{"{", 
         RowBox[{"R1", "[", 
          RowBox[{"1", ",", "sign_", ",", "offset_"}], "]"}], "}"}]}], "]"}], 
      "]"}], "[", 
     RowBox[{"v", " ", ":", " ", 
      RowBox[{"BasisVector", "[", 
       RowBox[{
        RowBox[{"Resolution", "[", 
         RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
         "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newBraid", ",", "\[IndentingNewLine]", "newResolution", ",", 
        "\[IndentingNewLine]", "newGenerator", ",", "\[IndentingNewLine]", 
        "image", ",", "\[IndentingNewLine]", "prev", ",", 
        "\[IndentingNewLine]", "involvedCircle", ",", "newCircle", ",", 
        "\[IndentingNewLine]", "newSigns1", ",", "newSigns2", ",", 
        "otherSigns"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"newGenerator", "=", 
        RowBox[{
        "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"newBraid", "=", 
        RowBox[{"BR", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "+", "1"}], ",", 
          RowBox[{"Insert", "[", 
           RowBox[{
            RowBox[{
            "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{"sign", "*", "newGenerator"}], ",", 
            RowBox[{"offset", "+", "1"}]}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newResolution", "=", 
        RowBox[{"Insert", "[", 
         RowBox[{"resolution", ",", "0", ",", 
          RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"prev", "=", 
        RowBox[{"Max", "[", 
         RowBox[{"Position", "[", 
          RowBox[{
           RowBox[{"Abs", "[", 
            RowBox[{"Take", "[", 
             RowBox[{
              RowBox[{
              "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
               ",", "offset"}], "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
            "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "-", "1"}]}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"prev", "\[Equal]", 
          RowBox[{"-", "\[Infinity]"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"involvedCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"circles", ",", " ", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
                
                RowBox[{
                "braid", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "\[LeftDoubleBracket]",
              "1", "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"Length", "[", "resolution", "]"}]}], "+", "4", " ", 
                "+", " ", 
                RowBox[{
                "braid", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}]}]}], "]"}], "\[LeftDoubleBracket]",
              "1", "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"involvedCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{"circles", ",", " ", 
               RowBox[{
                RowBox[{"4", "*", "prev"}], "|", 
                RowBox[{
                 RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"newCircle", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], ",", " ", 
               RowBox[{
                RowBox[{"4", "*", "prev"}], "|", 
                RowBox[{
                 RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
             "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}]}]}], 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"otherSigns", "=", " ", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"signs", ",", " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], "/;", 
           RowBox[{
            RowBox[{"Count", "[", 
             RowBox[{"circle", ",", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
               RowBox[{
               "braid", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}]}], "]"}], "\[NotEqual]", 
            "0"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"otherSigns", "=", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"otherSigns", ",", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", "*", 
                RowBox[{"UnitStep", "[", 
                 RowBox[{
                  RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                   RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                 "]"}]}], "+", 
               RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}],
             "&"}], "/@", 
           RowBox[{"Range", "[", 
            RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"sign", "\[Equal]", "1"}], "&&", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
             "circles", "\[LeftDoubleBracket]", "involvedCircle", 
              "\[RightDoubleBracket]"}], "/.", "signs"}], ")"}], "\[Equal]", 
           "1"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newSigns1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"image", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "newCircle"}], "\[RightDoubleBracket]"}], 
              "\[Rule]", "1"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "1"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], "+", "5", "+", 
                 RowBox[{
                 "braid", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", 
              RowBox[{"-", "1"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"newSigns2", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"image", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "newCircle"}], "\[RightDoubleBracket]"}], 
              "\[Rule]", 
              RowBox[{"-", "1"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "1"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], "+", "5", "+", 
                 RowBox[{
                 "braid", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", "1"}]}], 
            "}"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}], 
           "-", 
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns2", ",", "otherSigns"}], "]"}]}]}],
          ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"newSigns1", "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"image", "\[LeftDoubleBracket]", 
               RowBox[{"3", ",", "newCircle"}], "\[RightDoubleBracket]"}], 
              "\[Rule]", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "circles", "\[LeftDoubleBracket]", "involvedCircle", 
                 "\[RightDoubleBracket]"}], "/.", "signs"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "1"}], ")"}]}], ",", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], "+", "5", "+", 
                 RowBox[{
                 "braid", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}]}], "}"}], "\[Rule]", 
              RowBox[{"-", "sign"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
          
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.625296384795722*^9, 3.625296414438493*^9}, {
   3.6252964513925*^9, 3.6252965076766977`*^9}, {3.625296642206311*^9, 
   3.625296700788237*^9}, {3.625296850806275*^9, 3.625296934257928*^9}, {
   3.625297003229725*^9, 3.625297117779125*^9}, {3.625333692737029*^9, 
   3.625333818554447*^9}, {3.6253338489989*^9, 3.625333911883304*^9}, {
   3.625333943524468*^9, 3.625333961647828*^9}, {3.6253340509482937`*^9, 
   3.625334052645235*^9}, {3.62533410183566*^9, 3.625334164929306*^9}, {
   3.6253342252319117`*^9, 3.625334226697975*^9}, {3.625334293167889*^9, 
   3.625334607668301*^9}, {3.625334676197785*^9, 3.6253348636213303`*^9}, {
   3.625334929627324*^9, 3.625334968025367*^9}, {3.625765697087347*^9, 
   3.625765732009801*^9}, 3.6259512246414537`*^9, {3.625951316480184*^9, 
   3.625951317733767*^9}, {3.625951429208975*^9, 3.625951533466097*^9}, {
   3.62595157333256*^9, 3.6259516084727592`*^9}, {3.6259519477970133`*^9, 
   3.625951954906933*^9}, {3.625951987489849*^9, 3.6259519920364513`*^9}, {
   3.62595206604067*^9, 3.625952072856246*^9}, {3.625952104410121*^9, 
   3.6259521325894403`*^9}, {3.62595216362477*^9, 3.625952193194983*^9}, {
   3.625952233351774*^9, 3.625952258455459*^9}, {3.625952290312024*^9, 
   3.625952324475013*^9}, {3.625952357754019*^9, 3.625952363436268*^9}, {
   3.625952472334297*^9, 3.6259525152208757`*^9}, {3.625952586741355*^9, 
   3.625952692154002*^9}, {3.625952748284173*^9, 3.6259527664565287`*^9}, {
   3.6259528176364393`*^9, 3.6259528411172113`*^9}, {3.625952899651116*^9, 
   3.625952911706814*^9}, {3.6259530154476833`*^9, 3.625953015640126*^9}, {
   3.625958057211233*^9, 3.625958063954792*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "Destabilise", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", 
        RowBox[{"{", 
         RowBox[{"R1", "[", 
          RowBox[{"-", "1"}], "]"}], "}"}]}], "]"}], "]"}], "[", 
     RowBox[{"v", " ", ":", " ", 
      RowBox[{"BasisVector", "[", 
       RowBox[{
        RowBox[{"Resolution", "[", 
         RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
         "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "newBraid", ",", "\[IndentingNewLine]", "newResolution", ",", 
        "\[IndentingNewLine]", "oldGenerator", ",", "generatorPos", ",", 
        "\[IndentingNewLine]", "image", ",", "\[IndentingNewLine]", "prev", 
        ",", "\[IndentingNewLine]", "involvedCircle", ",", "newCircle", ",", 
        "\[IndentingNewLine]", 
        RowBox[{"extraSigns", "=", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", "}"}], ",", 
           RowBox[{"{", "}"}]}], "}"}]}], ",", 
        RowBox[{"sign", "=", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{"newSigns", "=", "Null"}], ",", "otherSigns"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Count", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ",", 
            RowBox[{
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
             "-", "1"}]}], "]"}], "\[NotEqual]", "1"}], ",", 
         RowBox[{
          RowBox[{"Print", "[", "\"\<Could not remove generator\>\"", "]"}], 
          ";", 
          RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
       
       RowBox[{"oldGenerator", "=", 
        RowBox[{
         RowBox[{
         "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-",
          "1"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"generatorPos", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             "]"}], ",", "oldGenerator"}], "]"}], "\[LeftDoubleBracket]", "1",
           "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
         "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newBraid", "=", 
        RowBox[{"BR", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
           "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "-", "1"}], ",", 
          RowBox[{"Delete", "[", 
           RowBox[{
            RowBox[{
            "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", "generatorPos"}], "]"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"newResolution", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"resolution", ",", "generatorPos"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "resolution", "\[LeftDoubleBracket]", "generatorPos", 
           "\[RightDoubleBracket]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<signs = \>\"", ",", "signs", ",", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"Length", "[", "resolution", "]"}]}], "+", 
              RowBox[{
              "braid", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{"4", "*", "generatorPos"}], "-", "2"}]}], "]"}], ";"}], 
          "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "extraSigns", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "=", " ", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], "/;", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"circle", ",", 
                  RowBox[{
                   RowBox[{"4", "*", 
                    RowBox[{"Length", "[", "resolution", "]"}]}], "+", 
                   RowBox[{
                   "braid", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], "\[NotEqual]", 
                "0"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "extraSigns", "\[LeftDoubleBracket]", "2", 
            "\[RightDoubleBracket]"}], "=", " ", 
           RowBox[{
            RowBox[{"Cases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], "/;", 
               RowBox[{
                RowBox[{"Count", "[", 
                 RowBox[{"circle", ",", 
                  RowBox[{
                   RowBox[{"4", "*", "generatorPos"}], "-", "2"}]}], "]"}], 
                "\[NotEqual]", "0"}]}]}], "]"}], "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"otherSigns", "=", 
           RowBox[{"DeleteCases", "[", 
            RowBox[{"signs", ",", 
             RowBox[{"sign_", "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{"extraSigns", ",", "sign"}], "]"}]}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"otherSigns", "=", 
           RowBox[{"ReplacePart", "[", 
            RowBox[{"otherSigns", ",", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                   RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                  RowBox[{"4", "*", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "generatorPos"}], "+", "1"}], ")"}]}], 
                    "]"}]}]}], ")"}]}], "&"}], "/@", 
              RowBox[{"Range", "[", 
               RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], "]"}]}],
           ";", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Sign", "[", 
              RowBox[{"braid", "\[LeftDoubleBracket]", 
               RowBox[{"2", ",", "generatorPos"}], "\[RightDoubleBracket]"}], 
              "]"}], "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "extraSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[Equal]", 
               RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"newSigns", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                   "1", "\[RightDoubleBracket]"}], "\[Rule]", 
                  RowBox[{
                   RowBox[{
                   "extraSigns", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}]}], "}"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "extraSigns", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "extraSigns", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newSigns", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "\[Rule]", "1"}], "}"}]}],
                  ",", "\[IndentingNewLine]", 
                 RowBox[{"newSigns", "=", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ",", 
               "\[IndentingNewLine]", 
               RowBox[{
                RowBox[{"sign", "=", 
                 RowBox[{"-", "1"}]}], ";", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "extraSigns", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
                  RowBox[{"newSigns", "=", 
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"circle_", "/;", 
                    RowBox[{"!", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"All", ",", "1"}], "\[RightDoubleBracket]"}], ",",
                     "circle"}], "]"}]}]}]}], "]"}], "\[LeftDoubleBracket]", 
                    "1", "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], "}"}]}]}], "\[IndentingNewLine]", 
                 "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
        "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"sign", "*", 
        RowBox[{"constructBasisVectorOrNot", "[", 
         RowBox[{"image", ",", "newSigns", ",", "otherSigns"}], "]"}]}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6259580810995703`*^9, 3.625958085209897*^9}, {
  3.6259680139260063`*^9, 3.6259680588397293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Only", " ", "show", " ", "the", " ", "non"}], "-", 
    RowBox[{
    "zero", " ", "matrices", " ", "in", " ", "a", " ", "GradedLinearMap"}]}], 
   " ", "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"removeZeroes", "[", "listm_", "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"Select", "[", 
       RowBox[{
        RowBox[{
        "listm", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
        
        RowBox[{
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", 
           RowBox[{"2", ",", "1"}], "\[RightDoubleBracket]"}], "\[NotEqual]", 
          "0"}], "&"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.625362494774827*^9, 3.625362589529448*^9}, {
  3.6253626275206537`*^9, 3.625362635815765*^9}, {3.625362706268257*^9, 
  3.625362722298448*^9}, {3.6253628473824787`*^9, 3.625362852901072*^9}, {
  3.625958164441554*^9, 3.6259581921416073`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Defining the Reidemeister 2 chain maps", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
  3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
  3.625124067226338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{"braid_", ",", 
      RowBox[{"{", "}"}]}], "]"}], "]"}], "[", "v_", "]"}], ":=", 
  "v"}]], "Input",
 CellChangeTimes->{{3.6250198939451857`*^9, 3.625019904751936*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{"braid_", ",", 
      RowBox[{"{", 
       RowBox[{"X_", ",", "Y__"}], "}"}]}], "]"}], "]"}], "[", "v_", "]"}], ":=", 
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{
      RowBox[{"Still", "[", 
       RowBox[{
        RowBox[{"BraidMovie", "[", 
         RowBox[{"braid", ",", 
          RowBox[{"{", "X", "}"}]}], "]"}], ",", 
        RowBox[{"-", "1"}]}], "]"}], ",", 
      RowBox[{"{", "Y", "}"}]}], "]"}], "]"}], "[", 
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid", ",", 
       RowBox[{"{", "X", "}"}]}], "]"}], "]"}], "[", "v", "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.625018692990404*^9, 3.6250187787828703`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"constructBasisVectorOrNot", "[", 
   RowBox[{"r_Resolution", ",", "Null", ",", "signs_"}], "]"}], ":=", 
  "0"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"constructBasisVectorOrNot", "[", 
   RowBox[{"r_Resolution", ",", "notNull_", ",", "signs_"}], "]"}], ":=", 
  RowBox[{"constructBasisVector", "[", 
   RowBox[{"r", ",", 
    RowBox[{"Join", "[", 
     RowBox[{"notNull", ",", "signs"}], "]"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.621043595350319*^9, 3.6210436176631393`*^9}, {
  3.6210436849431877`*^9, 3.621043685430293*^9}, {3.621045693918334*^9, 
  3.62104569441782*^9}, {3.621045970475613*^9, 3.621045996103354*^9}, {
  3.623458637702227*^9, 3.623458639333589*^9}, {3.623460641444234*^9, 
  3.6234606577942867`*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", "m_BraidMovie", "]"}], ":=", 
    RowBox[{"Sum", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"KhC", "[", 
         RowBox[{"m", ",", 
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{
          "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "]"}], "&"}], "/@", 
       RowBox[{"AllBigradings", "[", 
        RowBox[{"Still", "[", 
         RowBox[{"m", ",", "0"}], "]"}], "]"}]}], ")"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"m_BraidMovie", ",", "s_Integer", ",", " ", "r_Integer"}], "]"}],
     ":=", 
    RowBox[{"Sum", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"KhC", "[", "m", "]"}], "[", "#", "]"}], "&"}], "/@", 
       RowBox[{"AllBasisVectorsInGrading", "[", 
        RowBox[{
         RowBox[{"Still", "[", 
          RowBox[{"m", ",", "0"}], "]"}], ",", "s", ",", "r"}], "]"}]}], 
      ")"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.624331712054319*^9, 3.6243317193540916`*^9}, {
  3.624331753066552*^9, 3.624331876988049*^9}, {3.624331954635127*^9, 
  3.6243319618169518`*^9}, {3.624341245657346*^9, 3.624341249981544*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", "m_BraidMovie", "]"}], "[", "X_Plus", "]"}], ":=", 
  RowBox[{
   RowBox[{"KhC", "[", "m", "]"}], "/@", "X"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", "m_BraidMovie", "]"}], "[", 
   RowBox[{"\[Alpha]_", " ", "X_"}], "]"}], ":=", 
  RowBox[{"\[Alpha]", " ", 
   RowBox[{
    RowBox[{"KhC", "[", "m", "]"}], "[", "X", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6234598291801147`*^9, 3.623459859224266*^9}, 
   3.6374409256383142`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", "m_BraidMovie", "]"}], "[", "0", "]"}], ":=", 
  "0"}]], "Input",
 CellChangeTimes->{{3.623445865658203*^9, 3.623445873041237*^9}, {
  3.624257126013492*^9, 3.624257129346794*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", " ", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", " ", 
       RowBox[{"{", 
        RowBox[{"R2", "[", 
         RowBox[{"offset_", ",", " ", "1", ",", " ", "generator_"}], "]"}], 
        "}"}]}], "]"}], "]"}], "[", 
    RowBox[{"v", " ", ":", " ", 
     RowBox[{"BasisVector", "[", 
      RowBox[{
       RowBox[{"Resolution", "[", 
        RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
        "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prev", ",", " ", "prev2", ",", "\[IndentingNewLine]", 
       RowBox[{"circle1", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", " ", 
       RowBox[{"circle2", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ",", "circle3", ",", "\[IndentingNewLine]", 
       RowBox[{"newBraid", "=", "braid"}], ",", "\[IndentingNewLine]", 
       "images", ",", "\[IndentingNewLine]", "newBasisVector1", ",", " ", 
       "newBasisVector2", ",", "\[IndentingNewLine]", 
       RowBox[{"newResolutions", "=", 
        RowBox[{"{", 
         RowBox[{"resolution", ",", "resolution"}], "}"}]}], ",", 
       "\[IndentingNewLine]", "otherSigns", ",", "alteredSigns", ",", 
       "\[IndentingNewLine]", "affectedCircles", ",", " ", "newCircle", ",", 
       "\[IndentingNewLine]", 
       RowBox[{"sign1", "=", "1"}], ",", 
       RowBox[{"sign2", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
       "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", " ", 
         RowBox[{"-", "generator"}], ",", " ", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newBraid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
         ",", " ", "generator", ",", " ", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sign", "[", "generator", "]"}], "-", "1"}], ")"}]}], 
          "/", "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "1", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "1", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Sign", "[", "generator", "]"}], "-", "1"}], ")"}]}], 
          "/", "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sign", "[", "generator", "]"}], "+", "1"}], ")"}], "/", 
          "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{
       "newResolutions", "\[LeftDoubleBracket]", "2", 
        "\[RightDoubleBracket]"}], " ", "=", " ", 
       RowBox[{"Insert", "[", 
        RowBox[{
         RowBox[{
         "newResolutions", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}], ",", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Sign", "[", "generator", "]"}], "+", "1"}], ")"}], "/", 
          "2"}], ",", 
         RowBox[{"offset", "+", "1"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"prev", " ", "=", " ", 
       RowBox[{"Max", "[", 
        RowBox[{"Position", "[", 
         RowBox[{
          RowBox[{"Abs", "[", 
           RowBox[{"Take", "[", 
            RowBox[{
             RowBox[{
             "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
             ",", "offset"}], "]"}], "]"}], ",", 
          RowBox[{
           RowBox[{"Abs", "[", "generator", "]"}], "|", 
           RowBox[{
            RowBox[{"Abs", "[", "generator", "]"}], "-", "1"}], "|", 
           RowBox[{
            RowBox[{"Abs", "[", "generator", "]"}], "+", "1"}]}]}], "]"}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<prev = \>\"", ",", "prev"}], "]"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", "   ", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Work", " ", "out", " ", "which", " ", "circles", " ", "are", " ", 
        "involved"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"prev", " ", "==", " ", 
         RowBox[{"-", "\[Infinity]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
         "No", " ", "prior", " ", "generator", " ", "affecting", " ", 
          "either", " ", "strand"}], " ", "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Position", "[", 
            RowBox[{"circles", ",", " ", 
             RowBox[{
              RowBox[{"4", "*", 
               RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
              RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
           "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"circle1", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"circles", ",", " ", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
                 RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"circle2", " ", "=", " ", 
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{"circles", ",", " ", 
                RowBox[{
                 RowBox[{"4", "*", 
                  RowBox[{"Length", "[", "resolution", "]"}]}], " ", "+", " ", 
                 RowBox[{"Abs", "[", "generator", "]"}], " ", "+", " ", 
                 "1"}]}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"circle1", "=", 
            RowBox[{"Abs", "[", "generator", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"circle2", "=", 
            RowBox[{
             RowBox[{"Abs", "[", "generator", "]"}], "+", "1"}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Prior", " ", "generator"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Abs", "[", 
             RowBox[{
              RowBox[{
              "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}],
               "\[LeftDoubleBracket]", "prev", "\[RightDoubleBracket]"}], 
             "]"}], " ", "==", " ", 
            RowBox[{"Abs", "[", "generator", "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<circles = \>\"", ",", "circles"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "resolution", "\[LeftDoubleBracket]", "prev", 
               "\[RightDoubleBracket]"}], " ", "==", " ", "0"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"circle1", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"circles", ",", " ", 
                   RowBox[{"4", "*", "prev"}]}], "]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"circle2", " ", "=", " ", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"circles", ",", " ", 
                   RowBox[{
                    RowBox[{"4", "*", "prev"}], " ", "-", " ", "2"}]}], "]"}],
                  "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "[", 
                RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{"circle1", " ", "=", " ", 
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"circles", ",", " ", 
                  RowBox[{
                   RowBox[{"4", "*", "prev"}], " ", "-", " ", "1"}]}], "]"}], 
                "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", " ", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"Abs", "[", 
                RowBox[{
                 RowBox[{"braid", "[", 
                  RowBox[{"[", "2", "]"}], "]"}], "[", 
                 RowBox[{"[", "prev", "]"}], "]"}], "]"}], " ", "==", " ", 
               RowBox[{
                RowBox[{"Abs", "[", "generator", "]"}], " ", "-", " ", 
                "1"}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"prev2", " ", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"braid", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"offset", " ", "-", " ", "1"}]}], "]"}], "]"}], 
                   ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", "generator", "]"}], " ", "+", " ", 
                    "1"}], "|", 
                    RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"circle1", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"prev2", "\[Equal]", 
                  RowBox[{"-", "\[Infinity]"}]}], ",", 
                 RowBox[{"circle2", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{"Abs", "[", "generator", "]"}], "+", "1"}]}], 
                    "]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}]}], ",", "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    "prev2", "\[RightDoubleBracket]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Abs", "[", "generator", "]"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                   ",", "\[IndentingNewLine]", 
                   RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "2"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ","}], 
                "\[IndentingNewLine]", "]"}], ";"}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"circle1", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Position", "[", 
                   RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "-", "2"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev"}], "-", "1"}]}]}], "]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"prev2", "=", " ", 
                RowBox[{"Max", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"Abs", "[", 
                    RowBox[{"Take", "[", 
                    RowBox[{
                    RowBox[{"braid", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], ",", " ", 
                    RowBox[{"offset", " ", "-", " ", "1"}]}], "]"}], "]"}], 
                   ",", " ", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", "generator", "]"}], " ", "-", " ", 
                    "1"}], "|", 
                    RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
                 "]"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"prev2", "\[Equal]", 
                  RowBox[{"-", "\[Infinity]"}]}], ",", "\[IndentingNewLine]", 
                 
                 RowBox[{"circle2", "=", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{"4", "*", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "]"}]}], "+", 
                    RowBox[{"Abs", "[", "generator", "]"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                 ",", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Abs", "[", 
                    RowBox[{
                    RowBox[{
                    "braid", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", 
                    "prev2", "\[RightDoubleBracket]"}], "]"}], " ", "==", " ", 
                    RowBox[{"Abs", "[", "generator", "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}], "|", 
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "2"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{"circle2", "=", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"circles", ",", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "prev2"}], "-", "1"}], "|", 
                    RowBox[{"4", "*", "prev2"}]}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                    "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}]}], "]"}], ";"}]}], "]"}], 
               ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";"}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "circle1", " ", "and", " ", "circle2", " ", "now", " ", "give", " ", 
        "the", " ", "positions", " ", "of", " ", "affected", " ", "circles", 
        " ", "in", " ", "circles"}], " ", "*)"}], "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Identify", " ", "affected", " ", "circles", " ", "in", " ", "new", 
        " ", "resolutions"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"images", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Resolution", "[", 
          RowBox[{"newBraid", ",", "#"}], "]"}], "&"}], "/@", 
        "newResolutions"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"affectedCircles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", 
          RowBox[{
           RowBox[{
           "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "1"}], "|", 
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "2"}], "|", 
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "4"}], "|", 
               RowBox[{
                RowBox[{"4", "*", "offset"}], "+", "7"}]}]}], "]"}], "&"}]}], 
          "]"}], "&"}], "/@", "images"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"The", " ", "budded", " ", "circle"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"newCircle", "=", 
       RowBox[{
        RowBox[{"offset", "*", "4"}], "+", 
        RowBox[{"{", 
         RowBox[{"3", ",", "5"}], "}"}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<signs\>\"", ",", "affectedCircles", ",", "newCircle", ",", 
          "circles", ",", "\"\< \>\"", ",", "circle1", ",", "\"\< \>\"", ",", 
          "circle2", ",", "signs"}], "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"circle1", "\[Equal]", "circle2"}], "||", 
          RowBox[{"!", 
           RowBox[{"IntegerQ", "[", "circle2", "]"}]}]}], "]"}], ";"}], 
       "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"circle1", "\[Equal]", "circle2"}], "||", 
         RowBox[{"!", 
          RowBox[{"IntegerQ", "[", "circle2", "]"}]}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"alteredSigns", " ", "=", " ", 
          RowBox[{"R2Signs1", "[", 
           RowBox[{"affectedCircles", ",", "newCircle", ",", 
            RowBox[{
             RowBox[{"circles", "\[LeftDoubleBracket]", 
              RowBox[{"{", "circle1", "}"}], "\[RightDoubleBracket]"}], " ", "/.",
              " ", "signs"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"circle2", "=", "circle1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{
                "affectedCircles", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "2"}], "&&", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"8", "*", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{
                    "circles", "\[LeftDoubleBracket]", "circle1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"4", "*", "offset"}], "-", "1"}], "]"}]}], "+", 
                  RowBox[{
                  "circles", "\[LeftDoubleBracket]", "circle1", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "\[Equal]", 
               RowBox[{"{", "}"}]}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "[", 
                RowBox[{
                "affectedCircles", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "2"}], "&&", 
              RowBox[{
               RowBox[{"Intersection", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"8", "*", 
                   RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{
                    "circles", "\[LeftDoubleBracket]", "circle1", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"4", "*", "offset"}], "-", "1"}], "]"}]}], "+", 
                  RowBox[{
                  "circles", "\[LeftDoubleBracket]", "circle1", 
                   "\[RightDoubleBracket]"}]}], ",", 
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}]}], "]"}], "\[Equal]", 
               RowBox[{"{", "}"}]}]}], ")"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"circle3", "=", "circle1"}], ";", "\[IndentingNewLine]", 
            RowBox[{"circle1", "=", "circle2"}], ";", "\[IndentingNewLine]", 
            RowBox[{"circle2", "=", "circle3"}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"alteredSigns", "=", 
          RowBox[{"R2Signs2", "[", 
           RowBox[{"affectedCircles", ",", "newCircle", ",", 
            RowBox[{
             RowBox[{"circles", "\[LeftDoubleBracket]", 
              RowBox[{"{", 
               RowBox[{"circle1", ",", " ", "circle2"}], "}"}], 
              "\[RightDoubleBracket]"}], " ", "/.", " ", "signs"}]}], 
           "]"}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"otherSigns", "=", " ", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{"signs", ",", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], " ", "/;", 
          " ", 
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"circles", "\[LeftDoubleBracket]", 
             RowBox[{"{", 
              RowBox[{"circle1", ",", " ", "circle2"}], "}"}], 
             "\[RightDoubleBracket]"}], ",", " ", "circle"}], "]"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"otherSigns", "=", 
       RowBox[{"ReplacePart", "[", 
        RowBox[{"otherSigns", ",", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"8", "*", 
               RowBox[{"UnitStep", "[", 
                RowBox[{
                 RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                  RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], "]"}]}],
               "+", 
              RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
               RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], ")"}]}], 
           "&"}], "/@", 
          RowBox[{"Range", "[", 
           RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<alteredSigns = \>\"", ",", "alteredSigns"}], "]"}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<otherSigns = \>\"", ",", "otherSigns"}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Intersection[images\[LeftDoubleBracket]1\[RightDoubleBracket]\
\[LeftDoubleBracket]3\[RightDoubleBracket],4*offset+{3,5}] = \>\"", ",", 
          RowBox[{"Intersection", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
              "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], ",", 
            RowBox[{
             RowBox[{"4", "*", "offset"}], "+", 
             RowBox[{"{", 
              RowBox[{"3", ",", "5"}], "}"}]}]}], "]"}]}], "]"}], ";"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
         "\[Equal]", "1"}], ",", 
        RowBox[{"sign1", "=", 
         RowBox[{"Sign", "[", "generator", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "images", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "\[LeftDoubleBracket]", 
          RowBox[{"2", ",", 
           RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
         "\[Equal]", "1"}], ",", 
        RowBox[{"sign2", "=", 
         RowBox[{"Sign", "[", "generator", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"sign1", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}], "+", 
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}]}], ")"}]}],
        "+", 
       RowBox[{"sign2", "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "3", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}], "+", 
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{
            RowBox[{
            "images", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            ",", 
            RowBox[{
            "alteredSigns", "\[LeftDoubleBracket]", "4", 
             "\[RightDoubleBracket]"}], ",", "otherSigns"}], "]"}]}], 
         ")"}]}]}]}]}], "\n", "]"}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Should", " ", "return", " ", "a", " ", "3"}], "-", 
           RowBox[{
           "tuple", " ", "with", " ", "the", " ", "new", " ", "signs", " ", 
            "starting", " ", "with", " ", "the", " ", "resolution"}]}], " ", 
          "..."}], "01"}], "..."}], " ", "and", " ", "ending", " ", "with"}], 
      " ", "..."}], "10"}], "..."}], " ", "*)"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R2Signs1", "[", 
     RowBox[{"affectedCircles_", ",", "newCircle_", ",", "oldSigns_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newSigns", "=", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null", ",", "Null", ",", "Null"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "affectedCircles", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "1"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "affectedCircles", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "4", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "3", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "2", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
              "affectedCircles", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "oldSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "\[Equal]", "1"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              RowBox[{
              "newSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "=", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "affectedCircles", "\[LeftDoubleBracket]", "1", 
                   "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[Rule]", 
                 RowBox[{"-", "1"}]}], ",", 
                RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
           "\[IndentingNewLine]", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", "newSigns"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"R2Signs2", "[", 
     RowBox[{"affectedCircles_", ",", "newCircle_", ",", "oldSigns_"}], "]"}],
     ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"newSigns", "=", 
        RowBox[{"{", 
         RowBox[{"Null", ",", "Null", ",", "Null", ",", "Null"}], "}"}]}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<R2Signs2[\>\"", ",", "affectedCircles", ",", "\"\<,\>\"", ",", 
          "newCircle", ",", "\"\<,\>\"", ",", "oldSigns", ",", "\"\<]\>\""}], 
         "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Input: \>\"", ",", "affectedCircles", ",", "newCircle", ",", 
          "oldSigns"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{
           "affectedCircles", "\[LeftDoubleBracket]", "1", 
            "\[RightDoubleBracket]"}], "]"}], "\[Equal]", "2"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "&&", 
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newSigns", "\[LeftDoubleBracket]", "3", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "affectedCircles", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
               RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}], "||", 
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                "newSigns", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "affectedCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "&&", 
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "newSigns", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                 "affectedCircles", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
               RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}], "||", 
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "\[NotEqual]", 
                RowBox[{"-", "1"}]}]}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
                RowBox[{
                "newSigns", "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "affectedCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                   RowBox[{"-", "1"}]}], ",", 
                  RowBox[{"newCircle", "\[Rule]", "1"}]}], "}"}]}], ";"}]}], 
             "\[IndentingNewLine]", "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "newSigns", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
            "=", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{
              RowBox[{
               RowBox[{
               "affectedCircles", "\[LeftDoubleBracket]", "2", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}]}], "}"}]}], ";"}]}], 
        "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "newSigns"}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.618613269386087*^9, 3.6186133216952543`*^9}, {
   3.618625360276558*^9, 3.618625360845521*^9}, {3.618630401911015*^9, 
   3.618630527738447*^9}, {3.618630589488455*^9, 3.6186306247910852`*^9}, {
   3.618630658942924*^9, 3.618630677236027*^9}, {3.618630724156982*^9, 
   3.618630751481485*^9}, {3.618630867129529*^9, 3.618630939955831*^9}, {
   3.618630981627187*^9, 3.618631066405154*^9}, {3.618775133052783*^9, 
   3.618775184010097*^9}, {3.618775358526524*^9, 3.618775387533744*^9}, {
   3.618775423800769*^9, 3.618775506752783*^9}, {3.6187755518434753`*^9, 
   3.6187755572354813`*^9}, {3.618775593123229*^9, 3.618775724428648*^9}, {
   3.618775762092065*^9, 3.618775765013459*^9}, {3.618775824489884*^9, 
   3.618775848436596*^9}, {3.618775883049265*^9, 3.618775923169553*^9}, {
   3.6187759795562143`*^9, 3.618776023781505*^9}, {3.61877607434789*^9, 
   3.618776109911497*^9}, {3.6187761570655823`*^9, 3.6187762466597433`*^9}, {
   3.618776285521598*^9, 3.618776420153441*^9}, {3.618776479017851*^9, 
   3.618776728297097*^9}, {3.618776813927204*^9, 3.618776816737569*^9}, {
   3.618776849481269*^9, 3.618776916945096*^9}, {3.618776972072431*^9, 
   3.618776972827629*^9}, {3.618777048011116*^9, 3.618777083391178*^9}, {
   3.618777258454444*^9, 3.618777299083202*^9}, {3.618777343466207*^9, 
   3.618777431955916*^9}, {3.6187774854689703`*^9, 3.618777631962434*^9}, {
   3.6187777589016*^9, 3.618777773915814*^9}, {3.618778034457589*^9, 
   3.6187780361970243`*^9}, {3.618778246610037*^9, 3.618778312622789*^9}, {
   3.618782201340641*^9, 3.618782283279613*^9}, {3.618782374331119*^9, 
   3.6187824031870193`*^9}, 3.61889002019411*^9, {3.618890061369323*^9, 
   3.618890070012014*^9}, {3.61889010627096*^9, 3.618890107952408*^9}, {
   3.618890138772139*^9, 3.618890143329302*^9}, {3.6189799796675797`*^9, 
   3.6189801536358557`*^9}, {3.618980792409807*^9, 3.6189808306499357`*^9}, {
   3.619129207228156*^9, 3.619129260861465*^9}, {3.619129351996848*^9, 
   3.619129366737754*^9}, {3.619129810544421*^9, 3.6191299063764772`*^9}, {
   3.619130235341402*^9, 3.6191302679094954`*^9}, {3.61913040054907*^9, 
   3.619130405003941*^9}, {3.6191304555040827`*^9, 3.61913046357729*^9}, {
   3.619130495010079*^9, 3.6191304967377853`*^9}, {3.619130528134907*^9, 
   3.619130561684697*^9}, {3.6191307159603977`*^9, 3.619130754105343*^9}, {
   3.619130980350268*^9, 3.619130991249832*^9}, {3.6191312075960617`*^9, 
   3.619131309353236*^9}, {3.61913197807244*^9, 3.619131983967136*^9}, {
   3.6191320170722*^9, 3.6191320333333273`*^9}, {3.619132094996003*^9, 
   3.619132153464191*^9}, {3.6191327354998703`*^9, 3.6191327546804247`*^9}, {
   3.619213323242429*^9, 3.619213333929739*^9}, {3.6192364332965117`*^9, 
   3.6192364855251207`*^9}, {3.619236618804902*^9, 3.6192366244815474`*^9}, {
   3.619236665599369*^9, 3.619236717299555*^9}, {3.61923677043725*^9, 
   3.61923679521231*^9}, {3.619236858865959*^9, 3.619236859197515*^9}, {
   3.619291754710565*^9, 3.6192917742815733`*^9}, {3.6192918249953823`*^9, 
   3.619291875502956*^9}, {3.619291907973082*^9, 3.619291938215208*^9}, {
   3.6192920332927103`*^9, 3.619292086795281*^9}, {3.6193423383989973`*^9, 
   3.619342370934016*^9}, {3.619342411475833*^9, 3.619342419183957*^9}, {
   3.619342449898184*^9, 3.619342466759426*^9}, {3.619342535934268*^9, 
   3.619342605460952*^9}, 3.6193426431122837`*^9, {3.6193433876952667`*^9, 
   3.619343388148675*^9}, {3.619343425973405*^9, 3.619343447706068*^9}, {
   3.61934349212222*^9, 3.619343522598276*^9}, 3.61941574154244*^9, {
   3.619663826020279*^9, 3.619663877087172*^9}, {3.61966391900875*^9, 
   3.6196639192634373`*^9}, {3.6196639506135073`*^9, 3.619663984180794*^9}, {
   3.6196640490297623`*^9, 3.61966404924783*^9}, {3.619664141198514*^9, 
   3.619664149351777*^9}, {3.6196641931082172`*^9, 3.619664210626903*^9}, {
   3.619664705630397*^9, 3.6196648905803537`*^9}, {3.61966497108704*^9, 
   3.619664972922779*^9}, {3.619665073928665*^9, 3.619665086172433*^9}, {
   3.619665129067255*^9, 3.6196651388138313`*^9}, {3.619665193299307*^9, 
   3.6196652039419127`*^9}, {3.619665385975606*^9, 3.619665392308313*^9}, {
   3.6196654363032207`*^9, 3.619665465677706*^9}, {3.6196661278862133`*^9, 
   3.619666177860342*^9}, {3.6196666132127733`*^9, 3.619666831099594*^9}, {
   3.619667901830315*^9, 3.61966794378621*^9}, 3.61966801907541*^9, {
   3.619668228942646*^9, 3.619668244745298*^9}, {3.619668284887373*^9, 
   3.619668566188925*^9}, {3.619668597621997*^9, 3.619668656953309*^9}, 
   3.61973899055087*^9, {3.619756414051346*^9, 3.619756498788033*^9}, {
   3.619996526006805*^9, 3.6199965547338943`*^9}, {3.619996641025618*^9, 
   3.6199966979620132`*^9}, {3.6199967470937023`*^9, 3.619996831279668*^9}, {
   3.620002430268601*^9, 3.620002466922862*^9}, {3.6200024986740007`*^9, 
   3.6200025258385563`*^9}, {3.6200025851800013`*^9, 3.620002631453784*^9}, {
   3.62000271425242*^9, 3.6200028385979767`*^9}, {3.6201915123351717`*^9, 
   3.620191540041799*^9}, {3.6201916062971897`*^9, 3.6201916190417547`*^9}, {
   3.620193537991802*^9, 3.62019367810011*^9}, {3.6201937141912527`*^9, 
   3.620193842823036*^9}, {3.620424726849062*^9, 3.620424784438293*^9}, {
   3.62042606143714*^9, 3.620426074223156*^9}, {3.6204261323811626`*^9, 
   3.620426145161413*^9}, {3.6204262693567753`*^9, 3.620426328555399*^9}, {
   3.6204263735347843`*^9, 3.620426409340137*^9}, {3.6204264892003317`*^9, 
   3.620426507997229*^9}, {3.6204265656169863`*^9, 3.620426609384019*^9}, {
   3.62042679523976*^9, 3.6204269896618977`*^9}, {3.620429741410687*^9, 
   3.620429742201077*^9}, {3.6204300447401114`*^9, 3.620430336199546*^9}, 
   3.6204303751639557`*^9, {3.620430441567068*^9, 3.620430498314231*^9}, {
   3.6204305777784433`*^9, 3.620430623521902*^9}, {3.620430678369802*^9, 
   3.620430731096291*^9}, {3.620435771282312*^9, 3.620435788512542*^9}, {
   3.620435827328829*^9, 3.620435834958165*^9}, {3.620437640281847*^9, 
   3.620437777021989*^9}, {3.6204415329297457`*^9, 3.620441565750641*^9}, {
   3.620441804334867*^9, 3.620441813479247*^9}, {3.6205224554655848`*^9, 
   3.620522620583098*^9}, {3.620522652885333*^9, 3.62052270826502*^9}, {
   3.620545603274837*^9, 3.620545612162418*^9}, {3.620545753952363*^9, 
   3.620545788896819*^9}, {3.6205458207678843`*^9, 3.6205458274792137`*^9}, {
   3.620545861909985*^9, 3.62054589234161*^9}, {3.6205461201619368`*^9, 
   3.620546157407813*^9}, {3.620546251231719*^9, 3.620546321910421*^9}, {
   3.620546375559781*^9, 3.620546376354802*^9}, {3.620546411607122*^9, 
   3.620546415866043*^9}, {3.620546480700131*^9, 3.620546597536777*^9}, {
   3.620546638221669*^9, 3.620546666400889*^9}, 3.620546709548717*^9, {
   3.620598452644003*^9, 3.620598478178664*^9}, {3.620598531572398*^9, 
   3.6205985475727577`*^9}, {3.620598601345832*^9, 3.6205987022549267`*^9}, {
   3.6205988898953247`*^9, 3.6205989248702927`*^9}, {3.6205989618259068`*^9, 
   3.620598965524912*^9}, {3.620608008751645*^9, 3.6206080376613407`*^9}, {
   3.620608072658915*^9, 3.620608096201489*^9}, {3.620608178638009*^9, 
   3.62060818631957*^9}, {3.620608216458549*^9, 3.620608225224791*^9}, {
   3.620608256752969*^9, 3.6206082779150352`*^9}, {3.62060844509356*^9, 
   3.620608464276729*^9}, 3.620608502550894*^9, {3.6206093664250193`*^9, 
   3.620609366769483*^9}, {3.620616255835601*^9, 3.6206162601802807`*^9}, 
   3.621040904739484*^9, 3.621041214140966*^9, {3.621042046775444*^9, 
   3.62104204773925*^9}, {3.621042226825865*^9, 3.6210422927068233`*^9}, {
   3.621042345115281*^9, 3.621042348120577*^9}, {3.621042402330081*^9, 
   3.621042404806386*^9}, {3.6210424453442297`*^9, 3.621042519328421*^9}, {
   3.621042648473116*^9, 3.621042666867223*^9}, {3.621042763024856*^9, 
   3.621042793820731*^9}, {3.621042895195159*^9, 3.621042895500002*^9}, {
   3.621043537108481*^9, 3.621043537261815*^9}, {3.6210454323147717`*^9, 
   3.621045532805826*^9}, {3.621045702292498*^9, 3.621045750779278*^9}, {
   3.621045791903161*^9, 3.62104579573748*^9}, {3.621045833702125*^9, 
   3.621045934111206*^9}, {3.621046003726132*^9, 3.6210460328649178`*^9}, 
   3.621046106590102*^9, 3.621046342919359*^9, {3.621455038882093*^9, 
   3.621455040741181*^9}, 3.621455108737235*^9, {3.621455152287554*^9, 
   3.621455162434875*^9}, {3.621455234122388*^9, 3.62145526038245*^9}, 
   3.6214553698269777`*^9, {3.621455404665358*^9, 3.6214555017847633`*^9}, {
   3.621455542787671*^9, 3.621455557109638*^9}, {3.6214556212807407`*^9, 
   3.6214556227081213`*^9}, {3.621455661946211*^9, 3.6214556621094093`*^9}, {
   3.621455703268835*^9, 3.621455715116235*^9}, {3.6214558069729013`*^9, 
   3.6214558110741987`*^9}, {3.6234441967447844`*^9, 3.623444203825552*^9}, {
   3.6234457397397957`*^9, 3.623445761694257*^9}, 3.623446567716732*^9, {
   3.623446604210829*^9, 3.623446628516088*^9}, {3.6234466637538967`*^9, 
   3.623446681433465*^9}, {3.623446713955269*^9, 3.6234467520551558`*^9}, {
   3.623447889940892*^9, 3.6234479469816227`*^9}, {3.623448004449768*^9, 
   3.623448023989245*^9}, {3.623452655184437*^9, 3.623452656092662*^9}, {
   3.623454674742041*^9, 3.623454711545314*^9}, {3.6234547985145407`*^9, 
   3.623454820989519*^9}, {3.623454861581347*^9, 3.6234548798025208`*^9}, {
   3.6234549487395687`*^9, 3.6234549500353947`*^9}, {3.623455428250412*^9, 
   3.6234554393923807`*^9}, {3.623455469462274*^9, 3.623455495682942*^9}, {
   3.6234555566030617`*^9, 3.623455593053814*^9}, {3.62345577160909*^9, 
   3.623455807638001*^9}, 3.623455856355179*^9, {3.623456063907948*^9, 
   3.623456065351646*^9}, 3.623456147461492*^9, {3.6234561789794064`*^9, 
   3.623456184282552*^9}, {3.623456223292811*^9, 3.62345622511278*^9}, 
   3.623456270059449*^9, 3.623456304686879*^9, {3.623456348387089*^9, 
   3.623456418676002*^9}, {3.623456459376972*^9, 3.623456477292328*^9}, 
   3.6234565367630987`*^9, {3.624404075253099*^9, 3.624404164179603*^9}, {
   3.624404219112679*^9, 3.624404280255995*^9}, {3.624404340401784*^9, 
   3.624404343173916*^9}, {3.6244043797825613`*^9, 3.624404423456895*^9}, {
   3.624404474844062*^9, 3.624404489256428*^9}, {3.6244086317234707`*^9, 
   3.62440871477737*^9}, {3.6244087453554573`*^9, 3.624408750248608*^9}, {
   3.624408785001333*^9, 3.624408795948601*^9}, {3.62441111421392*^9, 
   3.624411137814186*^9}, {3.6244111795005074`*^9, 3.624411197637904*^9}, {
   3.624411286794807*^9, 3.624411311505014*^9}, {3.6244115285913363`*^9, 
   3.624411565145001*^9}, {3.624662519040344*^9, 3.62466253103239*^9}, {
   3.624662632724684*^9, 3.624662636988411*^9}, {3.624662757031611*^9, 
   3.6246627738849688`*^9}, {3.6246628081421137`*^9, 3.624662808480345*^9}, {
   3.6246628946370087`*^9, 3.624662907892334*^9}, {3.6246629408129663`*^9, 
   3.6246630284727697`*^9}, {3.624663060129676*^9, 3.6246631920113792`*^9}, {
   3.62486416956546*^9, 3.624864188121941*^9}, {3.6248644120023527`*^9, 
   3.6248644139664793`*^9}, {3.624864562899366*^9, 3.624864734489319*^9}, {
   3.6248647720732603`*^9, 3.6248648478611593`*^9}, {3.6248649958978233`*^9, 
   3.624865027411621*^9}, {3.624865117134424*^9, 3.624865173162856*^9}, {
   3.62486576704906*^9, 3.624865831184403*^9}, {3.62486795729457*^9, 
   3.6248679656720324`*^9}, 3.625015301711379*^9, {3.625015680465001*^9, 
   3.625015699306378*^9}, {3.625015739786172*^9, 3.625015842326153*^9}, {
   3.625015880177952*^9, 3.625015881580641*^9}, {3.625015917668*^9, 
   3.625015920693965*^9}, {3.625015971010071*^9, 3.625015992873905*^9}, {
   3.625016581948366*^9, 3.625016604119132*^9}, {3.625016638955708*^9, 
   3.6250166595026217`*^9}, {3.625016835351297*^9, 3.625016835507545*^9}, {
   3.625016869240006*^9, 3.625016869821097*^9}, {3.625017758380497*^9, 
   3.625017834237248*^9}, {3.625017866851321*^9, 3.6250178752128067`*^9}, {
   3.6250179155087843`*^9, 3.625017916501296*^9}, {3.625017948246237*^9, 
   3.625017952763897*^9}, {3.625018184986289*^9, 3.625018217650858*^9}, {
   3.625018279758397*^9, 3.625018282409051*^9}, {3.625018334826487*^9, 
   3.625018336523553*^9}, {3.625019433101728*^9, 3.625019440865203*^9}, {
   3.6250194726900043`*^9, 3.625019479402504*^9}, {3.625019556748291*^9, 
   3.6250195645250187`*^9}, {3.625019608051491*^9, 3.62501963758389*^9}, {
   3.6250196772432537`*^9, 3.6250196893211813`*^9}, {3.625125111303609*^9, 
   3.6251251846962347`*^9}, {3.6251252364845057`*^9, 3.625125261801689*^9}, {
   3.625125452792542*^9, 3.6251254782798653`*^9}, {3.625125591733835*^9, 
   3.625125592057494*^9}, {3.625269909303523*^9, 3.625269914677697*^9}, {
   3.625270066973968*^9, 3.625270070560359*^9}, {3.625270129339987*^9, 
   3.6252701312899513`*^9}, {3.625270161591014*^9, 3.6252701782789583`*^9}, {
   3.6252704483419743`*^9, 3.6252704729364443`*^9}, {3.625270538855547*^9, 
   3.625270561499385*^9}, {3.625270888870798*^9, 3.625270898805822*^9}, {
   3.625270950338904*^9, 3.625271022791389*^9}, {3.625271054685039*^9, 
   3.625271065230259*^9}, {3.625271204718561*^9, 3.625271237809741*^9}, {
   3.6252712794328403`*^9, 3.6252715226928377`*^9}, {3.625271594758276*^9, 
   3.625271604794142*^9}, {3.62527167792943*^9, 3.625271820418035*^9}, {
   3.6252718619338427`*^9, 3.625271862337514*^9}, 3.625272735781177*^9, {
   3.625272782582662*^9, 3.625272782993442*^9}, {3.625272852173975*^9, 
   3.6252730275566483`*^9}, {3.625273064522367*^9, 3.625273126379261*^9}, {
   3.625273165634781*^9, 3.625273171959704*^9}, {3.625273229181272*^9, 
   3.625273296635314*^9}, {3.6252734194266157`*^9, 3.625273527128632*^9}, {
   3.625273595769228*^9, 3.6252736274852962`*^9}, {3.6252744007842283`*^9, 
   3.6252744184347057`*^9}, 3.625274578703972*^9, {3.625274670436412*^9, 
   3.625274677038892*^9}, {3.625274765273642*^9, 3.625274840484355*^9}, {
   3.625274890749083*^9, 3.6252749353366547`*^9}, {3.625274991076643*^9, 
   3.625275011279212*^9}, {3.625275093227521*^9, 3.625275093900675*^9}, {
   3.625275127318462*^9, 3.625275232924762*^9}, {3.62527528872469*^9, 
   3.625275298653767*^9}, {3.625275376074692*^9, 3.625275435910338*^9}, {
   3.625275476736072*^9, 3.625275525624452*^9}, {3.625276011671525*^9, 
   3.625276043105186*^9}, {3.625276078245461*^9, 3.625276098329705*^9}, {
   3.625276140970982*^9, 3.625276151508007*^9}, {3.6252762018248367`*^9, 
   3.625276215929327*^9}, {3.625276354713355*^9, 3.625276420275938*^9}, {
   3.633640596192541*^9, 3.633640701150824*^9}, {3.633640756980731*^9, 
   3.633640772806924*^9}, 3.6339844296523848`*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.621041171147573*^9, 3.621041194417569*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", " ", 
       RowBox[{"{", 
        RowBox[{"R2", "[", 
         RowBox[{"offset_", ",", " ", 
          RowBox[{"-", "1"}], ",", " ", "generator_"}], "]"}], "}"}]}], "]"}],
      "]"}], "[", 
    RowBox[{"v", " ", ":", " ", 
     RowBox[{"BasisVector", "[", 
      RowBox[{
       RowBox[{"Resolution", "[", 
        RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
        "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"involvedCircles", "=", 
        RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", "invCircles", ",", 
       "\[IndentingNewLine]", "oldSigns", ",", "\[IndentingNewLine]", 
       "circle", ",", "\[IndentingNewLine]", "newCircles", ",", 
       "\[IndentingNewLine]", "otherSigns", ",", "\[IndentingNewLine]", 
       RowBox[{"newSigns1", "=", "Null"}], ",", 
       RowBox[{"newSigns2", "=", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{
          RowBox[{"Delete", "[", 
           RowBox[{"braid", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "1"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "2"}]}], "}"}]}], "}"}]}], "]"}], ",", 
          
          RowBox[{"Delete", "[", 
           RowBox[{"resolution", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"offset", "+", "1"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"offset", "+", "2"}], "}"}]}], "}"}]}], "]"}]}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"sign", "=", "1"}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"resolution", "\[LeftDoubleBracket]", 
         RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], "\[Equal]", 
        
        RowBox[{"resolution", "\[LeftDoubleBracket]", 
         RowBox[{"offset", "+", "2"}], "\[RightDoubleBracket]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Select", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"circles", ",", " ", 
                 RowBox[{
                  RowBox[{"4", "*", "offset"}], " ", "+", " ", "#"}]}], "]"}],
                "&"}], "/@", 
              RowBox[{"{", 
               RowBox[{"1", ",", "3", ",", "7"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"UnsameQ", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}], "\[NotEqual]", 
           RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"The", " ", "..."}], "11"}], "..."}], " ", 
            "resolution"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
           "Work", " ", "out", " ", "which", " ", "circles", " ", "are", " ", 
            "involved"}], " ", "*)"}], "\[IndentingNewLine]", " ", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"involvedCircles", ",", 
               RowBox[{
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], "&"}], "/@", 
            RowBox[{"Select", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Position", "[", 
                 RowBox[{"circles", ",", " ", 
                  RowBox[{
                   RowBox[{"4", "*", "offset"}], " ", "+", " ", "#"}]}], 
                 "]"}], "&"}], "/@", 
               RowBox[{"{", 
                RowBox[{"1", ",", "3", ",", "7"}], "}"}]}], ",", 
              RowBox[{
               RowBox[{"UnsameQ", "[", 
                RowBox[{"#", ",", 
                 RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"involvedCircles", "=", 
            RowBox[{"DeleteDuplicates", "[", "involvedCircles", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invCircles", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"circles", ",", "#"}], "]"}], "&"}], "/@", 
             "involvedCircles"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"oldSigns", "=", 
            RowBox[{"invCircles", "/.", "signs"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<Basis vector: \>\"", ",", "v"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"invCircles", ",", "oldSigns"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"resolution", "\[LeftDoubleBracket]", 
                 RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], 
                "\[Equal]", 
                RowBox[{"resolution", "\[LeftDoubleBracket]", 
                 RowBox[{"offset", "+", "2"}], "\[RightDoubleBracket]"}]}], 
               ",", 
               RowBox[{
                RowBox[{
                "oldSigns", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], "!=", "1"}]}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "oldSigns", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}], "\[Equal]", 
              RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "involvedCircles", "]"}], "\[Equal]", 
                 "3"}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "1"}], "||", 
                   RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[Equal]", "1"}]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"invCircles", "=", 
                    RowBox[{"Union", "[", 
                    RowBox[{
                    RowBox[{
                    "invCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "invCircles", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"invCircles", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"Select", "[", 
                    RowBox[{"invCircles", ",", 
                    RowBox[{
                    RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"4", "*", "offset"}]}], "&"}]}], "]"}], ",", 
                    RowBox[{"Select", "[", 
                    RowBox[{"invCircles", ",", 
                    RowBox[{
                    RowBox[{"#", ">", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "8"}]}], "&"}]}], 
                    "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                   RowBox[{"invCircles", "=", 
                    RowBox[{"invCircles", "-", 
                    RowBox[{"8", "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"invCircles", "-", 
                    RowBox[{"4", "*", 
                    RowBox[{"(", 
                    RowBox[{"offset", "+", "2"}], ")"}]}]}], "]"}]}]}]}], ";",
                    "\[IndentingNewLine]", 
                   RowBox[{"newSigns1", "=", 
                    RowBox[{"{", 
                    RowBox[{"invCircles", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "*", 
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], ";"}]}], 
                 "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
                "\[IndentingNewLine]", 
                RowBox[{"(*", " ", 
                 RowBox[{"One", " ", "circle", " ", "splits"}], " ", "*)"}], 
                "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"circle", "=", 
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{
                    RowBox[{
                    "invCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"value_", "/;", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "7"}], "}"}]}], ",", "value"}], 
                    "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"circle", "=", 
                  RowBox[{"circle", "-", 
                   RowBox[{"8", "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{"circle", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                    "]"}]}]}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", "circle", "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"newCircles", "=", 
                  RowBox[{"Select", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", " ", "#"}], "]"}], "&"}], 
                    "/@", "circle"}], ",", 
                    RowBox[{
                    RowBox[{"UnsameQ", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", "}"}]}], "]"}], "&"}]}], "]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"newCircles", "=", 
                  RowBox[{"DeleteDuplicates", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Extract", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
                    "newCircles"}], "]"}]}], ";", "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{
                   RowBox[{"Print", "[", 
                    RowBox[{"3", ",", "newCircles", ",", 
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}]}], "]"}], ";"}], "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    "oldSigns", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Equal]", 
                    RowBox[{"-", "1"}]}], ",", "\[IndentingNewLine]", 
                   RowBox[{"newSigns1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}]}], "}"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"newSigns1", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", "1"}], ",", 
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}]}], "}"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"newSigns2", "=", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], "\[Rule]", 
                    RowBox[{"-", "1"}]}], ",", 
                    RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], "\[Rule]", "1"}]}], 
                    "}"}]}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
               "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
            "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", " ", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], " ", "/;",
                " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "circles", "\[LeftDoubleBracket]", "involvedCircles", 
                  "\[RightDoubleBracket]"}], ",", " ", "circle"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"otherSigns", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "8"}], "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                    "]"}]}], "+", 
                   RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], 
             "]"}]}]}], 
          RowBox[{"(*", 
           RowBox[{";", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"constructBasisVectorOrNot", "[", 
              RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}], 
             "+", 
             RowBox[{"constructBasisVectorOrNot", "[", 
              RowBox[{"image", ",", "newSigns2", ",", "otherSigns"}], 
              "]"}]}]}], "*)"}], ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"Circles", " ", "remain", " ", "the", " ", "same"}], ",", 
            " ", 
            RowBox[{"crossings", " ", "removed"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"The", " ", "..."}], "00"}], "..."}], " ", 
            "resolution"}], " ", "*)"}], "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"involvedCircles", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Position", "[", 
                  RowBox[{"circles", ",", " ", 
                   RowBox[{
                    RowBox[{"4", "*", "offset"}], " ", "+", " ", "#"}]}], 
                  "]"}], "\[LeftDoubleBracket]", "1", 
                 "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}]}], "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"2", ",", "4"}], "}"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"involvedCircles", "=", 
            RowBox[{"DeleteDuplicates", "[", "involvedCircles", "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{"newCircles", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{"circles", ","}]}]}], "*)"}], 
           RowBox[{"invCircles", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Extract", "[", 
               RowBox[{"circles", ",", "#"}], "]"}], "&"}], "/@", 
             "involvedCircles"}]}], 
           RowBox[{"(*", "]", "*)"}], ";", "\[IndentingNewLine]", 
           RowBox[{"oldSigns", "=", 
            RowBox[{"invCircles", "/.", "signs"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"invCircles", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"Join", "[", 
               RowBox[{
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"#", "\[LessEqual]", 
                    RowBox[{"4", "*", "offset"}]}], "&"}]}], "]"}], ",", 
                RowBox[{"Select", "[", 
                 RowBox[{"#", ",", 
                  RowBox[{
                   RowBox[{"#", ">", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "8"}]}], "&"}]}], 
                 "]"}]}], "]"}], "&"}], "/@", "invCircles"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"newCircles", "=", 
              RowBox[{"Join", "[", 
               RowBox[{"newCircles", ",", "invCircles"}], "]"}]}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"newCircles", "=", 
              RowBox[{"newCircles", "-", 
               RowBox[{"8", "*", 
                RowBox[{"UnitStep", "[", 
                 RowBox[{"newCircles", "-", 
                  RowBox[{"8", "*", "offset"}]}], "]"}]}]}]}], ";"}], "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"invCircles", "=", 
            RowBox[{"invCircles", "-", 
             RowBox[{"8", "*", 
              RowBox[{"UnitStep", "[", 
               RowBox[{"invCircles", "-", 
                RowBox[{"4", "*", 
                 RowBox[{"(", 
                  RowBox[{"offset", "+", "2"}], ")"}]}]}], "]"}]}]}]}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"newSigns1", "=", 
            RowBox[{"MapThread", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
              RowBox[{"{", 
               RowBox[{"invCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";",
            "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", " ", 
            RowBox[{"DeleteCases", "[", 
             RowBox[{"signs", ",", " ", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"circle_", " ", "->", " ", "value_"}], ")"}], " ", "/;",
                " ", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                 "circles", "\[LeftDoubleBracket]", "involvedCircles", 
                  "\[RightDoubleBracket]"}], ",", " ", "circle"}], "]"}]}]}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"otherSigns", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"otherSigns", ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"#", ",", "1"}], "}"}], "\[Rule]", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "8"}], "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "1"}], ")"}]}], 
                    "]"}]}], "+", 
                   RowBox[{"otherSigns", "\[LeftDoubleBracket]", 
                    RowBox[{"#", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                  ")"}]}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "otherSigns", "]"}], "]"}]}]}], 
             "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"resolution", "\[LeftDoubleBracket]", 
              RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "1"}], ",", 
            RowBox[{"sign", "=", 
             RowBox[{
              RowBox[{"-", "1"}], "*", "sign"}]}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"v", ",", "\"\< is sent to \>\"", ",", 
            RowBox[{"sign", "*", 
             RowBox[{"constructBasisVectorOrNot", "[", 
              RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], 
              "]"}]}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"resolution", "\[LeftDoubleBracket]", 
            RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}], 
           "\[Equal]", "1"}], ",", 
          RowBox[{"sign", "=", 
           RowBox[{"-", 
            RowBox[{"Sign", "[", "generator", "]"}]}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sign", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns1", ",", "otherSigns"}], "]"}], 
           "+", " ", 
           RowBox[{"constructBasisVectorOrNot", "[", 
            RowBox[{"image", ",", "newSigns2", ",", "otherSigns"}], "]"}]}], 
          ")"}]}]}], ",", "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]",
       "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.618613341424855*^9, 3.618613349198995*^9}, {
   3.6186134182559547`*^9, 3.618613420677825*^9}, {3.618613461390503*^9, 
   3.618613592528639*^9}, {3.618613657979141*^9, 3.618613658870349*^9}, {
   3.618613752065693*^9, 3.618613804151257*^9}, {3.618613859456768*^9, 
   3.6186139517180643`*^9}, {3.618614241799459*^9, 3.618614261611309*^9}, {
   3.618616251380883*^9, 3.618616311216395*^9}, {3.618616341275741*^9, 
   3.618616377882416*^9}, {3.618616414765052*^9, 3.618616501688735*^9}, {
   3.618616545664077*^9, 3.618616631825614*^9}, {3.6186166647733517`*^9, 
   3.6186168328056726`*^9}, {3.618616882306608*^9, 3.618616919316712*^9}, {
   3.61861820659482*^9, 3.6186183036721287`*^9}, {3.618618367503747*^9, 
   3.618618407202963*^9}, {3.618618495828561*^9, 3.618618522633103*^9}, {
   3.6186185567673693`*^9, 3.6186187302221317`*^9}, {3.618618766768297*^9, 
   3.6186188092448378`*^9}, {3.6186253564891376`*^9, 3.618625357414706*^9}, {
   3.618782574981461*^9, 3.6187825764528437`*^9}, {3.618980211433425*^9, 
   3.618980235077745*^9}, {3.619148814518977*^9, 3.6191488245700827`*^9}, {
   3.61914887017402*^9, 3.61914899319121*^9}, {3.619149236024198*^9, 
   3.619149349142765*^9}, {3.6191495282068863`*^9, 3.619149528370914*^9}, {
   3.619166983334838*^9, 3.619167184775565*^9}, {3.619167436496315*^9, 
   3.619167448618741*^9}, {3.619167497489479*^9, 3.619167539680531*^9}, {
   3.619167575974737*^9, 3.619167577730814*^9}, {3.619167615087943*^9, 
   3.619167627431431*^9}, {3.6191677616824007`*^9, 3.619167824403235*^9}, {
   3.6191678850481052`*^9, 3.619167967685361*^9}, {3.6191680326515636`*^9, 
   3.619168057384907*^9}, {3.619168119210404*^9, 3.6191681201287527`*^9}, {
   3.619168190560864*^9, 3.619168268581787*^9}, {3.619168338452586*^9, 
   3.619168384153097*^9}, {3.619168425567297*^9, 3.619168435745082*^9}, {
   3.619168478934826*^9, 3.619168599577063*^9}, {3.619168659567816*^9, 
   3.619168725057994*^9}, {3.619169026148322*^9, 3.619169085348091*^9}, {
   3.619169279816074*^9, 3.619169322449552*^9}, {3.619169364292123*^9, 
   3.6191695040983973`*^9}, {3.619169541480383*^9, 3.619169630261318*^9}, {
   3.619169707935396*^9, 3.6191697754653788`*^9}, {3.619169909236965*^9, 
   3.619169936556849*^9}, {3.619169999963838*^9, 3.619170084101035*^9}, {
   3.623456754734995*^9, 3.623456756958961*^9}, {3.6234568227938347`*^9, 
   3.623456847241559*^9}, {3.623457076912862*^9, 3.623457092744954*^9}, {
   3.6234571272001553`*^9, 3.6234571327251596`*^9}, {3.623457210255533*^9, 
   3.623457316720546*^9}, 3.623457351877684*^9, {3.623457435132166*^9, 
   3.62345745669189*^9}, {3.6234574869380703`*^9, 3.6234575353328047`*^9}, {
   3.623457586853407*^9, 3.623457595407*^9}, {3.623457642453382*^9, 
   3.623457644347348*^9}, {3.623457900558168*^9, 3.623457954034664*^9}, {
   3.6234581658931103`*^9, 3.6234581852487392`*^9}, {3.6234583499047956`*^9, 
   3.623458351799409*^9}, {3.623458384719101*^9, 3.623458389211522*^9}, {
   3.623458440014035*^9, 3.623458440325137*^9}, {3.623458488814878*^9, 
   3.623458496458214*^9}, {3.62345856198715*^9, 3.623458563047371*^9}, {
   3.623458724756666*^9, 3.623458725778736*^9}, {3.623471441645203*^9, 
   3.6234714896090717`*^9}, {3.623471752875012*^9, 3.623471801448185*^9}, {
   3.623471846596273*^9, 3.623471902110608*^9}, {3.623472007409747*^9, 
   3.623472016586835*^9}, {3.623472683151264*^9, 3.623472723995049*^9}, {
   3.6235336409416113`*^9, 3.623533642804912*^9}, {3.623550723628173*^9, 
   3.623550740365287*^9}, {3.623550840797308*^9, 3.62355088127658*^9}, {
   3.623550980159774*^9, 3.623550986484735*^9}, {3.623551058588923*^9, 
   3.623551079404435*^9}, {3.6235511506825037`*^9, 3.623551182867784*^9}, {
   3.6235512580019217`*^9, 3.623551385804585*^9}, {3.6235514522096024`*^9, 
   3.623551558950242*^9}, {3.62355166968968*^9, 3.6235516732860126`*^9}, {
   3.6235517255572567`*^9, 3.623551792650837*^9}, {3.623551829567793*^9, 
   3.62355186539977*^9}, {3.6235518996390038`*^9, 3.623551916036993*^9}, 
   3.623553721531468*^9, {3.6235644089363947`*^9, 3.623564414399954*^9}, {
   3.623607085619008*^9, 3.6236071090369663`*^9}, {3.6236072404293413`*^9, 
   3.623607257601344*^9}, {3.623607356504767*^9, 3.623607371121469*^9}, {
   3.623607477115768*^9, 3.623607530462883*^9}, {3.6236075666355352`*^9, 
   3.623607567322551*^9}, {3.623607603333602*^9, 3.623607625950906*^9}, {
   3.6236076822661552`*^9, 3.6236077224949408`*^9}, {3.623607777771896*^9, 
   3.623607825761973*^9}, {3.6236078693108187`*^9, 3.6236079011471977`*^9}, {
   3.6236079375780888`*^9, 3.623607955617169*^9}, {3.623608007694544*^9, 
   3.6236080993436537`*^9}, {3.6236081423154488`*^9, 3.623608215381971*^9}, {
   3.623608435288311*^9, 3.6236084447969522`*^9}, {3.623608478964595*^9, 
   3.623608534539065*^9}, {3.623608569027996*^9, 3.623608720261422*^9}, 
   3.623608756586554*^9, {3.623608799787148*^9, 3.623608800007258*^9}, {
   3.623608844641094*^9, 3.623608847450388*^9}, {3.623608892025008*^9, 
   3.623608893628806*^9}, {3.6236089401975307`*^9, 3.623608940661519*^9}, {
   3.623621701925336*^9, 3.623621704267973*^9}, {3.623622080994454*^9, 
   3.623622101903679*^9}, {3.623622134261014*^9, 3.623622136423967*^9}, {
   3.623622167461484*^9, 3.623622183381612*^9}, {3.623622217792981*^9, 
   3.623622300408608*^9}, {3.623622335063023*^9, 3.623622335986998*^9}, {
   3.623622393525057*^9, 3.623622399089076*^9}, {3.6236224801280518`*^9, 
   3.623622585425907*^9}, {3.6236226694110527`*^9, 3.623622698143858*^9}, {
   3.623622876208733*^9, 3.623622887113344*^9}, {3.623622921677573*^9, 
   3.6236230033649197`*^9}, {3.62362307553794*^9, 3.623623102260499*^9}, {
   3.623624405706609*^9, 3.623624416417983*^9}, {3.623624450214628*^9, 
   3.6236244870079327`*^9}, {3.6236245451326227`*^9, 3.623624729897439*^9}, {
   3.623624798465508*^9, 3.623624835439159*^9}, {3.623624871942111*^9, 
   3.623624904446806*^9}, {3.6236249997870073`*^9, 3.623625001797846*^9}, {
   3.623625032834642*^9, 3.6236250344571877`*^9}, {3.623804650191689*^9, 
   3.623804665583414*^9}, {3.623804743701007*^9, 3.623804764211759*^9}, {
   3.623954075135729*^9, 3.6239541114633293`*^9}, {3.624220894003269*^9, 
   3.6242209256213512`*^9}, {3.624221019988164*^9, 3.624221023504184*^9}, {
   3.6242211274237337`*^9, 3.624221133957568*^9}, 3.624255026933858*^9, {
   3.624255249593219*^9, 3.624255251671049*^9}, {3.624255565436812*^9, 
   3.6242555666646633`*^9}, {3.624255779708455*^9, 3.62425579931443*^9}, {
   3.624256012419668*^9, 3.624256041702674*^9}, {3.624256654414853*^9, 
   3.624256655823966*^9}, {3.624256805418457*^9, 3.624256828513062*^9}, {
   3.624256907009871*^9, 3.6242569229610662`*^9}, {3.624257557216075*^9, 
   3.6242576156711073`*^9}, 3.624257699727467*^9, {3.6242592405495567`*^9, 
   3.6242592568877296`*^9}, {3.6242593027252274`*^9, 3.624259336290431*^9}, {
   3.624259510400186*^9, 3.624259528635029*^9}, {3.6242595701079884`*^9, 
   3.6242595753901243`*^9}, {3.6242596477451143`*^9, 3.624259719239183*^9}, {
   3.624259761386973*^9, 3.6242597638170023`*^9}, {3.6242598011943893`*^9, 
   3.62425988144482*^9}, {3.6242599405852337`*^9, 3.624259968899873*^9}, 
   3.624864205370945*^9, {3.624864315069975*^9, 3.624864338325186*^9}, {
   3.624864894521162*^9, 3.624864918008472*^9}, {3.6248679982476482`*^9, 
   3.624867998519527*^9}, {3.625015461990429*^9, 3.625015463998341*^9}, {
   3.625017983772854*^9, 3.625018004985976*^9}, {3.625018073080764*^9, 
   3.625018109430297*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Defining the Reidemeister 3 chain maps", "Section",
 CellChangeTimes->{{3.6183028406657047`*^9, 3.618302888343869*^9}, {
   3.6186132386559143`*^9, 3.618613239172666*^9}, {3.6251240595476933`*^9, 
   3.625124067226338*^9}, 3.6278501505777283`*^9}],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{
   "direction", " ", "is", " ", "either", " ", "\"\<L\>\"", " ", "or", " ", 
    RowBox[{"\"\<R\>\"", " ", "--"}]}], "-", " ", 
   RowBox[{
   "it", " ", "specifies", " ", "whether", " ", "the", " ", "middle", " ", 
    "crossing", " ", "in", " ", "the", " ", "initial", " ", "R3", " ", 
    "tangle", " ", "is", " ", "on", " ", "the", " ", "\"\<L\>\"", "eft", " ", 
    "or", " ", "\"\<R\>\"", 
    RowBox[{"ight", "."}]}]}], " ", "*)"}]], "Input",
 CellChangeTimes->{{3.6336321171926394`*^9, 3.633632143601677*^9}, {
  3.633632187390725*^9, 3.633632213224701*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"KhC", "[", 
   RowBox[{"m", ":", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{"braid_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"R3", "[", 
        RowBox[{
        "offset_", ",", "generator_", ",", "direction_", ",", "signs_"}], 
        "]"}], "}"}]}], "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\[Alpha]", ",", "conditions", ",", " ", "solutions"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"conditions", "=", 
      RowBox[{"LeeMovieChainMapCondition", "[", 
       RowBox[{"BraidMovie", "[", 
        RowBox[{"braid", ",", 
         RowBox[{"{", 
          RowBox[{"BrokenR3", "[", 
           RowBox[{
           "offset", ",", "generator", ",", "direction", ",", "signs", ",", 
            "\[Alpha]"}], "]"}], "}"}]}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"solutions", "=", 
      RowBox[{"Solve", "[", 
       RowBox[{"conditions", "\[Equal]", "0"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "[", "solutions", "]"}], "\[NotEqual]", "1"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
        "Print", "[", 
         "\"\<Failed to solve the movie conditions for the partially prepared \
R3 move!\>\"", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", "m", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<conditions: \>\"", ",", "conditions"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Print", "[", 
         RowBox[{"\"\<solutions: \>\"", ",", "solutions"}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Abort", "[", "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "solutions", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "/.", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x_", "\[Rule]", "y_"}], ")"}], "\[RuleDelayed]", 
       RowBox[{"(", 
        RowBox[{"x", "=", "y"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid", ",", 
        RowBox[{"{", 
         RowBox[{"BrokenR3", "[", 
          RowBox[{
          "offset", ",", "generator", ",", "direction", ",", "signs", ",", 
           "\[Alpha]"}], "]"}], "}"}]}], "]"}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.626039210084462*^9, 3.62603921998847*^9}, {
  3.6260392726263027`*^9, 3.626039475510211*^9}, {3.626568847379889*^9, 
  3.6265688587305717`*^9}, {3.626569610277741*^9, 3.62656961843799*^9}, {
  3.626569670344122*^9, 3.626569688327859*^9}, {3.626744364649849*^9, 
  3.62674437488909*^9}, {3.628814484151092*^9, 3.62881452041259*^9}, {
  3.633632518615*^9, 3.633632544673357*^9}, {3.645391391154814*^9, 
  3.645391391675393*^9}, {3.645391525889821*^9, 3.64539152643335*^9}, {
  3.6453918429853354`*^9, 3.6453918434567223`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", "offset_Integer", "]"}], ",", "y___"}], "}"}]}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"stretch", ",", "k", ",", "direction", ",", 
      RowBox[{"braid", "=", 
       RowBox[{"Still", "[", 
        RowBox[{
         RowBox[{"BraidMovie", "[", 
          RowBox[{"obraid", ",", 
           RowBox[{"{", "x", "}"}]}], "]"}], ",", 
         RowBox[{"Length", "[", 
          RowBox[{"{", "x", "}"}], "]"}]}], "]"}]}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
         "braid", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "<",
          "3"}], "\[Or]", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{
          "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "]"}], "<", "3"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Invalid braid movie: BraidMovie[\>\"", ",", "braid", ",", 
          "\"\<,R3[\>\"", ",", "offset", ",", "\"\<]]\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"stretch", "=", 
      RowBox[{"Take", "[", 
       RowBox[{
        RowBox[{
        "braid", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
        
        RowBox[{"{", 
         RowBox[{
          RowBox[{"offset", "+", "1"}], ",", 
          RowBox[{"offset", "+", "3"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{
         RowBox[{"Sign", "/@", "stretch"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"+", "1"}], ",", 
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}]}], "}"}], "|", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"+", "1"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}]}], "]"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<You can't apply an R3 move there: BraidMovie[\>\"", ",", 
          "braid", ",", "\"\<,R3[\>\"", ",", "offset", ",", "\"\<]]\>\""}], 
         "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"k", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"Abs", "/@", "stretch"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"MatchQ", "[", 
         RowBox[{
          RowBox[{"Abs", "/@", "stretch"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"k", ",", 
             RowBox[{"k", "+", "1"}], ",", "k"}], "}"}], "|", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"k", "+", "1"}], ",", "k", ",", 
             RowBox[{"k", "+", "1"}]}], "}"}]}]}], "]"}]}], ",", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{
         "\"\<Invalid braid movie: BraidMovie[\>\"", ",", "braid", ",", 
          "\"\<,R3[\>\"", ",", "offset", ",", "\"\<]]\>\""}], "]"}], ";", 
        RowBox[{"Abort", "[", "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"direction", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Abs", "[", 
          RowBox[{
          "stretch", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "]"}], "\[Equal]", "k"}], ",", "\"\<R\>\"", ",", "\"\<L\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", 
         RowBox[{"R3", "[", 
          RowBox[{"offset", ",", "k", ",", "direction", ",", 
           RowBox[{"Sign", "/@", "stretch"}]}], "]"}], ",", "y"}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.626048797158462*^9, 3.626048815270771*^9}, {
  3.6260488853662567`*^9, 3.626049031012588*^9}, {3.626049110381961*^9, 
  3.6260491197840023`*^9}, {3.626049168082643*^9, 3.626049171287875*^9}, {
  3.6260494305978727`*^9, 3.626049571720269*^9}, {3.6260516415393963`*^9, 
  3.626051658841308*^9}, {3.626052313257107*^9, 3.626052348163603*^9}, {
  3.626052557480178*^9, 3.626052558243475*^9}, {3.626052628478402*^9, 
  3.626052668457718*^9}, {3.626052745241588*^9, 3.626052781834906*^9}, {
  3.636743307066523*^9, 3.636743344423155*^9}, {3.63674441727542*^9, 
  3.636744425936702*^9}, {3.63674452553826*^9, 3.636744566772031*^9}, {
  3.636744604549695*^9, 3.636744619945889*^9}, {3.6367447556433163`*^9, 
  3.63674484475994*^9}, {3.636744895412334*^9, 3.636744957420178*^9}, {
  3.6453896996935673`*^9, 3.645389700288563*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}], ",", "y___"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", "1", ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", "generator", ",", "\"\<L\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", 
        RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", "y"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<L\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], "]"}], ",", "y___"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", "1", ",", "generator"}], "]"}], ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", "generator", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", "y"}], 
     "}"}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "y___"}], "}"}]}], "]"}],
   ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", "1", ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", "generator", ",", "\"\<L\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", 
        RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", "y"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BraidMovie", "[", 
    RowBox[{"obraid_BR", ",", 
     RowBox[{"{", 
      RowBox[{"x___", ",", 
       RowBox[{"R3", "[", 
        RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<L\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "y___"}], 
      "}"}]}], "]"}], ":=", 
   RowBox[{"BraidMovie", "[", 
    RowBox[{"obraid", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "3"}], ",", "1", ",", "generator"}], "]"}], 
       ",", 
       RowBox[{"R3", "[", 
        RowBox[{
         RowBox[{"offset", "+", "1"}], ",", "generator", ",", "\"\<R\>\"", 
         ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"R2", "[", 
        RowBox[{"offset", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", "y"}], 
      "}"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "y___"}], "}"}]}], "]"}],
   ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", "1", ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", "1", ",", "generator"}], "]"}], 
      ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "2"}], ",", "generator", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "4"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", 
        RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", "y"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BraidMovie", "[", 
    RowBox[{"obraid_BR", ",", 
     RowBox[{"{", 
      RowBox[{"x___", ",", 
       RowBox[{"R3", "[", 
        RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<L\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
       "y___"}], "}"}]}], "]"}], ":=", 
   RowBox[{"BraidMovie", "[", 
    RowBox[{"obraid", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "3"}], ",", "1", ",", "generator"}], "]"}], 
       ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "4"}], ",", "1", ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"R3", "[", 
        RowBox[{
         RowBox[{"offset", "+", "2"}], ",", "generator", ",", "\"\<L\>\"", 
         ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "1"}], ",", 
         RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", 
       RowBox[{"R2", "[", 
        RowBox[{"offset", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", "y"}], 
      "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "y___"}], "}"}]}], "]"}],
   ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", "1", ",", 
        RowBox[{"(", 
         RowBox[{"generator", "+", "1"}], ")"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "4"}], ",", "1", ",", "generator"}], "]"}], 
      ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "2"}], ",", "generator", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "generator"}]}], "]"}], ",", "y"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"BraidMovie", "[", 
    RowBox[{"obraid_BR", ",", 
     RowBox[{"{", 
      RowBox[{"x___", ",", 
       RowBox[{"R3", "[", 
        RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<L\>\"", ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "y___"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"BraidMovie", "[", 
    RowBox[{"obraid", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"R2", "[", 
        RowBox[{"offset", ",", "1", ",", 
         RowBox[{"-", "generator"}]}], "]"}], ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "1"}], ",", "1", ",", 
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
       RowBox[{"R3", "[", 
        RowBox[{
         RowBox[{"offset", "+", "2"}], ",", "generator", ",", "\"\<L\>\"", 
         ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "4"}], ",", 
         RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", 
       RowBox[{"R2", "[", 
        RowBox[{
         RowBox[{"offset", "+", "3"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}], "]"}], ",", "y"}], 
      "}"}]}], "]"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", "y___"}], 
     "}"}]}], "]"}], ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", "1", ",", 
        RowBox[{"(", 
         RowBox[{"generator", "+", "1"}], ")"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "4"}], ",", "1", ",", "generator"}], "]"}], 
      ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "5"}], ",", "1", ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", "generator", ",", "\"\<L\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "2"}], ",", 
        RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "generator"}]}], "]"}], ",", "y"}], "}"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid_BR", ",", 
    RowBox[{"{", 
     RowBox[{"x___", ",", 
      RowBox[{"R3", "[", 
       RowBox[{"offset_Integer", ",", "generator_", ",", "\"\<L\>\"", ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "y___"}], "}"}]}], "]"}],
   ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"obraid", ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", "1", ",", 
        RowBox[{"-", "generator"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", "1", ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "2"}], ",", "1", ",", "generator"}], "]"}], 
      ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", "generator", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "5"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"generator", "+", "1"}], ")"}]}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "4"}], ",", 
        RowBox[{"-", "1"}], ",", "generator"}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"(", 
         RowBox[{"generator", "+", "1"}], ")"}]}], "]"}], ",", "y"}], "}"}]}],
    "]"}]}]}], "Input",
 CellChangeTimes->{{3.640680350842338*^9, 3.6406807124004908`*^9}, {
   3.640724500598159*^9, 3.640724552811705*^9}, {3.640724600867697*^9, 
   3.640724601040711*^9}, {3.640724758515329*^9, 3.640724822023354*^9}, {
   3.6407264455550337`*^9, 3.6407264471607733`*^9}, {3.640726494361807*^9, 
   3.640726500666959*^9}, {3.6407265329136543`*^9, 3.64072656700004*^9}, {
   3.6407265995076523`*^9, 3.640726604974972*^9}, {3.640726639268097*^9, 
   3.640726746882882*^9}, {3.6407269483845463`*^9, 3.640727071516046*^9}, {
   3.640727113766759*^9, 3.640727145854968*^9}, {3.6407271784042253`*^9, 
   3.64072719049279*^9}, {3.6407272345777397`*^9, 3.6407273418345957`*^9}, 
   3.644701015262629*^9, 3.644701054333921*^9, {3.64470200045364*^9, 
   3.6447020010834312`*^9}, {3.644702043014484*^9, 3.644702055315289*^9}, {
   3.644702095241847*^9, 3.644702110198268*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FinalBraid", "[", 
   RowBox[{"braid_", ",", "r_BrokenR3"}], "]"}], ":=", 
  RowBox[{"FinalBraid", "[", 
   RowBox[{"braid", ",", 
    RowBox[{"R3", "@@", "r"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6265693529073687`*^9, 3.626569372422565*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"BraidMovie", "[", 
    RowBox[{"braid_", ",", 
     RowBox[{"{", 
      RowBox[{"x___", ",", 
       RowBox[{"InsertDot", "[", 
        RowBox[{"crossing_", ",", "pos_"}], "]"}], ",", "y___"}], "}"}]}], 
    "]"}], ":=", 
   RowBox[{"BraidMovie", "[", 
    RowBox[{"braid", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"StillInsertDot", "[", 
        RowBox[{"crossing", ",", "pos", ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], ",", "y"}], "}"}]}], "]"}]}], 
  "*)"}]], "Input",
 CellChangeTimes->{{3.636693997458065*^9, 3.636694005992588*^9}, {
  3.636694037492339*^9, 3.636694048613792*^9}, {3.6366940951901207`*^9, 
  3.636694136209828*^9}, {3.636694330764411*^9, 3.636694349583106*^9}, {
  3.636694479162776*^9, 3.636694505968211*^9}, {3.636694544644841*^9, 
  3.636694550094008*^9}, {3.636705177821908*^9, 3.636705230545251*^9}, {
  3.6367052706603117`*^9, 3.636705272416705*^9}, {3.636742430281316*^9, 
  3.636742430846355*^9}, {3.636743395336605*^9, 3.636743400544342*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", 
       RowBox[{"{", 
        RowBox[{"InsertDot", "[", 
         RowBox[{"crossing_", ",", "pos_"}], "]"}], "}"}]}], "]"}], "]"}], 
    "[", 
    RowBox[{"v", ":", 
     RowBox[{"BasisVector", "[", 
      RowBox[{
       RowBox[{"Resolution", "[", 
        RowBox[{"braid_", ",", "resolution_", ",", "circles_"}], "]"}], ",", 
       "signs_"}], "]"}]}], "]"}], ":=", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "dot", ",", "dotSign", ",", "dotPos", ",", "oldSigns", ",", "newSigns", 
       ",", "\[IndentingNewLine]", "offset1", ",", "offset2"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"offset1", "=", 
       RowBox[{
        RowBox[{"4", "*", "crossing"}], "+", "pos"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"offset2", "=", 
       RowBox[{
        RowBox[{"4", "*", "crossing"}], "+", 
        RowBox[{"Mod", "[", 
         RowBox[{"pos", ",", "4"}], "]"}], "+", "1"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"oldSigns", "=", 
       RowBox[{"circles", "/.", "signs"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"dot", "=", 
       RowBox[{"Union", "[", 
        RowBox[{
         RowBox[{"Position", "[", 
          RowBox[{"circles", ",", "offset1"}], "]"}], ",", 
         RowBox[{"Position", "[", 
          RowBox[{"circles", ",", "offset2"}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"dotSign", "=", 
       RowBox[{"oldSigns", "\[LeftDoubleBracket]", 
        RowBox[{"dot", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dotSign", "\[Equal]", "1"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"dotPos", "=", 
          RowBox[{"Union", "[", 
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{"signs", ",", "offset1"}], "]"}], ",", 
            RowBox[{"Position", "[", 
             RowBox[{"signs", ",", "offset2"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newSigns", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"signs", ",", 
            RowBox[{
             RowBox[{"dotPos", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
             RowBox[{
              RowBox[{"signs", "\[LeftDoubleBracket]", 
               RowBox[{
                RowBox[{"dotPos", "\[LeftDoubleBracket]", 
                 RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                "1"}], "\[RightDoubleBracket]"}], "\[Rule]", 
              RowBox[{"-", "1"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"BasisVector", "[", 
          RowBox[{
           RowBox[{"Resolution", "[", 
            RowBox[{"braid", ",", "resolution"}], "]"}], ",", "newSigns"}], 
          "]"}]}], ",", "\[IndentingNewLine]", "0"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Alpha]Solve", "[", 
   RowBox[{"equations_", ",", "var_"}], "]"}], ":=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"DeleteCases", "[", 
     RowBox[{"equations", ",", "True"}], "]"}], ",", 
    RowBox[{"Union", "[", 
     RowBox[{"Cases", "[", 
      RowBox[{"equations", ",", 
       RowBox[{"var", "[", "__", "]"}], ",", "\[Infinity]"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsertDotCheck", "[", 
   RowBox[{"bm1_BraidMovie", ",", "bm2_BraidMovie"}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"\[Alpha]Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"InsertDotCheck", "[", 
       RowBox[{"bm1", ",", "bm2", ",", "#"}], "]"}], "&"}], "/@", 
     RowBox[{"AllBasisVectors", "[", 
      RowBox[{"Still", "[", 
       RowBox[{"bm1", ",", "0"}], "]"}], "]"}]}], ",", "\[Alpha]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"InsertDotCheck", "[", 
   RowBox[{"bm1_BraidMovie", ",", "bm2_BraidMovie", ",", "v_BasisVector"}], 
   "]"}], ":=", 
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", "bm1", "]"}], "[", "v", "]"}], "\[Equal]", 
   RowBox[{
    RowBox[{"KhC", "[", "bm2", "]"}], "[", "v", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.635803297916327*^9, 3.635803548294279*^9}, {
   3.6358114794143963`*^9, 3.6358115944621572`*^9}, {3.636694072182404*^9, 
   3.6366940895875797`*^9}, {3.636705294570486*^9, 3.636705371641263*^9}, {
   3.636742232728876*^9, 3.636742253567397*^9}, {3.636742433711555*^9, 
   3.636742434464946*^9}, {3.6374403144513474`*^9, 3.63744031499094*^9}, {
   3.6374403535239267`*^9, 3.637440362784803*^9}, {3.637440535909841*^9, 
   3.6374405615287237`*^9}, {3.637448373474647*^9, 3.637448394152514*^9}, 
   3.637462303754121*^9, {3.637554665579795*^9, 3.6375546665757217`*^9}, {
   3.637612080039013*^9, 3.637612120671721*^9}, {3.637612241746249*^9, 
   3.6376122589747047`*^9}, 3.6376124625814753`*^9, {3.6376124929765253`*^9, 
   3.6376125192961617`*^9}, {3.637613530770412*^9, 3.637613532817746*^9}, {
   3.637613625936923*^9, 3.6376136291000643`*^9}, {3.6376199771842318`*^9, 
   3.637619982057474*^9}, {3.637620027886381*^9, 3.637620030678443*^9}, {
   3.637705127559369*^9, 3.637705137278458*^9}, {3.637705174143499*^9, 
   3.637705179271543*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"findOffset", "[", 
       RowBox[{"crossing_", ",", 
        RowBox[{"{", "}"}]}], "]"}], ":=", "crossing"}], ";"}], 
    "\[IndentingNewLine]", 
    RowBox[{"findOffset", "[", 
     RowBox[{"crossing_", ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Cycle", "[", "offset_", "]"}], ",", "x___"}], "}"}]}], 
     "]"}]}], ":=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"findOffset", "[", 
      RowBox[{
       RowBox[{"crossing", "+", "offset"}], ",", 
       RowBox[{"{", "x", "}"}]}], "]"}], "\[IndentingNewLine]", 
     RowBox[{"findOffset", "[", 
      RowBox[{"crossing_", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"R1", "[", 
          RowBox[{"type_", ",", "sign_", ",", "offset_"}], "]"}], ",", 
         "x___"}], "}"}]}], "]"}]}], ":=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"offset", "\[LessEqual]", "crossing"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"findOffset", "[", 
         RowBox[{
          RowBox[{"crossing", "+", "type"}], ",", 
          RowBox[{"{", "x", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"findOffset", "[", 
         RowBox[{"crossing", ",", 
          RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"findOffset", "[", 
       RowBox[{"crossing_", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"R2", "[", 
           RowBox[{"offset_", ",", "type_", ",", "generator_"}], "]"}], ",", 
          "x___"}], "}"}]}], "]"}]}], ":=", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"offset", "\[LessEqual]", "crossing"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"findOffset", "[", 
        RowBox[{
         RowBox[{"crossing", "+", 
          RowBox[{"2", "*", "type"}]}], ",", 
         RowBox[{"{", "x", "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"findOffset", "[", 
        RowBox[{"crossing", ",", 
         RowBox[{"{", "x", "}"}]}], "]"}]}], "]"}]}]}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.636705365072795*^9, 3.636705557262258*^9}, {
  3.6367056296093884`*^9, 3.636705748070982*^9}, {3.636705821248081*^9, 
  3.636705878749681*^9}, {3.63674202085524*^9, 3.636742124579803*^9}, {
  3.636742198468034*^9, 3.6367422039635572`*^9}, {3.637438365233017*^9, 
  3.6374383658233013`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"KhC", "[", 
    RowBox[{"BraidMovie", "[", 
     RowBox[{"braid_", ",", " ", 
      RowBox[{"{", 
       RowBox[{"BrokenR3", "[", 
        RowBox[{
        "offset_", ",", "generator_", ",", "direction_", ",", "signs_", ",", 
         "\[Alpha]_"}], "]"}], "}"}]}], "]"}], "]"}], "[", "v_BasisVector", 
   "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"layers", ",", "md"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"direction", "===", "\"\<L\>\""}], "\[And]", 
        RowBox[{"signs", "===", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}]}], "\[Or]", 
       RowBox[{
        RowBox[{"direction", "===", "\"\<R\>\""}], "\[And]", 
        RowBox[{"signs", "===", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}]}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"layers", "=", 
        RowBox[{
         RowBox[{"KhC", "[", 
          RowBox[{"BraidMovie", "[", 
           RowBox[{"braid", ",", " ", 
            RowBox[{"{", 
             RowBox[{"Layers", "[", 
              RowBox[{
              "offset", ",", "generator", ",", "direction", ",", "signs"}], 
              "]"}], "}"}]}], "]"}], "]"}], "[", "v", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"md", "=", 
        RowBox[{
         RowBox[{"KhC", "[", 
          RowBox[{"BraidMovie", "[", 
           RowBox[{"braid", ",", " ", 
            RowBox[{"{", 
             RowBox[{"MysteryDiagonalb", "[", 
              RowBox[{
              "offset", ",", " ", "generator", ",", "direction", ",", "signs",
                ",", "\[Alpha]"}], "]"}], "}"}]}], "]"}], "]"}], "[", "v", 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Layers: \>\"", ",", "layers"}], "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Mystery Diagonal: \>\"", ",", "md"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"layers", "+", "md"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Print", "[", "\"\<The R3 move doesn't look right!\>\"", "]"}],
        ";", 
       RowBox[{"Abort", "[", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.626039310293188*^9, 3.626039420604514*^9}, {
   3.626039494687175*^9, 3.626039626529912*^9}, {3.626039737222796*^9, 
   3.6260398806067343`*^9}, {3.626039939328808*^9, 3.626039956837266*^9}, {
   3.626040268667762*^9, 3.626040272313695*^9}, {3.626040467610284*^9, 
   3.6260405517272377`*^9}, {3.626040656730877*^9, 3.626040723737152*^9}, {
   3.6260451367146673`*^9, 3.626045153876486*^9}, {3.626045221549035*^9, 
   3.626045223915928*^9}, {3.626045389372843*^9, 3.626045399644928*^9}, {
   3.6260472319744177`*^9, 3.626047294657329*^9}, {3.626047352586693*^9, 
   3.626047366122913*^9}, {3.6260474331173687`*^9, 3.626047461501028*^9}, {
   3.6260475068069344`*^9, 3.6260475353976307`*^9}, {3.626047571798642*^9, 
   3.626047626533927*^9}, {3.6260476573088503`*^9, 3.626047687288591*^9}, {
   3.626047725743753*^9, 3.6260477406257877`*^9}, {3.626047774295879*^9, 
   3.6260478942626257`*^9}, {3.626047982809642*^9, 3.62604825135879*^9}, {
   3.6260482857809677`*^9, 3.626048287732545*^9}, {3.626048361939424*^9, 
   3.626048412697309*^9}, {3.6260484623682957`*^9, 3.6260484828799686`*^9}, {
   3.6260485162471333`*^9, 3.626048609981007*^9}, {3.626048665236088*^9, 
   3.6260486837822237`*^9}, {3.6260491027456207`*^9, 
   3.6260491499905024`*^9}, {3.626049432928586*^9, 3.626049586659687*^9}, {
   3.626049648383903*^9, 3.626049764538356*^9}, {3.62604980477514*^9, 
   3.6260498428088827`*^9}, {3.6260498798571873`*^9, 
   3.6260500137000523`*^9}, {3.626050114671917*^9, 3.626050162681761*^9}, 
   3.626050205303986*^9, {3.626050265365798*^9, 3.6260503173996153`*^9}, {
   3.626050359800722*^9, 3.626050410826453*^9}, {3.626050557030972*^9, 
   3.626050724975048*^9}, {3.626050803884946*^9, 3.62605080714223*^9}, {
   3.626051114496583*^9, 3.626051186807418*^9}, {3.6260512407606*^9, 
   3.626051272272434*^9}, {3.6260513522793427`*^9, 3.626051425007037*^9}, {
   3.626051514009706*^9, 3.6260515153197737`*^9}, {3.6260515584951887`*^9, 
   3.626051578358694*^9}, {3.6260517257839413`*^9, 3.626051753010272*^9}, {
   3.62605181782414*^9, 3.6260518976844587`*^9}, {3.626051979400413*^9, 
   3.62605197983742*^9}, {3.6260521100586767`*^9, 3.626052114513793*^9}, {
   3.626052185588328*^9, 3.626052225660759*^9}, {3.6260523099952517`*^9, 
   3.6260523553187227`*^9}, {3.626052404310768*^9, 3.6260524690302153`*^9}, {
   3.626052604833259*^9, 3.626052677317821*^9}, {3.626052746994711*^9, 
   3.626052820783352*^9}, 3.626052861089592*^9, 3.626058252850823*^9, {
   3.626132328563308*^9, 3.62613241904563*^9}, {3.626381224072734*^9, 
   3.626381282410317*^9}, {3.626381327657401*^9, 3.6263813431862383`*^9}, {
   3.626381418137211*^9, 3.6263814540738153`*^9}, {3.626393769780141*^9, 
   3.6263938271860123`*^9}, {3.62639728891212*^9, 3.626397320786067*^9}, {
   3.6263973563842077`*^9, 3.6263973729100924`*^9}, {3.62639749148567*^9, 
   3.626397492533677*^9}, 3.6263975709499197`*^9, {3.626397604492444*^9, 
   3.626397690574881*^9}, {3.6263977568160057`*^9, 3.626397830712426*^9}, {
   3.626398466949581*^9, 3.6263985082985897`*^9}, {3.626398561533675*^9, 
   3.626398583166236*^9}, {3.626398641836988*^9, 3.626398705765437*^9}, {
   3.6263988814964247`*^9, 3.626398922875511*^9}, {3.626553722675852*^9, 
   3.626553756200717*^9}, {3.626553806951631*^9, 3.626553812542377*^9}, {
   3.626553845653194*^9, 3.626553849896564*^9}, {3.626553895339149*^9, 
   3.626553931485132*^9}, {3.626553979818534*^9, 3.626554005773056*^9}, {
   3.626554036490879*^9, 3.6265541382488537`*^9}, {3.626554214682191*^9, 
   3.626554223718918*^9}, {3.6265542558857317`*^9, 3.6265542588679247`*^9}, {
   3.6265543200977383`*^9, 3.6265543300865726`*^9}, {3.626554427257626*^9, 
   3.626554427387848*^9}, {3.6265544807113457`*^9, 3.626554536358054*^9}, {
   3.626554568828652*^9, 3.626554576527622*^9}, {3.626554629812595*^9, 
   3.6265546727516403`*^9}, {3.626554806915536*^9, 3.626554824299451*^9}, {
   3.626554856611848*^9, 3.626554961138197*^9}, {3.626555172348421*^9, 
   3.6265552719830837`*^9}, {3.626555312865679*^9, 3.626555328429675*^9}, {
   3.6265553663496723`*^9, 3.626555368594121*^9}, {3.626555398711102*^9, 
   3.6265554046237297`*^9}, {3.626555559504929*^9, 3.626555563535729*^9}, {
   3.626555655884117*^9, 3.626555656803537*^9}, {3.626555786066968*^9, 
   3.6265558142616987`*^9}, {3.626555846277823*^9, 3.6265559132712297`*^9}, {
   3.626556589668818*^9, 3.626556592981584*^9}, {3.626568393900508*^9, 
   3.62656840180088*^9}, 3.626568473878531*^9, {3.626568864270111*^9, 
   3.62656898635702*^9}, {3.626570805245858*^9, 3.6265708610205708`*^9}, {
   3.6265709273382397`*^9, 3.6265709642399893`*^9}, {3.633984955296605*^9, 
   3.633985000149117*^9}, {3.633985050491508*^9, 3.6339850515875807`*^9}, {
   3.634437631034376*^9, 3.6344376560943737`*^9}, {3.634438034549333*^9, 
   3.634438077554229*^9}, 3.637445521954577*^9, {3.637447145515358*^9, 
   3.637447159156438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", 
       RowBox[{"{", 
        RowBox[{"Layers", "[", 
         RowBox[{"offset_", ",", "minGenerator_", ",", "direction_", ",", 
          RowBox[{"{", 
           RowBox[{"x_", ",", "y_", ",", "z_"}], "}"}]}], "]"}], "}"}]}], 
      "]"}], "]"}], "[", 
    RowBox[{"v", " ", ":", " ", 
     RowBox[{"BasisVector", "[", 
      RowBox[{
       RowBox[{"Resolution", "[", 
        RowBox[{"braid_", ",", " ", "resolution_", ",", " ", "circles_"}], 
        "]"}], ",", " ", "signs_"}], "]"}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "newBraid", ",", "newResolution", ",", "\[IndentingNewLine]", "image", 
       ",", "newCircles", ",", "\[IndentingNewLine]", "oldSigns", ",", 
       RowBox[{"newSigns", "=", "Null"}], ",", "\[IndentingNewLine]", 
       "newBasisVector", ",", "\[IndentingNewLine]", "afterR2", ",", "i", ",",
        "\[IndentingNewLine]", 
       RowBox[{"sign", "=", "1"}], ",", "result"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"resolution", "\[LeftDoubleBracket]", 
         RowBox[{"offset", "+", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
        "1"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Print", "[", 
         RowBox[{"\"\<computing 'identity' part of an R3 move on \>\"", ",", 
          RowBox[{"BasisVector", "[", 
           RowBox[{
            RowBox[{"Resolution", "[", 
             RowBox[{"braid", ",", " ", "resolution", ",", " ", "circles"}], 
             "]"}], ",", " ", "signs"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newBraid", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"braid", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "1"}]}], "}"}], "\[Rule]", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"offset", "+", "3"}]}], "\[RightDoubleBracket]"}], 
                "]"}], "*", 
               RowBox[{"Abs", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}], 
                "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "2"}]}], "}"}], "->", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}], 
                "]"}], "*", 
               RowBox[{"Abs", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
                "]"}]}]}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"2", ",", 
                RowBox[{"offset", "+", "3"}]}], "}"}], "->", 
              RowBox[{
               RowBox[{"Sign", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
                "]"}], "*", 
               RowBox[{"Abs", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}], 
                "]"}]}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newResolution", "=", 
         RowBox[{"ReplacePart", "[", 
          RowBox[{"resolution", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"offset", "+", "1"}], "}"}], "\[Rule]", 
              RowBox[{"1", "-", 
               RowBox[{"resolution", "\[LeftDoubleBracket]", 
                RowBox[{"offset", "+", "1"}], "\[RightDoubleBracket]"}]}]}], 
             ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"offset", "+", "3"}], "}"}], "\[Rule]", 
              RowBox[{"1", "-", 
               RowBox[{"resolution", "\[LeftDoubleBracket]", 
                RowBox[{"offset", "+", "3"}], "\[RightDoubleBracket]"}]}]}]}],
             "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"image", "=", 
         RowBox[{"Resolution", "[", 
          RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"newCircles", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"#", ",", 
             RowBox[{"n_", "/;", 
              RowBox[{"MemberQ", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"4", "*", "offset"}], "+", 
                 RowBox[{"Range", "[", "12", "]"}]}], ",", "n"}], "]"}]}]}], 
            "]"}], "&"}], "/@", "circles"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newCircles", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Position", "[", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "3", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{
               "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
              "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
           "newCircles"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"newCircles", "=", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
            "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}], "/@",
           "newCircles"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"oldSigns", "=", 
         RowBox[{"circles", "/.", "signs"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"newSigns", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
           RowBox[{"{", 
            RowBox[{"newCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"direction", "\[Equal]", "\"\<R\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2", ",", "3"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "0"}], ",", 
            RowBox[{"sign", "=", 
             RowBox[{"-", "1"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"v", "\[LeftDoubleBracket]", 
              RowBox[{"1", ",", "2", ",", "3"}], "\[RightDoubleBracket]"}], 
             "\[Equal]", "1"}], ",", 
            RowBox[{"sign", "=", 
             RowBox[{"-", "1"}]}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"sign", "*", 
         RowBox[{"constructBasisVectorOrNot", "[", 
          RowBox[{"image", ",", "newSigns", ",", 
           RowBox[{"{", "}"}]}], "]"}]}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
         "Print", "[", "\"\<computing 'R2' part of an R3 move\>\"", "]"}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<v: \>\"", ",", "v"}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"newBraid", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"braid", ",", 
            RowBox[{"{", 
             RowBox[{"2", ",", 
              RowBox[{"offset", "+", "2"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newResolution", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"resolution", ",", 
            RowBox[{"{", 
             RowBox[{"offset", "+", "2"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"image", "=", 
          RowBox[{"Resolution", "[", 
           RowBox[{"newBraid", ",", "newResolution"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newCircles", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"DeleteCases", "[", 
             RowBox[{"#", ",", 
              RowBox[{"n_", "/;", 
               RowBox[{"MemberQ", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"4", "*", "offset"}], "+", "4", "+", 
                  RowBox[{"Range", "[", "4", "]"}]}], ",", "n"}], "]"}]}]}], 
             "]"}], "&"}], "/@", "circles"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newCircles", "=", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{"newCircles", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"#", "\[Rule]", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                 "newCircles", "\[LeftDoubleBracket]", "#", 
                  "\[RightDoubleBracket]"}], "-", 
                 RowBox[{"4", "*", 
                  RowBox[{"UnitStep", "[", 
                   RowBox[{
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "9"}], ")"}]}], 
                   "]"}]}]}], ")"}]}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "newCircles", "]"}], "]"}]}]}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"newCircles", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{
                "image", "\[LeftDoubleBracket]", "3", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{
                "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
                "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
              "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
            "newCircles"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newCircles", "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
             "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
             "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}], "/@",
            "newCircles"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"\"\<newCircles, \>\"", ",", "newCircles"}], "]"}], ";"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"oldSigns", "=", 
          RowBox[{"circles", "/.", "signs"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"newSigns", "=", 
          RowBox[{"MapThread", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
            RowBox[{"{", 
             RowBox[{"newCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newBasisVector", "=", 
          RowBox[{"constructBasisVectorOrNot", "[", 
           RowBox[{"image", ",", "newSigns", ",", 
            RowBox[{"{", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{"image", ",", "braid", ",", "newBasisVector"}], "]"}], 
           ";", "\[IndentingNewLine]", 
           RowBox[{"Print", "[", 
            RowBox[{"R2", "[", 
             RowBox[{"offset", ",", "1", ",", 
              RowBox[{
               RowBox[{"braid", "\[LeftDoubleBracket]", 
                RowBox[{"2", ",", 
                 RowBox[{"1", "+", "offset"}]}], "\[RightDoubleBracket]"}], 
               "-", 
               RowBox[{"Abs", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"1", "+", "offset"}]}], "\[RightDoubleBracket]"}], 
                "]"}], "+", 
               RowBox[{"Abs", "[", 
                RowBox[{"braid", "\[LeftDoubleBracket]", 
                 RowBox[{"2", ",", 
                  RowBox[{"2", "+", "offset"}]}], "\[RightDoubleBracket]"}], 
                "]"}]}]}], "]"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<newBasisVector \>\"", ",", "newBasisVector", ",", 
             "\"\< Braid movie: \>\"", ",", 
             RowBox[{"BraidMovie", "[", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "1", 
                "\[RightDoubleBracket]"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"R2", "[", 
                  RowBox[{"offset", ",", 
                   RowBox[{"-", "1"}], ",", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                 RowBox[{"R2", "[", 
                  RowBox[{"offset", ",", "1", ",", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"2", "+", "offset"}]}], 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "}"}]}], "]"}]}], 
            "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"afterR2", "=", 
          RowBox[{
           RowBox[{"KhC", "[", 
            RowBox[{"BraidMovie", "[", 
             RowBox[{
              RowBox[{
              "image", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"R2", "[", 
                 RowBox[{"offset", ",", 
                  RowBox[{"-", "1"}], ",", 
                  RowBox[{"braid", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "1"}]}], 
                   "\[RightDoubleBracket]"}]}], "]"}], ",", 
                RowBox[{"R2", "[", 
                 RowBox[{"offset", ",", "1", ",", 
                  RowBox[{"braid", "\[LeftDoubleBracket]", 
                   RowBox[{"2", ",", 
                    RowBox[{"2", "+", "offset"}]}], 
                   "\[RightDoubleBracket]"}]}], "]"}]}], "}"}]}], "]"}], 
            "]"}], "[", "newBasisVector", "]"}]}], ";"}], 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Print", "[", 
          RowBox[{"\"\<afterR2: \>\"", ",", "afterR2"}], "]"}], "*)"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{"\"\<length: \>\"", ",", 
            RowBox[{"Length", "[", "afterR2", "]"}]}], "]"}], ";"}], "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"afterR2", "===", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"resolution", "\[LeftDoubleBracket]", 
              RowBox[{
               RowBox[{"offset", "+", "1"}], ";;", 
               RowBox[{"offset", "+", "3"}]}], "\[RightDoubleBracket]"}], 
             "]"}], ";", "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"resolution", "\[LeftDoubleBracket]", 
                RowBox[{
                 RowBox[{"offset", "+", "1"}], ";;", 
                 RowBox[{"offset", "+", "3"}]}], "\[RightDoubleBracket]"}], 
               "\[NotEqual]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
              "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"image", "=", 
                RowBox[{"Resolution", "[", 
                 RowBox[{"newBraid", ",", "resolution"}], "]"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"newCircles", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{"DeleteCases", "[", 
                   RowBox[{"#", ",", 
                    RowBox[{"n_", "/;", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", 
                    RowBox[{"Range", "[", "12", "]"}]}], ",", "n"}], 
                    "]"}]}]}], "]"}], "&"}], "/@", "circles"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"newCircles", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{
                    "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                    "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "&"}], "/@", "newCircles"}]}], ";", "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                 RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
               "\[IndentingNewLine]", 
               RowBox[{"newCircles", "=", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                   "image", "\[LeftDoubleBracket]", "3", 
                    "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}], "&"}], "/@", "newCircles"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"oldSigns", "=", 
                RowBox[{"circles", "/.", "signs"}]}], ";", 
               "\[IndentingNewLine]", 
               RowBox[{"newSigns", "=", 
                RowBox[{"MapThread", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"newCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], 
               ";", "\[IndentingNewLine]", 
               RowBox[{"constructBasisVectorOrNot", "[", 
                RowBox[{"image", ",", "newSigns", ",", 
                 RowBox[{"{", "}"}]}], "]"}]}]}], "]"}]}], "*)"}], 
          "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"Find", " ", "new", " ", "signs"}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"newBraid", "=", 
            RowBox[{"ReplacePart", "[", 
             RowBox[{"braid", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"offset", "+", "1"}]}], "}"}], "\[Rule]", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "3"}]}], "\[RightDoubleBracket]"}],
                    "]"}], "*", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}],
                    "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"offset", "+", "2"}]}], "}"}], "->", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}],
                    "]"}], "*", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}],
                    "]"}]}]}], ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"2", ",", 
                   RowBox[{"offset", "+", "3"}]}], "}"}], "->", 
                 RowBox[{
                  RowBox[{"Sign", "[", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}],
                    "]"}], "*", 
                  RowBox[{"Abs", "[", 
                   RowBox[{"braid", "\[LeftDoubleBracket]", 
                    RowBox[{"2", ",", 
                    RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}],
                    "]"}]}]}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"afterR2", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"{", "afterR2", "}"}], ",", "b_BasisVector", ",", 
              "\[Infinity]"}], "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"image", "=", 
            RowBox[{"newCircles", "=", 
             RowBox[{"oldSigns", "=", 
              RowBox[{"newSigns", "=", 
               RowBox[{"newResolution", "=", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", "}"}], ",", 
                  RowBox[{"{", "}"}]}], "}"}]}]}]}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"For", "[", 
            RowBox[{
             RowBox[{"i", "=", "1"}], ",", 
             RowBox[{"i", "<", 
              RowBox[{
               RowBox[{"Length", "[", "afterR2", "]"}], "+", "1"}]}], ",", 
             RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"\"\<start: \>\"", ",", "i"}], "]"}], ";"}], "*)"}], 
             "\[IndentingNewLine]", 
             RowBox[{"(*", 
              RowBox[{
               RowBox[{"Print", "[", 
                RowBox[{"newResolution", ",", "\"\<   \>\"", ",", "afterR2"}],
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{
               "newResolution", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{"resolution", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"offset", "+", "1"}], "}"}], "\[Rule]", 
                    RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1", ",", "2", ",", 
                    RowBox[{"offset", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], ",", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"offset", "+", "3"}], "}"}], "\[Rule]", 
                    RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1", ",", "2", ",", 
                    RowBox[{"offset", "+", "2"}]}], 
                    "\[RightDoubleBracket]"}]}]}], "}"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "resolution", ",", "\"\< , \>\"", ",", "newResolution"}], 
                 "]"}], ";", "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{"newBraid", ",", 
                  RowBox[{
                  "newResolution", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "image", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"Resolution", "[", 
                RowBox[{"newBraid", ",", 
                 RowBox[{
                 "newResolution", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "i", ",", "newBraid", ",", "\"\<  image: \>\"", ",", 
                  "image"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "newCircles", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{"n_", "/;", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", 
                    RowBox[{"Range", "[", "8", "]"}]}], ",", "n"}], "]"}]}]}],
                   "]"}], "&"}], "/@", 
                RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1", ",", "3"}], 
                 "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "newCircles", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"ReplacePart", "[", 
                RowBox[{
                 RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "1", ",", "3"}], 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"#", "\[Rule]", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1", ",", "3", ",", "#"}], 
                    "\[RightDoubleBracket]"}], "+", 
                    RowBox[{"4", "*", 
                    RowBox[{"UnitStep", "[", 
                    RowBox[{
                    RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1", ",", "3", ",", "#"}], 
                    "\[RightDoubleBracket]"}], "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", "*", "offset"}], "+", "9"}], ")"}]}], 
                    "]"}]}]}], ")"}]}], "&"}], "/@", 
                  RowBox[{"Range", "[", 
                   RowBox[{"Length", "[", 
                    RowBox[{
                    "newCircles", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], "]"}], "]"}]}]}], "]"}]}], ";",
               "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{"5", ",", "image"}], "]"}], ";", 
                "\[IndentingNewLine]", 
                RowBox[{"Print", "[", 
                 RowBox[{
                  RowBox[{
                  "newCircles", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "1", ",", "3"}], 
                   "\[RightDoubleBracket]"}]}], "]"}], ";"}], "*)"}], 
              "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "newCircles", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"image", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], 
                   "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                  "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
                 "&"}], "/@", 
                RowBox[{
                "newCircles", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "newCircles", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"image", "\[LeftDoubleBracket]", 
                   RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}], 
                  "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], 
                 "&"}], "/@", 
                RowBox[{
                "newCircles", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], ";", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "oldSigns", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{
                RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "1", ",", "3"}], "\[RightDoubleBracket]"}],
                 "/.", 
                RowBox[{"afterR2", "\[LeftDoubleBracket]", 
                 RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"(*", 
               RowBox[{
                RowBox[{"Print", "[", 
                 RowBox[{
                 "\"\<signs: \>\"", ",", "newCircles", ",", "oldSigns"}], 
                 "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{
               "newSigns", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}], "=", 
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{
                   "newCircles", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", 
                   RowBox[{
                   "oldSigns", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}]}], "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"Length", "[", "afterR2", "]"}], ",", "\"\<:\>\"", ",",
                "afterR2"}], "]"}], ";", "\[IndentingNewLine]", 
             RowBox[{"Print", "[", 
              RowBox[{
              "\"\<n: \>\"", ",", "newBraid", ",", "newResolution", ",", 
               "newSigns"}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"constructBasisVectorOrNot", "[", 
                 RowBox[{
                  RowBox[{"Resolution", "[", 
                   RowBox[{"newBraid", ",", 
                    RowBox[{
                    "newResolution", "\[LeftDoubleBracket]", "#", 
                    "\[RightDoubleBracket]"}]}], "]"}], ",", 
                  RowBox[{
                  "newSigns", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}], ",", 
                  RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "afterR2", "]"}], "]"}]}], "]"}], 
             ";"}], "*)"}], "\[IndentingNewLine]", 
           RowBox[{"result", "=", 
            RowBox[{
             RowBox[{
              RowBox[{"constructBasisVectorOrNot", "[", 
               RowBox[{
                RowBox[{"Resolution", "[", 
                 RowBox[{"newBraid", ",", 
                  RowBox[{
                  "newResolution", "\[LeftDoubleBracket]", "#", 
                   "\[RightDoubleBracket]"}]}], "]"}], ",", 
                RowBox[{
                "newSigns", "\[LeftDoubleBracket]", "#", 
                 "\[RightDoubleBracket]"}], ",", 
                RowBox[{"{", "}"}]}], "]"}], "&"}], "/@", 
             RowBox[{"Range", "[", 
              RowBox[{"Length", "[", "afterR2", "]"}], "]"}]}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"direction", "\[Equal]", "\"\<L\>\""}], "&&", 
              RowBox[{"resolution", "\[Equal]", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], ",", 
             RowBox[{"result", "=", 
              RowBox[{"MapAt", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "1"}], "*", "#"}], "&"}], ",", "result", ",", 
                RowBox[{
                 RowBox[{
                  RowBox[{"First", "[", "#", "]"}], "&"}], "/@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"result", ",", 
                   RowBox[{"{", 
                    RowBox[{"1", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], 
               "]"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"Total", "[", "result", "]"}]}]}], "\[IndentingNewLine]", 
         "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.626039310293188*^9, 3.626039420604514*^9}, {
   3.626039494687175*^9, 3.626039626529912*^9}, {3.626039737222796*^9, 
   3.6260398806067343`*^9}, {3.626039939328808*^9, 3.626039956837266*^9}, {
   3.626040268667762*^9, 3.626040272313695*^9}, {3.626040467610284*^9, 
   3.6260405517272377`*^9}, {3.626040656730877*^9, 3.626040723737152*^9}, {
   3.6260451367146673`*^9, 3.626045153876486*^9}, {3.626045221549035*^9, 
   3.626045223915928*^9}, {3.626045389372843*^9, 3.626045399644928*^9}, {
   3.6260472319744177`*^9, 3.626047294657329*^9}, {3.626047352586693*^9, 
   3.626047366122913*^9}, {3.6260474331173687`*^9, 3.626047461501028*^9}, {
   3.6260475068069344`*^9, 3.6260475353976307`*^9}, {3.626047571798642*^9, 
   3.626047626533927*^9}, {3.6260476573088503`*^9, 3.626047687288591*^9}, {
   3.626047725743753*^9, 3.6260477406257877`*^9}, {3.626047774295879*^9, 
   3.6260478942626257`*^9}, {3.626047982809642*^9, 3.62604825135879*^9}, {
   3.6260482857809677`*^9, 3.626048287732545*^9}, {3.626048361939424*^9, 
   3.626048412697309*^9}, {3.6260484623682957`*^9, 3.6260484828799686`*^9}, {
   3.6260485162471333`*^9, 3.626048609981007*^9}, {3.626048665236088*^9, 
   3.6260486837822237`*^9}, {3.6260491027456207`*^9, 
   3.6260491499905024`*^9}, {3.626049432928586*^9, 3.626049586659687*^9}, {
   3.626049648383903*^9, 3.626049764538356*^9}, {3.62604980477514*^9, 
   3.6260498428088827`*^9}, {3.6260498798571873`*^9, 
   3.6260500137000523`*^9}, {3.626050114671917*^9, 3.626050162681761*^9}, 
   3.626050205303986*^9, {3.626050265365798*^9, 3.6260503173996153`*^9}, {
   3.626050359800722*^9, 3.626050410826453*^9}, {3.626050557030972*^9, 
   3.626050724975048*^9}, {3.626050803884946*^9, 3.62605080714223*^9}, {
   3.626051114496583*^9, 3.626051186807418*^9}, {3.6260512407606*^9, 
   3.626051272272434*^9}, {3.6260513522793427`*^9, 3.626051425007037*^9}, {
   3.626051514009706*^9, 3.6260515153197737`*^9}, {3.6260515584951887`*^9, 
   3.626051578358694*^9}, {3.6260517257839413`*^9, 3.626051753010272*^9}, {
   3.62605181782414*^9, 3.6260518976844587`*^9}, {3.626051979400413*^9, 
   3.62605197983742*^9}, {3.6260521100586767`*^9, 3.626052114513793*^9}, {
   3.626052185588328*^9, 3.626052225660759*^9}, {3.6260523099952517`*^9, 
   3.6260523553187227`*^9}, {3.626052404310768*^9, 3.6260524690302153`*^9}, {
   3.626052604833259*^9, 3.626052677317821*^9}, {3.626052746994711*^9, 
   3.626052820783352*^9}, 3.626052861089592*^9, 3.626058252850823*^9, {
   3.626132328563308*^9, 3.62613241904563*^9}, {3.626381224072734*^9, 
   3.626381282410317*^9}, {3.626381327657401*^9, 3.6263813431862383`*^9}, {
   3.626381418137211*^9, 3.6263814540738153`*^9}, {3.626393769780141*^9, 
   3.6263938271860123`*^9}, {3.62639728891212*^9, 3.626397320786067*^9}, {
   3.6263973563842077`*^9, 3.6263973729100924`*^9}, {3.62639749148567*^9, 
   3.626397492533677*^9}, 3.6263975709499197`*^9, {3.626397604492444*^9, 
   3.626397690574881*^9}, {3.6263977568160057`*^9, 3.626397830712426*^9}, {
   3.626398466949581*^9, 3.6263985082985897`*^9}, {3.626398561533675*^9, 
   3.626398583166236*^9}, {3.626398641836988*^9, 3.626398705765437*^9}, {
   3.6263988814964247`*^9, 3.626398922875511*^9}, {3.626553722675852*^9, 
   3.626553756200717*^9}, {3.626553806951631*^9, 3.626553812542377*^9}, {
   3.626553845653194*^9, 3.626553849896564*^9}, {3.626553895339149*^9, 
   3.626553931485132*^9}, {3.626553979818534*^9, 3.626554005773056*^9}, {
   3.626554036490879*^9, 3.6265541382488537`*^9}, {3.626554214682191*^9, 
   3.626554223718918*^9}, {3.6265542558857317`*^9, 3.6265542588679247`*^9}, {
   3.6265543200977383`*^9, 3.6265543300865726`*^9}, {3.626554427257626*^9, 
   3.626554427387848*^9}, {3.6265544807113457`*^9, 3.626554536358054*^9}, {
   3.626554568828652*^9, 3.626554576527622*^9}, {3.626554629812595*^9, 
   3.6265546727516403`*^9}, {3.626554806915536*^9, 3.626554824299451*^9}, {
   3.626554856611848*^9, 3.626554961138197*^9}, {3.626555172348421*^9, 
   3.6265552719830837`*^9}, {3.626555312865679*^9, 3.626555328429675*^9}, {
   3.6265553663496723`*^9, 3.626555368594121*^9}, {3.626555398711102*^9, 
   3.6265554046237297`*^9}, {3.626555559504929*^9, 3.626555563535729*^9}, {
   3.626555655884117*^9, 3.626555656803537*^9}, {3.626555786066968*^9, 
   3.6265558142616987`*^9}, {3.626555846277823*^9, 3.6265559132712297`*^9}, {
   3.626556589668818*^9, 3.626556592981584*^9}, {3.626568393900508*^9, 
   3.62656840180088*^9}, {3.626568473878531*^9, 3.626568483740808*^9}, {
   3.62656852866883*^9, 3.626568550441597*^9}, {3.626568618194077*^9, 
   3.6265686737823963`*^9}, {3.626569018541481*^9, 3.626569043368636*^9}, {
   3.626569114053425*^9, 3.6265691516313963`*^9}, {3.6265711015791388`*^9, 
   3.626571271456429*^9}, {3.626571437190466*^9, 3.626571554161909*^9}, {
   3.626571604115748*^9, 3.626571735204893*^9}, {3.6265718871817217`*^9, 
   3.626571936119207*^9}, {3.6265720422487288`*^9, 3.626572126844985*^9}, {
   3.626572216958506*^9, 3.626572224441061*^9}, {3.626572287333654*^9, 
   3.626572562416109*^9}, {3.626572593463114*^9, 3.6265727304316387`*^9}, {
   3.6265727619231243`*^9, 3.6265729526801558`*^9}, {3.626573023511723*^9, 
   3.6265730273065147`*^9}, {3.62657321972854*^9, 3.626573220440259*^9}, {
   3.6265733366957808`*^9, 3.6265734854753237`*^9}, {3.6265735684315367`*^9, 
   3.626573804580243*^9}, {3.626573851138712*^9, 3.626573857064762*^9}, {
   3.626573916963346*^9, 3.626573945676681*^9}, {3.626574008284854*^9, 
   3.62657401736162*^9}, {3.6265740495203257`*^9, 3.626574052369834*^9}, {
   3.626574222701734*^9, 3.626574238311934*^9}, {3.6265742940035143`*^9, 
   3.626574320002473*^9}, {3.626574355823399*^9, 3.626574358300021*^9}, {
   3.626574392752337*^9, 3.626574438157604*^9}, {3.626574499875148*^9, 
   3.626574532475075*^9}, {3.626574573089528*^9, 3.6265746566751328`*^9}, {
   3.626593130548572*^9, 3.626593188399254*^9}, {3.626593234516144*^9, 
   3.626593342925305*^9}, {3.626593440250779*^9, 3.626593483053865*^9}, {
   3.626593513478415*^9, 3.62659356331067*^9}, {3.6265936473630953`*^9, 
   3.626593656289846*^9}, {3.626593736731616*^9, 3.62659374086926*^9}, {
   3.626593789849949*^9, 3.6265937943349047`*^9}, {3.6265938334734173`*^9, 
   3.626593833881212*^9}, {3.626593897131957*^9, 3.626593908071059*^9}, {
   3.626594048861902*^9, 3.626594083048312*^9}, {3.626594148304172*^9, 
   3.6265941490790977`*^9}, {3.626637964689245*^9, 3.6266381609484043`*^9}, {
   3.626638210576344*^9, 3.626638264304435*^9}, {3.626638336487569*^9, 
   3.6266384389227057`*^9}, {3.626638481442849*^9, 3.626638483861987*^9}, {
   3.626638612686949*^9, 3.6266387919414062`*^9}, {3.6266389427639513`*^9, 
   3.626638963936874*^9}, {3.6266390063510933`*^9, 3.6266390134300003`*^9}, {
   3.626639067355668*^9, 3.626639099743084*^9}, {3.626639139355022*^9, 
   3.626639227218296*^9}, {3.626639522038683*^9, 3.6266395836843157`*^9}, {
   3.626639627221615*^9, 3.626639664032071*^9}, {3.626661211295536*^9, 
   3.62666121646611*^9}, {3.626662398958716*^9, 3.626662416517041*^9}, 
   3.626662480618464*^9, {3.626663205030604*^9, 3.6266632188184443`*^9}, {
   3.626663279303665*^9, 3.626663403556439*^9}, {3.626663449075514*^9, 
   3.626663523896679*^9}, {3.626663601348173*^9, 3.626663614239699*^9}, {
   3.626663661947886*^9, 3.6266636773273687`*^9}, {3.626663709905922*^9, 
   3.626663715381078*^9}, {3.626663749839757*^9, 3.626663772918182*^9}, {
   3.626663803530775*^9, 3.626663885931828*^9}, {3.626663945016883*^9, 
   3.6266639588597803`*^9}, {3.626664049956645*^9, 3.6266640633583183`*^9}, {
   3.6266667819905777`*^9, 3.626666782269909*^9}, {3.626666925294402*^9, 
   3.626666960312799*^9}, {3.626667066488109*^9, 3.626667135384852*^9}, {
   3.626667221407123*^9, 3.626667232501233*^9}, {3.6266683044020033`*^9, 
   3.6266684405469913`*^9}, {3.6266685608492527`*^9, 
   3.6266685764649553`*^9}, {3.62668433619118*^9, 3.626684365382452*^9}, {
   3.626684408832324*^9, 3.62668442138916*^9}, {3.628810837984379*^9, 
   3.628810858998353*^9}, {3.628812227754592*^9, 3.628812243376737*^9}, {
   3.628812279000063*^9, 3.628812307599038*^9}, {3.628812432151987*^9, 
   3.6288124342592907`*^9}, {3.628814238676564*^9, 3.6288142428659773`*^9}, {
   3.6288142759176407`*^9, 3.628814292570373*^9}, 3.6288145495807037`*^9, {
   3.633637956496497*^9, 3.6336379769052277`*^9}, {3.6336380366316233`*^9, 
   3.633638044203968*^9}, {3.63363811833147*^9, 3.6336381576927834`*^9}, {
   3.633638216357903*^9, 3.633638232218569*^9}, {3.6336386530761433`*^9, 
   3.633638679407381*^9}, {3.6336415475353127`*^9, 3.633641589865962*^9}, {
   3.6336416858038673`*^9, 3.633641728122698*^9}, {3.6339296707168617`*^9, 
   3.6339296879353*^9}, {3.633929800810156*^9, 3.633929801487317*^9}, {
   3.633983552272686*^9, 3.633983584642264*^9}, {3.6339837370074177`*^9, 
   3.633983740427642*^9}, {3.6339837768983803`*^9, 3.6339837863309717`*^9}, {
   3.633983848132296*^9, 3.633983882256023*^9}, {3.6339841175309477`*^9, 
   3.63398412756986*^9}, {3.633984167009632*^9, 3.633984193292431*^9}, {
   3.6339842745726843`*^9, 3.633984283702821*^9}, {3.633984317758466*^9, 
   3.633984332104476*^9}, 3.6339848425811777`*^9, {3.633984878467635*^9, 
   3.633984892536498*^9}, 3.6339850197502623`*^9, {3.633985782524747*^9, 
   3.633985798704918*^9}, {3.639105370765524*^9, 3.63910541954425*^9}, {
   3.639105698178857*^9, 3.639105698417807*^9}, {3.6391058420376377`*^9, 
   3.6391058437577753`*^9}, {3.639871381288702*^9, 3.639871438822929*^9}, {
   3.6398714767221212`*^9, 3.63987155647968*^9}, 3.639872083671047*^9, {
   3.639872132090272*^9, 3.639872133681438*^9}, {3.639872184093834*^9, 
   3.639872233327273*^9}, {3.639872274396006*^9, 3.639872277817254*^9}, {
   3.639872316463813*^9, 3.639872321207398*^9}, {3.639872361537918*^9, 
   3.639872364962001*^9}, {3.639872580030266*^9, 3.639872620845653*^9}, {
   3.6398726569027977`*^9, 3.639872708905781*^9}, {3.639872868245144*^9, 
   3.6398728726131973`*^9}, {3.639873451038656*^9, 3.639873477971633*^9}, {
   3.6398735579241056`*^9, 3.639873563392684*^9}, {3.639873685088542*^9, 
   3.63987368559265*^9}, {3.6398737740498533`*^9, 3.639873776267565*^9}, {
   3.639873814810979*^9, 3.6398738176359777`*^9}, {3.639874737011455*^9, 
   3.639874749817527*^9}, {3.640656780821944*^9, 3.640656805784215*^9}, {
   3.6406599799759693`*^9, 3.64065998205444*^9}, {3.640660046012197*^9, 
   3.6406600590886993`*^9}, {3.640660486617469*^9, 3.640660690280396*^9}, {
   3.6406607454550323`*^9, 3.640660754704625*^9}, {3.6406608393806057`*^9, 
   3.640660851714718*^9}, {3.640660891410697*^9, 3.640660909579733*^9}, {
   3.640727638249385*^9, 3.640727664022129*^9}, {3.640727706404687*^9, 
   3.640727718246502*^9}, {3.6407278632978163`*^9, 3.640727873388116*^9}, {
   3.640728211203786*^9, 3.640728220267435*^9}, {3.640728874516303*^9, 
   3.640728933412264*^9}, {3.640729450349597*^9, 3.6407295081183863`*^9}, 
   3.640729541401555*^9, {3.6453961129036694`*^9, 3.6453961168614264`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"KhC", "[", 
      RowBox[{"BraidMovie", "[", 
       RowBox[{"braid_", ",", 
        RowBox[{"{", 
         RowBox[{"MysteryDiagonalb", "[", 
          RowBox[{"offset_", ",", "minGenerator_", ",", "\"\<L\>\"", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "1", ",", 
             RowBox[{"-", "1"}]}], "}"}], ",", "\[Alpha]_"}], "]"}], "}"}]}], 
       "]"}], "]"}], "[", "v_BasisVector", "]"}], " ", ":=", " ", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"grading", "=", 
         RowBox[{"Bigrading", "[", "v", "]"}]}], ",", "\[IndentingNewLine]", 
        "target", ",", "\[IndentingNewLine]", 
        RowBox[{"difGrading", "=", 
         RowBox[{"Bigrading", "[", 
          RowBox[{"Differential", "[", "v", "]"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"v", "\[LeftDoubleBracket]", 
          RowBox[{"1", ",", "2", ",", 
           RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}], 
         "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
          RowBox[{"Print", "[", 
           RowBox[{
           "\"\<Rejecting \>\"", ",", "v", ",", 
            "\"\< because it's in the wrong layer\>\""}], "]"}], ";"}], 
         "*)"}], "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"v", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "2", ",", 
             RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
           "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
             "\"\<Rejecting \>\"", ",", "v", ",", 
              "\"\< because wrong resolution\>\""}], "]"}], ";"}], "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"v", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
             RowBox[{
              RowBox[{"target", "=", 
               RowBox[{"AllBasisVectorsInGrading", "[", 
                RowBox[{
                 RowBox[{"FinalBraid", "[", 
                  RowBox[{"braid", ",", 
                   RowBox[{"R3", "[", 
                    RowBox[{
                    "offset", ",", "minGenerator", ",", "\"\<L\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
                 RowBox[{
                 "grading", "\[LeftDoubleBracket]", "1", 
                  "\[RightDoubleBracket]"}], ",", 
                 RowBox[{
                 "grading", "\[LeftDoubleBracket]", "2", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"Sum", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"\[Alpha]", "[", 
                  RowBox[{"v", ",", "w"}], "]"}], "w"}], ",", 
                RowBox[{"{", 
                 RowBox[{"w", ",", "target"}], "}"}]}], "]"}]}]}], "]"}], 
           "\[IndentingNewLine]", "0"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"target", "=", 
            RowBox[{"AllBasisVectorsInGrading", "[", 
             RowBox[{
              RowBox[{"FinalBraid", "[", 
               RowBox[{"braid", ",", 
                RowBox[{"R3", "[", 
                 RowBox[{"offset", ",", "minGenerator", ",", "\"\<L\>\"", ",", 
                  RowBox[{"{", 
                   RowBox[{"1", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
              RowBox[{
              "grading", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}], ",", 
              RowBox[{
              "grading", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{"\"\<target: \>\"", ",", "target"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"target", "=", 
              RowBox[{"Cases", "[", 
               RowBox[{"target", ",", 
                RowBox[{"n_", "/;", 
                 RowBox[{
                  RowBox[{"n", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                  "\[Equal]", 
                  RowBox[{"{", 
                   RowBox[{"0", ",", "1", ",", 
                    RowBox[{"v", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"offset", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}]}], "]"}]}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", 
            RowBox[{
             RowBox[{"Print", "[", 
              RowBox[{
               RowBox[{"v", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2", ",", 
                 RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
               ",", "\"\<newtarget: \>\"", ",", "target"}], "]"}], ";"}], 
            "*)"}], "\[IndentingNewLine]", 
           RowBox[{"(*", " ", 
            RowBox[{"To", " ", 
             RowBox[{"do", ":", " ", 
              RowBox[{
              "make", " ", "sure", " ", "crosings", " ", "outside", " ", "of",
                " ", "R3", " ", "have", " ", "same", " ", "resolution", " ", 
               "\[IndentingNewLine]", "\t\t", "make", " ", "sure", " ", 
               "circles", " ", "which", " ", 
               RowBox[{"don", "'"}], "t", " ", "interact", " ", "with", " ", 
               "R3", " ", "move", " ", "have", " ", "same", " ", "sign", 
               "\[IndentingNewLine]", "\t\t\t", "check", " ", "that", " ", 
               "v", " ", "is", " ", "one", " ", "of", " ", "the", " ", "two", 
               " ", "that", " ", "is", " ", "sent", " ", "to", " ", 
               "something", " ", "not", " ", "zero"}]}]}], " ", "*)"}], 
           "\[IndentingNewLine]", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Alpha]", "[", 
               RowBox[{"v", ",", "w"}], "]"}], "w"}], ",", 
             RowBox[{"{", 
              RowBox[{"w", ",", "target"}], "}"}]}], "]"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<sum: \>\"", ",", "sum"}], "]"}], ";"}], "*)"}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]"}]], "Input",\

 CellChangeTimes->{{3.626039310293188*^9, 3.626039420604514*^9}, {
   3.626039494687175*^9, 3.626039626529912*^9}, {3.626039737222796*^9, 
   3.6260398806067343`*^9}, {3.626039939328808*^9, 3.626039956837266*^9}, {
   3.626040268667762*^9, 3.626040272313695*^9}, {3.626040467610284*^9, 
   3.6260405517272377`*^9}, {3.626040656730877*^9, 3.626040723737152*^9}, {
   3.6260451367146673`*^9, 3.626045153876486*^9}, {3.626045221549035*^9, 
   3.626045223915928*^9}, {3.626045389372843*^9, 3.626045399644928*^9}, {
   3.6260472319744177`*^9, 3.626047294657329*^9}, {3.626047352586693*^9, 
   3.626047366122913*^9}, {3.6260474331173687`*^9, 3.626047461501028*^9}, {
   3.6260475068069344`*^9, 3.6260475353976307`*^9}, {3.626047571798642*^9, 
   3.626047626533927*^9}, {3.6260476573088503`*^9, 3.626047687288591*^9}, {
   3.626047725743753*^9, 3.6260477406257877`*^9}, {3.626047774295879*^9, 
   3.6260478942626257`*^9}, {3.626047982809642*^9, 3.62604825135879*^9}, {
   3.6260482857809677`*^9, 3.626048287732545*^9}, {3.626048361939424*^9, 
   3.626048412697309*^9}, {3.6260484623682957`*^9, 3.6260484828799686`*^9}, {
   3.6260485162471333`*^9, 3.626048609981007*^9}, {3.626048665236088*^9, 
   3.6260486837822237`*^9}, {3.6260491027456207`*^9, 
   3.6260491499905024`*^9}, {3.626049432928586*^9, 3.626049586659687*^9}, {
   3.626049648383903*^9, 3.626049764538356*^9}, {3.62604980477514*^9, 
   3.6260498428088827`*^9}, {3.6260498798571873`*^9, 
   3.6260500137000523`*^9}, {3.626050114671917*^9, 3.626050162681761*^9}, 
   3.626050205303986*^9, {3.626050265365798*^9, 3.6260503173996153`*^9}, {
   3.626050359800722*^9, 3.626050410826453*^9}, {3.626050557030972*^9, 
   3.626050724975048*^9}, {3.626050803884946*^9, 3.62605080714223*^9}, {
   3.626051114496583*^9, 3.626051186807418*^9}, {3.6260512407606*^9, 
   3.626051272272434*^9}, {3.6260513522793427`*^9, 3.626051425007037*^9}, {
   3.626051514009706*^9, 3.6260515153197737`*^9}, {3.6260515584951887`*^9, 
   3.626051578358694*^9}, {3.6260517257839413`*^9, 3.626051753010272*^9}, {
   3.62605181782414*^9, 3.6260518976844587`*^9}, {3.626051979400413*^9, 
   3.62605197983742*^9}, {3.6260521100586767`*^9, 3.626052114513793*^9}, {
   3.626052185588328*^9, 3.626052225660759*^9}, {3.6260523099952517`*^9, 
   3.6260523553187227`*^9}, {3.626052404310768*^9, 3.6260524690302153`*^9}, {
   3.626052604833259*^9, 3.626052677317821*^9}, {3.626052746994711*^9, 
   3.626052820783352*^9}, 3.626052861089592*^9, 3.626058252850823*^9, {
   3.626132328563308*^9, 3.62613241904563*^9}, {3.626381224072734*^9, 
   3.626381282410317*^9}, {3.626381327657401*^9, 3.6263813431862383`*^9}, {
   3.626381418137211*^9, 3.6263814540738153`*^9}, {3.626393769780141*^9, 
   3.6263938271860123`*^9}, {3.62639728891212*^9, 3.626397320786067*^9}, {
   3.6263973563842077`*^9, 3.6263973729100924`*^9}, {3.62639749148567*^9, 
   3.626397492533677*^9}, 3.6263975709499197`*^9, {3.626397604492444*^9, 
   3.626397690574881*^9}, {3.6263977568160057`*^9, 3.626397830712426*^9}, {
   3.626398466949581*^9, 3.6263985082985897`*^9}, {3.626398561533675*^9, 
   3.626398583166236*^9}, {3.626398641836988*^9, 3.626398705765437*^9}, {
   3.6263988814964247`*^9, 3.626398922875511*^9}, {3.626553722675852*^9, 
   3.626553756200717*^9}, {3.626553806951631*^9, 3.626553812542377*^9}, {
   3.626553845653194*^9, 3.626553849896564*^9}, {3.626553895339149*^9, 
   3.626553931485132*^9}, {3.626553979818534*^9, 3.626554005773056*^9}, {
   3.626554036490879*^9, 3.6265541382488537`*^9}, {3.626554214682191*^9, 
   3.626554223718918*^9}, {3.6265542558857317`*^9, 3.6265542588679247`*^9}, {
   3.6265543200977383`*^9, 3.6265543300865726`*^9}, {3.626554427257626*^9, 
   3.626554427387848*^9}, {3.6265544807113457`*^9, 3.626554536358054*^9}, {
   3.626554568828652*^9, 3.626554576527622*^9}, {3.626554629812595*^9, 
   3.6265546727516403`*^9}, {3.626554806915536*^9, 3.626554824299451*^9}, {
   3.626554856611848*^9, 3.626554961138197*^9}, {3.626555172348421*^9, 
   3.6265552719830837`*^9}, {3.626555312865679*^9, 3.626555328429675*^9}, {
   3.6265553663496723`*^9, 3.626555368594121*^9}, {3.626555398711102*^9, 
   3.6265554046237297`*^9}, {3.626555559504929*^9, 3.626555563535729*^9}, {
   3.626555655884117*^9, 3.626555656803537*^9}, {3.626555786066968*^9, 
   3.6265558142616987`*^9}, {3.626555846277823*^9, 3.6265559132712297`*^9}, {
   3.626556589668818*^9, 3.626556592981584*^9}, {3.626568393900508*^9, 
   3.62656840180088*^9}, {3.626568473878531*^9, 3.626568483740808*^9}, {
   3.62656852866883*^9, 3.626568550441597*^9}, {3.626568618194077*^9, 
   3.6265686737823963`*^9}, {3.626569018541481*^9, 3.626569043368636*^9}, {
   3.6344125489007196`*^9, 3.634412586040042*^9}, {3.634412617458548*^9, 
   3.634412619320573*^9}, {3.634412681776305*^9, 3.6344126868363523`*^9}, {
   3.634412733465604*^9, 3.634412734384796*^9}, {3.634413109876515*^9, 
   3.6344131110888433`*^9}, {3.634413601761932*^9, 3.634413730012134*^9}, {
   3.634413878576951*^9, 3.634413900686021*^9}, {3.634413958975047*^9, 
   3.6344140753918552`*^9}, 3.634414115452326*^9, {3.634415098917081*^9, 
   3.634415201999086*^9}, {3.63441524957821*^9, 3.634415327472439*^9}, {
   3.634415682732997*^9, 3.634415686576928*^9}, {3.634415775603532*^9, 
   3.634415778717784*^9}, {3.634415826914336*^9, 3.634415840802957*^9}, {
   3.6344159960327272`*^9, 3.634416013042636*^9}, {3.634435601055138*^9, 
   3.6344356280297728`*^9}, {3.6344357577697983`*^9, 3.634435833163611*^9}, {
   3.634435990178029*^9, 3.634436007265275*^9}, {3.634436066178914*^9, 
   3.634436090376171*^9}, {3.634436127074337*^9, 3.634436140497799*^9}, {
   3.6344361871817207`*^9, 3.634436190128399*^9}, {3.634436634982934*^9, 
   3.6344366674429407`*^9}, {3.634436704019785*^9, 3.634436713462029*^9}, {
   3.634437566957077*^9, 3.634437567279975*^9}, {3.634437756640975*^9, 
   3.634437772932404*^9}, {3.634437940030693*^9, 3.634437940970057*^9}, {
   3.634438182902392*^9, 3.634438216818058*^9}, {3.634502967633691*^9, 
   3.634502969491803*^9}, {3.634503064936857*^9, 3.634503122755383*^9}, {
   3.6345031585061207`*^9, 3.6345032391695013`*^9}, {3.6345255908928547`*^9, 
   3.6345255955251617`*^9}, {3.634525631682376*^9, 3.634525717933487*^9}, {
   3.6345258642988873`*^9, 3.634525872490301*^9}, {3.634525918370387*^9, 
   3.634525981519938*^9}, {3.63452604369407*^9, 3.634526046894421*^9}, {
   3.6345279076958933`*^9, 3.634527915222108*^9}, {3.6345280071791887`*^9, 
   3.634528011582254*^9}, {3.634528055361178*^9, 3.634528075945795*^9}, {
   3.634528125475028*^9, 3.634528182665716*^9}, {3.636746081977428*^9, 
   3.636746100606353*^9}, {3.636747322732871*^9, 3.636747336118004*^9}, {
   3.636747651203762*^9, 3.6367476568146267`*^9}, {3.636748071899227*^9, 
   3.636748153968165*^9}, {3.6367503432344103`*^9, 3.636750357279643*^9}, {
   3.636750554690322*^9, 3.636750562083169*^9}, {3.636750652183441*^9, 
   3.636750656670525*^9}, 3.636750699135872*^9, {3.637437458407772*^9, 
   3.637437459410817*^9}, {3.637444867783156*^9, 3.637444873059494*^9}, {
   3.6374458789109583`*^9, 3.637445881005055*^9}, {3.637446284468092*^9, 
   3.6374462998573437`*^9}, {3.6374463405483227`*^9, 
   3.6374463470216923`*^9}, {3.6374468510952053`*^9, 3.637446854197013*^9}, {
   3.637446924156143*^9, 3.6374469257853823`*^9}, {3.640655147150276*^9, 
   3.640655149610505*^9}, {3.640655377149044*^9, 3.640655378036927*^9}, {
   3.640656449869235*^9, 3.6406564502831182`*^9}, {3.640656872956559*^9, 
   3.640656873681917*^9}, {3.640656913181575*^9, 3.640656915918788*^9}, {
   3.6406573757320213`*^9, 3.640657376050128*^9}, {3.64539610311909*^9, 
   3.645396105726364*^9}, {3.645842959006296*^9, 3.64584297940679*^9}, {
   3.645843059151133*^9, 3.6458431112297773`*^9}, {3.6458432652699537`*^9, 
   3.645843319271865*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"KhC", "[", 
     RowBox[{"BraidMovie", "[", 
      RowBox[{"braid_", ",", 
       RowBox[{"{", 
        RowBox[{"MysteryDiagonalb", "[", 
         RowBox[{"offset_", ",", "minGenerator_", ",", "\"\<R\>\"", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}], ",", 
          "\[Alpha]_"}], "]"}], "}"}]}], "]"}], "]"}], "[", "v_BasisVector", 
    "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"grading", "=", 
        RowBox[{"Bigrading", "[", "v", "]"}]}], ",", "\[IndentingNewLine]", 
       "target", ",", "\[IndentingNewLine]", 
       RowBox[{"difGrading", "=", 
        RowBox[{"Bigrading", "[", 
         RowBox[{"Differential", "[", "v", "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"v", "\[LeftDoubleBracket]", 
         RowBox[{"1", ",", "2", ",", 
          RowBox[{"offset", "+", "2"}]}], "\[RightDoubleBracket]"}], 
        "\[NotEqual]", "0"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", 
          RowBox[{
          "\"\<Rejecting \>\"", ",", "v", ",", 
           "\"\< because it's in the wrong layer\>\""}], "]"}], ";"}], "*)"}],
        "\[IndentingNewLine]", "0", ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"v", "\[LeftDoubleBracket]", 
           RowBox[{"1", ",", "2", ",", 
            RowBox[{"offset", "+", "3"}]}], "\[RightDoubleBracket]"}], 
          "\[NotEqual]", "1"}], ",", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"Print", "[", 
            RowBox[{
            "\"\<Rejecting \>\"", ",", "v", ",", 
             "\"\< because wrong resolution\>\""}], "]"}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"v", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
           RowBox[{
            RowBox[{"target", "=", 
             RowBox[{"{", 
              RowBox[{"findCircles", "[", 
               RowBox[{"v", ",", 
                RowBox[{"FinalBraid", "[", 
                 RowBox[{"braid", ",", 
                  RowBox[{"R3", "[", 
                   RowBox[{
                   "offset", ",", "minGenerator", ",", "\"\<L\>\"", ",", 
                    RowBox[{"{", 
                    RowBox[{"1", ",", "1", ",", 
                    RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], "]"}], ",", 
                "offset"}], "]"}], "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"\[Alpha]", "[", 
                RowBox[{"v", ",", "w"}], "]"}], "w"}], ",", 
              RowBox[{"{", 
               RowBox[{"w", ",", "target"}], "}"}]}], "]"}]}], ",", 
           "\[IndentingNewLine]", "0"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"target", "=", 
           RowBox[{"AllBasisVectorsInGrading", "[", 
            RowBox[{
             RowBox[{"FinalBraid", "[", 
              RowBox[{"braid", ",", 
               RowBox[{"R3", "[", 
                RowBox[{
                "offset", ",", "minGenerator", ",", "\"\<R\>\"", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}]}],
               "]"}], ",", 
             RowBox[{
             "grading", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], ",", 
             RowBox[{
             "grading", "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{"\"\<target: \>\"", ",", "target"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"target", "=", 
             RowBox[{"Cases", "[", 
              RowBox[{"target", ",", 
               RowBox[{"n_", "/;", 
                RowBox[{
                 RowBox[{"n", "\[LeftDoubleBracket]", 
                  RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], 
                 "\[Equal]", 
                 RowBox[{"{", 
                  RowBox[{"0", ",", "1", ",", 
                   RowBox[{"v", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2", ",", 
                    RowBox[{"offset", "+", "1"}]}], 
                    "\[RightDoubleBracket]"}]}], "}"}]}]}]}], "]"}]}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{
            RowBox[{"Print", "[", 
             RowBox[{
              RowBox[{"v", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", "2", ",", 
                RowBox[{"offset", "+", "1"}]}], "\[RightDoubleBracket]"}], 
              ",", "\"\<newtarget: \>\"", ",", "target"}], "]"}], ";"}], 
           "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", " ", 
           RowBox[{"To", " ", 
            RowBox[{"do", ":", " ", 
             RowBox[{
             "make", " ", "sure", " ", "crosings", " ", "outside", " ", "of", 
              " ", "R3", " ", "have", " ", "same", " ", "resolution", " ", 
              "\[IndentingNewLine]", "\t\t", "make", " ", "sure", " ", 
              "circles", " ", "which", " ", 
              RowBox[{"don", "'"}], "t", " ", "interact", " ", "with", " ", 
              "R3", " ", "move", " ", "have", " ", "same", " ", "sign", 
              "\[IndentingNewLine]", "\t\t\t", "check", " ", "that", " ", "v",
               " ", "is", " ", "one", " ", "of", " ", "the", " ", "two", " ", 
              "that", " ", "is", " ", "sent", " ", "to", " ", "something", 
              " ", "not", " ", "zero"}]}]}], " ", "*)"}], 
          "\[IndentingNewLine]", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"\[Alpha]", "[", 
              RowBox[{"v", ",", "w"}], "]"}], "w"}], ",", 
            RowBox[{"{", 
             RowBox[{"w", ",", "target"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"findCircles", "[", 
     RowBox[{
      RowBox[{"v", ":", 
       RowBox[{"BasisVector", "[", 
        RowBox[{
         RowBox[{"Resolution", "[", 
          RowBox[{"braid_", ",", "resolution_", ",", "circles_"}], "]"}], ",",
          "signs_"}], "]"}]}], ",", "newBraid_", ",", "offset_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "changeSigns", ",", "oldSigns", ",", " ", "newSigns", ",", "image"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"image", "=", 
        RowBox[{"Resolution", "[", 
         RowBox[{"newBraid", ",", 
          RowBox[{"ReplacePart", "[", 
           RowBox[{
            RowBox[{"v", "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"offset", "+", "1"}], "\[Rule]", "1"}], ",", 
              RowBox[{
               RowBox[{"offset", "+", "2"}], "\[Rule]", "0"}], ",", 
              RowBox[{
               RowBox[{"offset", "+", "3"}], "\[Rule]", "1"}]}], "}"}]}], 
           "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "Change", " ", "to", " ", "just", " ", "delete", " ", "relevant", 
          " ", "circles"}], ",", " ", 
         RowBox[{
         "replace", " ", "later", " ", "with", " ", "any", " ", "circles", 
          " ", "in", " ", "image", " ", "that", " ", "are", " ", "missing"}], 
         ",", " ", 
         RowBox[{"determine", " ", "signs"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"changeSigns", "=", 
        RowBox[{"Cases", "[", 
         RowBox[{"signs", ",", 
          RowBox[{"n_", "/;", 
           RowBox[{
            RowBox[{"Intersection", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"4", "*", "offset"}], "+", 
               RowBox[{"Range", "[", "12", "]"}]}], ",", "n"}], "]"}], 
            "\[NotEqual]", 
            RowBox[{"{", "}"}]}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Position", "[", 
             RowBox[{
              RowBox[{
              "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}],
               ",", 
              RowBox[{
              "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             "]"}], "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "&"}], "/@",
          "newCircles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"Print", "[", "newCircles", "]"}], ";"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"newCircles", "=", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
           "image", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}], 
           "\[LeftDoubleBracket]", "#", "\[RightDoubleBracket]"}], "&"}], "/@",
          "newCircles"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"oldSigns", "=", 
        RowBox[{"circles", "/.", "signs"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"newSigns", "=", 
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"#1", "\[Rule]", "#2"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{"newCircles", ",", "oldSigns"}], "}"}]}], "]"}]}], ";"}]}],
      "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeeMovieChainMapCondition", "[", 
   RowBox[{"m_BraidMovie", ",", "v_BasisVector"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"difference", ",", "vectors"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"difference", "=", 
      RowBox[{"Collect", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"KhC", "[", "m", "]"}], "[", 
          RowBox[{"LeeDifferential", "[", "v", "]"}], "]"}], "-", 
         RowBox[{"LeeDifferential", "[", 
          RowBox[{
           RowBox[{"KhC", "[", "m", "]"}], "[", "v", "]"}], "]"}]}], ",", 
        "_BasisVector"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<v: \>\"", ",", "v"}], "]"}], ";", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<difference: \>\"", ",", "difference"}], "]"}], ";"}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"vectors", "=", 
      RowBox[{"Union", "[", 
       RowBox[{"Cases", "[", 
        RowBox[{"difference", ",", "_BasisVector", ",", "\[Infinity]"}], 
        "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"\"\<vectors: \>\"", ",", "vectors"}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<coeffs: \>\"", ",", 
         RowBox[{
          RowBox[{
           RowBox[{"Coefficient", "[", 
            RowBox[{"difference", ",", "#"}], "]"}], "&"}], "/@", 
          "vectors"}]}], "]"}], ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"\[Alpha]Solve", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"Coefficient", "[", 
              RowBox[{"difference", ",", "#"}], "]"}], "&"}], "/@", 
            "vectors"}], "\[Equal]", "0"}], ",", "\[Alpha]"}], "]"}], 
        "\[Equal]", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"Print", "[", 
        RowBox[{"\"\<Problem v: \>\"", ",", "v"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{"difference", ",", "#"}], "]"}], "&"}], "/@", "vectors"}]}]}],
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeeMovieChainMapCondition", "[", 
   RowBox[{"m_BraidMovie", ",", "s_Integer", ",", " ", "r_Integer"}], "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"LeeMovieChainMapCondition", "[", 
      RowBox[{"m", ",", "#"}], "]"}], "&"}], "/@", 
    RowBox[{"AllBasisVectorsInGrading", "[", 
     RowBox[{
      RowBox[{"Still", "[", 
       RowBox[{"m", ",", "0"}], "]"}], ",", "s", ",", "r"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LeeMovieChainMapCondition", "[", "m_BraidMovie", "]"}], ":=", 
  RowBox[{"Flatten", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"LeeMovieChainMapCondition", "[", 
      RowBox[{"m", ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       ",", 
       RowBox[{"#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
      "]"}], "&"}], "/@", 
    RowBox[{"AllBigradings", "[", 
     RowBox[{"Still", "[", 
      RowBox[{"m", ",", "0"}], "]"}], "]"}]}], 
   "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.626039310293188*^9, 3.626039420604514*^9}, {
   3.626039494687175*^9, 3.626039626529912*^9}, {3.626039737222796*^9, 
   3.6260398806067343`*^9}, {3.626039939328808*^9, 3.626039956837266*^9}, {
   3.626040268667762*^9, 3.626040272313695*^9}, {3.626040467610284*^9, 
   3.6260405517272377`*^9}, {3.626040656730877*^9, 3.626040723737152*^9}, {
   3.6260451367146673`*^9, 3.626045153876486*^9}, {3.626045221549035*^9, 
   3.626045223915928*^9}, {3.626045389372843*^9, 3.626045399644928*^9}, {
   3.6260472319744177`*^9, 3.626047294657329*^9}, {3.626047352586693*^9, 
   3.626047366122913*^9}, {3.6260474331173687`*^9, 3.626047461501028*^9}, {
   3.6260475068069344`*^9, 3.6260475353976307`*^9}, {3.626047571798642*^9, 
   3.626047626533927*^9}, {3.6260476573088503`*^9, 3.626047687288591*^9}, {
   3.626047725743753*^9, 3.6260477406257877`*^9}, {3.626047774295879*^9, 
   3.6260478942626257`*^9}, {3.626047982809642*^9, 3.62604825135879*^9}, {
   3.6260482857809677`*^9, 3.626048287732545*^9}, {3.626048361939424*^9, 
   3.626048412697309*^9}, {3.6260484623682957`*^9, 3.6260484828799686`*^9}, {
   3.6260485162471333`*^9, 3.626048609981007*^9}, {3.626048665236088*^9, 
   3.6260486837822237`*^9}, {3.6260491027456207`*^9, 
   3.6260491499905024`*^9}, {3.626049432928586*^9, 3.626049586659687*^9}, {
   3.626049648383903*^9, 3.626049764538356*^9}, {3.62604980477514*^9, 
   3.6260498428088827`*^9}, {3.6260498798571873`*^9, 
   3.6260500137000523`*^9}, {3.626050114671917*^9, 3.626050162681761*^9}, 
   3.626050205303986*^9, {3.626050265365798*^9, 3.6260503173996153`*^9}, {
   3.626050359800722*^9, 3.626050410826453*^9}, {3.626050557030972*^9, 
   3.626050724975048*^9}, {3.626050803884946*^9, 3.62605080714223*^9}, {
   3.626051114496583*^9, 3.626051186807418*^9}, {3.6260512407606*^9, 
   3.626051272272434*^9}, {3.6260513522793427`*^9, 3.626051425007037*^9}, {
   3.626051514009706*^9, 3.6260515153197737`*^9}, {3.6260515584951887`*^9, 
   3.626051578358694*^9}, {3.6260517257839413`*^9, 3.626051753010272*^9}, {
   3.62605181782414*^9, 3.6260518976844587`*^9}, {3.626051979400413*^9, 
   3.62605197983742*^9}, {3.6260521100586767`*^9, 3.626052114513793*^9}, {
   3.626052185588328*^9, 3.626052225660759*^9}, {3.6260523099952517`*^9, 
   3.6260523553187227`*^9}, {3.626052404310768*^9, 3.6260524690302153`*^9}, {
   3.626052604833259*^9, 3.626052677317821*^9}, {3.626052746994711*^9, 
   3.626052820783352*^9}, 3.626052861089592*^9, 3.626058252850823*^9, {
   3.626132328563308*^9, 3.62613241904563*^9}, {3.626381224072734*^9, 
   3.626381282410317*^9}, {3.626381327657401*^9, 3.6263813431862383`*^9}, {
   3.626381418137211*^9, 3.6263814540738153`*^9}, {3.626393769780141*^9, 
   3.6263938271860123`*^9}, {3.62639728891212*^9, 3.626397320786067*^9}, {
   3.6263973563842077`*^9, 3.6263973729100924`*^9}, {3.62639749148567*^9, 
   3.626397492533677*^9}, 3.6263975709499197`*^9, {3.626397604492444*^9, 
   3.626397690574881*^9}, {3.6263977568160057`*^9, 3.626397830712426*^9}, {
   3.626398466949581*^9, 3.6263985082985897`*^9}, {3.626398561533675*^9, 
   3.626398583166236*^9}, {3.626398641836988*^9, 3.626398705765437*^9}, {
   3.6263988814964247`*^9, 3.626398922875511*^9}, {3.626553722675852*^9, 
   3.626553756200717*^9}, {3.626553806951631*^9, 3.626553812542377*^9}, {
   3.626553845653194*^9, 3.626553849896564*^9}, {3.626553895339149*^9, 
   3.626553931485132*^9}, {3.626553979818534*^9, 3.626554005773056*^9}, {
   3.626554036490879*^9, 3.6265541382488537`*^9}, {3.626554214682191*^9, 
   3.626554223718918*^9}, {3.6265542558857317`*^9, 3.6265542588679247`*^9}, {
   3.6265543200977383`*^9, 3.6265543300865726`*^9}, {3.626554427257626*^9, 
   3.626554427387848*^9}, {3.6265544807113457`*^9, 3.626554536358054*^9}, {
   3.626554568828652*^9, 3.626554576527622*^9}, {3.626554629812595*^9, 
   3.6265546727516403`*^9}, {3.626554806915536*^9, 3.626554824299451*^9}, {
   3.626554856611848*^9, 3.626554961138197*^9}, {3.626555172348421*^9, 
   3.6265552719830837`*^9}, {3.626555312865679*^9, 3.626555328429675*^9}, {
   3.6265553663496723`*^9, 3.626555368594121*^9}, {3.626555398711102*^9, 
   3.6265554046237297`*^9}, {3.626555559504929*^9, 3.626555563535729*^9}, {
   3.626555655884117*^9, 3.626555656803537*^9}, {3.626555786066968*^9, 
   3.6265558142616987`*^9}, {3.626555846277823*^9, 3.6265559132712297`*^9}, {
   3.626556589668818*^9, 3.626556592981584*^9}, {3.626568393900508*^9, 
   3.62656840180088*^9}, {3.626568473878531*^9, 3.626568483740808*^9}, {
   3.62656852866883*^9, 3.626568550441597*^9}, {3.626568618194077*^9, 
   3.6265686737823963`*^9}, {3.626569018541481*^9, 3.626569043368636*^9}, {
   3.6344125489007196`*^9, 3.634412586040042*^9}, {3.634412617458548*^9, 
   3.634412619320573*^9}, {3.634412681776305*^9, 3.6344126868363523`*^9}, {
   3.634412733465604*^9, 3.634412734384796*^9}, {3.634413109876515*^9, 
   3.6344131110888433`*^9}, {3.634413601761932*^9, 3.634413730012134*^9}, {
   3.634413878576951*^9, 3.634413900686021*^9}, {3.634413958975047*^9, 
   3.6344140753918552`*^9}, 3.634414115452326*^9, {3.634415098917081*^9, 
   3.634415201999086*^9}, {3.63441524957821*^9, 3.634415327472439*^9}, {
   3.634415682732997*^9, 3.634415686576928*^9}, {3.634415775603532*^9, 
   3.634415778717784*^9}, {3.634415826914336*^9, 3.634415840802957*^9}, {
   3.6344159960327272`*^9, 3.634416013042636*^9}, {3.634435601055138*^9, 
   3.6344356280297728`*^9}, {3.6344357577697983`*^9, 3.634435833163611*^9}, {
   3.634435990178029*^9, 3.634436007265275*^9}, {3.634436066178914*^9, 
   3.634436090376171*^9}, {3.634436127074337*^9, 3.634436140497799*^9}, {
   3.6344361871817207`*^9, 3.634436190128399*^9}, {3.634436634982934*^9, 
   3.6344366674429407`*^9}, {3.634436704019785*^9, 3.634436713462029*^9}, {
   3.634437566957077*^9, 3.634437567279975*^9}, {3.634437756640975*^9, 
   3.634437772932404*^9}, {3.634437940030693*^9, 3.634437940970057*^9}, {
   3.634438182902392*^9, 3.634438216818058*^9}, {3.634502967633691*^9, 
   3.634502969491803*^9}, {3.634503064936857*^9, 3.634503122755383*^9}, {
   3.6345031585061207`*^9, 3.6345032391695013`*^9}, {3.6345255908928547`*^9, 
   3.6345255955251617`*^9}, {3.634525631682376*^9, 3.634525717933487*^9}, {
   3.6345258642988873`*^9, 3.634525872490301*^9}, {3.634525918370387*^9, 
   3.634525981519938*^9}, {3.63452604369407*^9, 3.634526046894421*^9}, {
   3.6345279076958933`*^9, 3.634527915222108*^9}, {3.6345280071791887`*^9, 
   3.634528011582254*^9}, {3.634528055361178*^9, 3.634528075945795*^9}, {
   3.634528125475028*^9, 3.634528182665716*^9}, {3.636746081977428*^9, 
   3.636746100606353*^9}, {3.636747340100164*^9, 3.636747381694971*^9}, {
   3.637437483933962*^9, 3.637437490912734*^9}, {3.637438134797202*^9, 
   3.637438167660727*^9}, 3.63744487529524*^9, {3.637705255368657*^9, 
   3.637705256463852*^9}, {3.638782908162039*^9, 3.638782912917576*^9}, {
   3.639096414126979*^9, 3.639096415125503*^9}, {3.639818250731658*^9, 
   3.639818256466803*^9}, 3.645391362274221*^9, 3.6453958486137*^9, {
   3.645395881565393*^9, 3.645395904893261*^9}, {3.645396055434518*^9, 
   3.6453960985686903`*^9}, {3.6453963797644987`*^9, 3.645396388283266*^9}, {
   3.645842781749984*^9, 3.645842819685763*^9}, {3.645842866390916*^9, 
   3.645842901917811*^9}, {3.6458431531645317`*^9, 3.6458431540280943`*^9}, {
   3.645843308632999*^9, 3.6458433581353483`*^9}, {3.645843622005905*^9, 
   3.645843624382771*^9}, {3.645843833980319*^9, 3.645843875849798*^9}, {
   3.6458439066632557`*^9, 3.6458440024424133`*^9}, {3.645844079800427*^9, 
   3.645844189093111*^9}, {3.6458442194723186`*^9, 3.645844241467581*^9}, {
   3.645844273634408*^9, 3.645844329424272*^9}, {3.645844583625225*^9, 
   3.645844608977747*^9}, {3.646036702479019*^9, 3.646036727562401*^9}, {
   3.646039892770612*^9, 3.646039917531155*^9}, 3.646040004422936*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BraidMovie", "[", 
  RowBox[{
   RowBox[{"BR", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"R3", "[", "0", "]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6260495517136307`*^9, 3.6260495775579777`*^9}}],

Cell[BoxData[
 RowBox[{"BraidMovie", "[", 
  RowBox[{
   RowBox[{"BR", "[", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"3", ",", "1", ",", 
       RowBox[{"-", "2"}]}], "]"}], ",", 
     RowBox[{"R3", "[", 
      RowBox[{"1", ",", "1", ",", "\<\"L\"\>", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "1", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "]"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{{3.626049578074622*^9, 3.6260495831947536`*^9}, 
   3.6260500570530977`*^9, 3.626051665829281*^9, 3.626051957185134*^9, 
   3.626052317965681*^9, 3.626052350141943*^9, {3.626052461417617*^9, 
   3.626052472611088*^9}, 3.626052510674343*^9, 3.626052560165371*^9, 
   3.626052639247085*^9, 3.6260526704390707`*^9, {3.626052783632783*^9, 
   3.6260528016806192`*^9}, 3.626052838144919*^9, 3.626052912756221*^9, 
   3.626394154213838*^9, 3.626394241174944*^9, 3.626394348704249*^9, 
   3.626568699211914*^9, 3.628810516574621*^9, 3.633631887593001*^9, 
   3.633929638448969*^9, 3.6343422110442047`*^9, 3.636692746562744*^9, 
   3.63674246677255*^9, 3.636743261723197*^9, 3.636743371574621*^9, 
   3.636747626082981*^9, 3.636747764608226*^9, 3.637436457315569*^9, 
   3.637438393979624*^9, 3.638782915781425*^9, 3.639091035742601*^9, 
   3.6398154291113243`*^9, 3.6406542288920116`*^9, 3.640655279741042*^9, 
   3.640660794423143*^9, 3.644700431588442*^9, 3.6453877261895514`*^9, 
   3.645389351043063*^9, 3.6453896285990067`*^9, 3.6453961246301003`*^9, 
   3.645842683255384*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Still", "[", 
  RowBox[{
   RowBox[{"BraidMovie", "[", 
    RowBox[{
     RowBox[{"BR", "[", 
      RowBox[{"3", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"R3", "[", "0", "]"}], "}"}]}], "]"}], ",", "1"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.626050058597959*^9, 3.626050061194887*^9}, {
  3.6263941642797937`*^9, 3.626394164800012*^9}}],

Cell[BoxData[
 RowBox[{"BR", "[", 
  RowBox[{"3", ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "1", ",", 
     RowBox[{"-", "2"}], ",", "2"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.626050061624002*^9, 3.6260516668957453`*^9, 3.6260523194670143`*^9, 
   3.626052351538568*^9, 3.626052473660384*^9, 3.626052511141137*^9, 
   3.626052640281584*^9, 3.626052670973393*^9, {3.626052785150663*^9, 
   3.626052802164281*^9}, 3.626052838944806*^9, 3.6260529135065107`*^9, {
   3.626394154291617*^9, 3.626394165386366*^9}, {3.626394209345072*^9, 
   3.626394241214287*^9}, 3.626394348809938*^9, 3.626394498587432*^9, 
   3.6265687129542913`*^9, 3.6288105166111317`*^9, 3.633631887632889*^9, 
   3.63392963848608*^9, 3.634342211081616*^9, 3.636692746622732*^9, 
   3.636742466806931*^9, 3.6367432617471237`*^9, 3.636743371601342*^9, 
   3.636747626155046*^9, 3.636747764708745*^9, 3.637436457393997*^9, 
   3.6374383940187817`*^9, 3.638782915845385*^9, 3.639091035754848*^9, 
   3.639815429196967*^9, 3.640654228969741*^9, 3.6406552797982197`*^9, 
   3.640660794491764*^9, 3.644700431624906*^9, 3.645387726253715*^9, 
   3.645389351089819*^9, 3.645389628663847*^9, 3.64539612464045*^9, 
   3.6458426832909927`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BraidMovie", "[", 
  RowBox[{
   RowBox[{"BR", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", 
       RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"R3", "[", "0", "]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.626049596448859*^9, 3.6260496006088142`*^9}}],

Cell[BoxData[
 RowBox[{"BraidMovie", "[", 
  RowBox[{
   RowBox[{"BR", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1", ",", 
       RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"R3", "[", 
     RowBox[{"0", ",", "1", ",", "\<\"L\"\>", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.626049602457328*^9, 3.626051668247138*^9, 
  3.626052352377079*^9, 3.626052464270247*^9, 3.626052511942006*^9, 
  3.6260526409160748`*^9, 3.626052671557094*^9, 3.6260529170093*^9, 
  3.626394154329803*^9, 3.626394241291318*^9, 3.6263943488428907`*^9, 
  3.626394505373551*^9, 3.626568718539989*^9, 3.6288105166462793`*^9, 
  3.6336318876513853`*^9, 3.633929638535591*^9, 3.634342211114156*^9, 
  3.636692746674098*^9, 3.6367424668576603`*^9, 3.636743261798341*^9, 
  3.6367433716494493`*^9, 3.6367476262306967`*^9, 3.636747764981283*^9, 
  3.63743645763905*^9, 3.637438394094068*^9, 3.638782915915772*^9, 
  3.639091035790431*^9, 3.639815429277074*^9, 3.6406542290405293`*^9, 
  3.6406552798685637`*^9, 3.640660794558671*^9, 3.644700431695812*^9, 
  3.645387726314892*^9, 3.645389351139145*^9, 3.645389628729653*^9, 
  3.6453961246604433`*^9, 3.645842683344079*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Still", "[", 
  RowBox[{"%", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.626052676676803*^9, 3.626052678655161*^9}}],

Cell[BoxData[
 RowBox[{"BR", "[", 
  RowBox[{"5", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "2", ",", "1"}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.626052679781171*^9, 3.626052918276926*^9, 3.626394154382291*^9, {
   3.6263942354231253`*^9, 3.6263942413493967`*^9}, 3.626394348894917*^9, 
   3.626394507530764*^9, 3.626568719894259*^9, 3.628810516695011*^9, 
   3.6336318876843157`*^9, 3.633929638569436*^9, 3.634342211164378*^9, 
   3.636692746722336*^9, 3.636742466906815*^9, 3.63674326184941*^9, 
   3.63674337170051*^9, 3.63674762632344*^9, 3.636747765014832*^9, 
   3.637436457739641*^9, 3.6374383941534147`*^9, 3.6387829159868383`*^9, 
   3.639091035818532*^9, 3.639815429347908*^9, 3.640654229114563*^9, 
   3.640655279930394*^9, 3.640660794616806*^9, 3.6447004317569237`*^9, 
   3.645387726361175*^9, 3.6453893511843*^9, 3.6453896287933893`*^9, 
   3.645396124669615*^9, 3.645842683564584*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"BraidMovie", "[", 
   RowBox[{"braid_", ",", 
    RowBox[{"{", 
     RowBox[{"R3", "[", 
      RowBox[{"offset_", ",", "generator_", ",", "\"\<L\>\"", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"+", "1"}], ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "}"}]}], "]"}], ":=", 
  RowBox[{"BraidMovie", "[", 
   RowBox[{"braid", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"R2", "[", 
       RowBox[{"offset", ",", "1", ",", "generator"}], "]"}], ",", 
      RowBox[{"R3", "[", 
       RowBox[{
        RowBox[{"offset", "+", "1"}], ",", "generator", ",", "\"\<R\>\"", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", 
          RowBox[{"-", "1"}], ",", 
          RowBox[{"+", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"R2", "[", 
       RowBox[{
        RowBox[{"offset", "+", "3"}], ",", 
        RowBox[{"-", "1"}], ",", 
        RowBox[{"generator", "+", 
         RowBox[{"Sign", "[", "generator", "]"}]}]}], "]"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.62604962479041*^9, 3.626049636417218*^9}, {
   3.6260496732145853`*^9, 3.626049691817347*^9}, {3.626049802371017*^9, 
   3.6260498189245872`*^9}, {3.6260501374503117`*^9, 3.626050146707612*^9}, {
   3.626050305378331*^9, 3.626050317585595*^9}, {3.62605035002244*^9, 
   3.626050448942318*^9}, {3.626051987408958*^9, 3.626051988567892*^9}, {
   3.626052074720132*^9, 3.6260520762802277`*^9}, 3.6260523607148533`*^9, {
   3.626052931712019*^9, 3.626052938456448*^9}, {3.626052988821574*^9, 
   3.62605299211791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"BraidMovie", "[", 
  RowBox[{
   RowBox[{"BR", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"R3", "[", "0", "]"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.626051511707514*^9, 3.626051515034629*^9}, {
  3.626052155975016*^9, 3.626052160830946*^9}}],

Cell[BoxData[
 RowBox[{"BraidMovie", "[", 
  RowBox[{
   RowBox[{"BR", "[", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R2", "[", 
      RowBox[{"0", ",", "1", ",", 
       RowBox[{"-", "1"}]}], "]"}], ",", 
     RowBox[{"R2", "[", 
      RowBox[{"1", ",", "1", ",", 
       RowBox[{"-", "2"}]}], "]"}], ",", 
     RowBox[{"R2", "[", 
      RowBox[{"2", ",", "1", ",", "1"}], "]"}], ",", 
     RowBox[{"R3", "[", 
      RowBox[{"3", ",", "1", ",", "\<\"R\"\>", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1", ",", "1"}], "}"}]}], "]"}], ",", 
     RowBox[{"R2", "[", 
      RowBox[{"5", ",", 
       RowBox[{"-", "1"}], ",", 
       RowBox[{"-", "2"}]}], "]"}], ",", 
     RowBox[{"R2", "[", 
      RowBox[{"4", ",", 
       RowBox[{"-", "1"}], ",", "1"}], "]"}], ",", 
     RowBox[{"R2", "[", 
      RowBox[{"3", ",", 
       RowBox[{"-", "1"}], ",", "2"}], "]"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.626051515972382*^9, 3.626051555421417*^9, 3.626051670416115*^9, 
   3.626051958920759*^9, {3.6260519897458677`*^9, 3.6260520019731197`*^9}, {
   3.6260520458412848`*^9, 3.62605205571474*^9}, 3.6260520930973873`*^9, 
   3.6260521625706367`*^9, 3.626052363837802*^9, {3.626052466537711*^9, 
   3.626052478398835*^9}, 3.62605251302649*^9, 3.626052562567272*^9, {
   3.626052924398739*^9, 3.626052939944646*^9}, 3.626394154463694*^9, 
   3.626394241408592*^9, 3.62639434897217*^9, 3.626568747865686*^9, 
   3.628810516745961*^9, 3.633631887717162*^9, 3.6339296386171293`*^9, 
   3.634342211244116*^9, 3.636692746830748*^9, 3.6367424670187073`*^9, 
   3.636743261900032*^9, 3.6367433717530317`*^9, 3.6367476264222803`*^9, 
   3.636747766742519*^9, 3.6374364578911533`*^9, 3.6374383942618113`*^9, 
   3.638782916066743*^9, 3.639091035884288*^9, 3.6398154294331512`*^9, 
   3.640654229206435*^9, 3.6406552800036707`*^9, 3.6406607947108088`*^9, 
   3.644700431849112*^9, 3.645387726444397*^9, 3.645389351266782*^9, 
   3.6453896288661118`*^9, 3.645396124725157*^9, 3.6458426836296253`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Still", "[", 
  RowBox[{"%", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.62605151970188*^9, 3.626051522539406*^9}, {
  3.626052041448366*^9, 3.626052054100829*^9}}],

Cell[BoxData[
 RowBox[{"BR", "[", 
  RowBox[{"5", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", "1", ",", "2", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "2"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{
  3.626051522960649*^9, 3.626051556405107*^9, 3.626051671518409*^9, 
   3.6260519597717943`*^9, {3.626051990695346*^9, 3.6260520029554996`*^9}, {
   3.626052042221036*^9, 3.626052057298664*^9}, 3.6260520954599047`*^9, 
   3.626052365205131*^9, {3.6260524676383133`*^9, 3.6260524791315737`*^9}, 
   3.626052513493826*^9, 3.626052565120133*^9, 3.626052941479198*^9, 
   3.626394154514227*^9, 3.6263942414467907`*^9, 3.626394349027969*^9, 
   3.626568749338519*^9, 3.628810516794983*^9, 3.633631887738914*^9, 
   3.6339296386530848`*^9, 3.63434221129872*^9, 3.636692746864744*^9, 
   3.636742467057131*^9, 3.636743261950482*^9, 3.6367433718015633`*^9, 
   3.636747626496582*^9, 3.636747766794433*^9, 3.637436457979249*^9, 
   3.6374383943219767`*^9, 3.638782916296814*^9, 3.6390910359015617`*^9, 
   3.639815429625379*^9, 3.640654229235072*^9, 3.640655280068116*^9, 
   3.6406607947642937`*^9, 3.644700431880838*^9, 3.645387726496049*^9, 
   3.645389351292289*^9, 3.645389628893516*^9, 3.645396124733838*^9, 
   3.645842683695691*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Still", "[", 
  RowBox[{"%%", ",", "2"}], "]"}]], "Input",
 CellChangeTimes->{{3.626052103578452*^9, 3.6260521044417353`*^9}}],

Cell[BoxData[
 RowBox[{"BR", "[", 
  RowBox[{"5", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "2"}], ",", "2", ",", "1", ",", "2", ",", 
     RowBox[{"-", "1"}], ",", 
     RowBox[{"-", "2"}]}], "}"}]}], "]"}]], "Output",
 CellChangeTimes->{3.626052104806676*^9, 3.626052515445057*^9, 
  3.626052945432316*^9, 3.626394154565425*^9, 3.626394241498947*^9, 
  3.626394349078373*^9, 3.626568750157406*^9, 3.62881051684511*^9, 
  3.633631887749763*^9, 3.633929638686699*^9, 3.634342211349792*^9, 
  3.636692746902796*^9, 3.6367424671108303`*^9, 3.636743262000608*^9, 
  3.636743371851789*^9, 3.636747626638249*^9, 3.6367477668458557`*^9, 
  3.637436460972509*^9, 3.637438394387506*^9, 3.638782916334332*^9, 
  3.639091035978488*^9, 3.639815429696259*^9, 3.6406542294169617`*^9, 
  3.640655280134247*^9, 3.640660794926811*^9, 3.64470043194242*^9, 
  3.6453877265451193`*^9, 3.645389351338914*^9, 3.645389628944744*^9, 
  3.6453961247888536`*^9, 3.645842683763815*^9}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{931, 1154},
WindowMargins->{{58, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (December 4, \
2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 266, 3, 64, "Section"],
Cell[848, 27, 7479, 173, 403, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8364, 205, 273, 3, 50, "Section"],
Cell[8640, 210, 12632, 289, 524, "Input"],
Cell[21275, 501, 13556, 314, 675, "Input"],
Cell[34834, 817, 1099, 28, 80, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[35970, 850, 227, 3, 50, "Section"],
Cell[36200, 855, 273, 8, 28, "Input"],
Cell[36476, 865, 817, 25, 46, "Input"],
Cell[37296, 892, 773, 16, 63, "Input"],
Cell[38072, 910, 1332, 37, 63, "Input"],
Cell[39407, 949, 523, 14, 46, "Input"],
Cell[39933, 965, 238, 6, 28, "Input"],
Cell[40174, 973, 61922, 1341, 2419, "Input"],
Cell[102099, 2316, 92, 1, 28, "Input"],
Cell[102194, 2319, 31770, 669, 1389, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[134001, 2993, 253, 3, 50, "Section"],
Cell[134257, 2998, 624, 13, 46, "Input"],
Cell[134884, 3013, 3026, 73, 250, "Input"],
Cell[137913, 3088, 5091, 130, 286, "Input"],
Cell[143007, 3220, 14942, 420, 675, "Input"],
Cell[157952, 3642, 285, 7, 28, "Input"],
Cell[158240, 3651, 1057, 24, 46, "Input"],
Cell[159300, 3677, 5519, 130, 335, "Input"],
Cell[164822, 3809, 2485, 65, 199, "Input"],
Cell[167310, 3876, 7331, 132, 182, "Input"],
Cell[174644, 4010, 46089, 959, 1763, "Input"],
Cell[220736, 4971, 14904, 272, 488, "Input"],
Cell[235643, 5245, 21595, 451, 930, "Input"],
Cell[CellGroupData[{
Cell[257263, 5700, 329, 9, 28, "Input"],
Cell[257595, 5711, 1722, 35, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[259354, 5751, 449, 13, 28, "Input"],
Cell[259806, 5766, 1226, 21, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[261069, 5792, 350, 10, 28, "Input"],
Cell[261422, 5804, 1313, 26, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[262772, 5835, 147, 3, 28, "Input"],
Cell[262922, 5840, 937, 17, 28, "Output"]
}, Open  ]],
Cell[263874, 5860, 1626, 40, 63, "Input"],
Cell[CellGroupData[{
Cell[265525, 5904, 420, 12, 28, "Input"],
Cell[265948, 5918, 2187, 49, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268172, 5972, 195, 4, 28, "Input"],
Cell[268370, 5978, 1273, 23, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[269680, 6006, 150, 3, 28, "Input"],
Cell[269833, 6011, 1002, 19, 28, "Output"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
